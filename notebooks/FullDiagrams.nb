(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    252421,       5669]
NotebookOptionsPosition[    245998,       5561]
NotebookOutlinePosition[    246340,       5576]
CellTagsIndexPosition[    246297,       5573]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Insert Feynman rules and get momentum rooting", "Chapter",
 CellChangeTimes->{{3.773642853707632*^9, 3.7736428586825514`*^9}, 
   3.775209930338969*^9},ExpressionUUID->"7b6e3491-fbf2-4072-8ccb-\
c063b53122d0"],

Cell[CellGroupData[{

Cell["Derive Feynman Rules (does not really work yet.....)", "Section",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQLSk/1/7Z79eOP+JnOYDoT7OEw0G0XJsRmN7wT/+C
8B+gfOMdMK1xn9NeBEh/mVQIpo81KlyKBdJ7tpSA6dnCPvfjgbTLVo4HIPqd
oOC8VCAtZpwHphUKd281+vvaMXb/xG0gukBKaI8ZkC78U7EXRJeknXJk+vfa
cd0CeycQfbqp648w2xvHEIWDYPpH6hwGESB94uVzMN15t0FGHEiLpsrIguiJ
eRdXgOi+j3/BtEDRj90gektRxB4Q7aSofBFEn1sQC6bf3DSzdwPSa4oCwHQR
p5DCKYE3jk0ny8E0m+oluyUKbxy3bpxoD6IBJMuZ2Q==
  "],ExpressionUUID->"e5703b66-52e0-4687-a1fe-186effae4703"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "FeynMulitply", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FeynMulitply", "[", 
    RowBox[{"list1_", ",", "list2_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "newlist", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newlist", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"FeynMulitply", "[", 
       RowBox[{"list1", ",", "list2", ",", "newlist"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FeynMulitply", "[", 
   RowBox[{"list1_", ",", "list2_", ",", "newlist_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dummynewlist", ",", "newlist1"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dummynewlist", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"newlist", ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"list1", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
               RowBox[{"list2", "[", 
                RowBox[{"[", 
                 RowBox[{"#", ",", "1"}], "]"}], "]"}]}], ",", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"list1", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                RowBox[{"list2", "[", 
                 RowBox[{"[", 
                  RowBox[{"#", ",", "2"}], "]"}], "]"}]}], "]"}]}], "}"}], 
            ")"}], "&"}], "/@", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "@", "list2"}]}], "}"}]}], "]"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newlist1", " ", "=", " ", 
      RowBox[{"Drop", "[", 
       RowBox[{"list1", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"FeynMulitply", "[", 
      RowBox[{"newlist1", ",", "list2", ",", "dummynewlist"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FeynMulitply", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "list2_", ",", "newlist_"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"Return", "[", "newlist", "]"}]}]}], "Input",
 CellChangeTimes->{{3.7669000418808413`*^9, 3.7669000515199857`*^9}, {
  3.7669000935038652`*^9, 3.766900110808707*^9}, {3.7669003202520056`*^9, 
  3.766900386459237*^9}, {3.7669005768929777`*^9, 3.7669005877664747`*^9}, {
  3.7669006271857476`*^9, 3.766901024516316*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"29fd73aa-622a-48b7-9cae-9ae38cc3e78b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7669114578503113`*^9, 3.766911462845951*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"296592cb-8af8-4fa2-81d8-cee2d05e51a6"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ConserveDiracDeltas", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConserveDiracDeltas", "[", "action_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dummylist", ",", "deltalist", ",", "newaction"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dummylist", " ", "=", " ", 
       RowBox[{"Flatten", "@", 
        RowBox[{"(", 
         RowBox[{"List", "@@@", 
          RowBox[{"{", "action", "}"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"deltalist", " ", "=", " ", 
       RowBox[{"Cases", "[", 
        RowBox[{"dummylist", ",", 
         RowBox[{"deltaDirac", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newaction", " ", "=", " ", 
       RowBox[{"action", "/.", 
        RowBox[{
         RowBox[{"deltaDirac", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], "\[Rule]", "1"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"newaction", ",", "deltalist"}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.76691189787908*^9, 3.7669119452754574`*^9}, {
  3.7669119905047464`*^9, 3.766912042553461*^9}, {3.7669120769776497`*^9, 
  3.766912106415473*^9}, {3.766912600188304*^9, 3.7669126017770524`*^9}, {
  3.7669126449276075`*^9, 3.766912672320789*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"e6e33873-5eff-44d5-b48e-44713cfcf2f4"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ConservePropMomentum", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConservePropMomentum", "[", 
   RowBox[{"diagram_", ",", "deltaList_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newdiagram", ",", " ", "newdeltaList"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newdiagram", " ", "=", "  ", 
      RowBox[{
       RowBox[{"diagram", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"First", "[", 
           RowBox[{"First", "[", "deltaList", "]"}], "]"}], "\[Rule]", " ", 
          RowBox[{"(", 
           RowBox[{"Last", "[", 
            RowBox[{"First", "[", "deltaList", "]"}], "]"}], ")"}]}], "}"}]}],
        "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newdeltaList", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Drop", "[", 
         RowBox[{"deltaList", ",", "1"}], "]"}], "/.", 
        RowBox[{
         RowBox[{"First", "[", 
          RowBox[{"First", "[", "deltaList", "]"}], "]"}], "\[Rule]", " ", 
         RowBox[{"(", 
          RowBox[{"Last", "[", 
           RowBox[{"First", "[", "deltaList", "]"}], "]"}], ")"}]}]}], "//", 
       "Simplify"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ConservePropMomentum", "[", 
      RowBox[{"newdiagram", ",", " ", "newdeltaList"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConservePropMomentum", "[", 
   RowBox[{"diagram_", ",", 
    RowBox[{"{", "}"}]}], "]"}], " ", ":=", " ", "diagram", " "}]}], "Input",
 CellChangeTimes->{{3.766911733109889*^9, 3.7669117518647118`*^9}, {
  3.7669131876821136`*^9, 3.766913194944685*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"8a98618a-5365-4438-a42c-69471e7c856b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7669125935430813`*^9, 3.766912596590928*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"f827826f-4f35-4967-9821-052ca76e5d6a"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "MultipleFieldDerivative", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MultipleFieldDerivative", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"action_", ",", 
      RowBox[{"{", "multderfields_", "}"}]}], "}"}], ",", "fields_", ",", 
    "BRSTfields___"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newderfields", ",", " ", "newaction"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Echo", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"action", ",", 
           RowBox[{"multderfields", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "fields", ",", 
         "BRSTfields"}], "}"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newaction", " ", "=", " ", 
      RowBox[{"FieldDerivative", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"action", ",", 
          RowBox[{"multderfields", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "fields", ",", 
        "BRSTfields"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newderfields", " ", "=", " ", 
      RowBox[{"Drop", "[", 
       RowBox[{"multderfields", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Echo", "[", 
        RowBox[{"{", 
         RowBox[{"newaction", ",", 
          RowBox[{"{", "newderfields", "}"}]}], "}"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"MultipleFieldDerivative", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"newaction", ",", 
         RowBox[{"{", "newderfields", "}"}]}], "}"}], ",", "fields", ",", 
       "BRSTfields"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MultipleFieldDerivative", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newaction_", ",", 
      RowBox[{"{", 
       RowBox[{"{", "}"}], "}"}]}], "}"}], ",", "fields_", ",", 
    "BRSTfields___"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"feynaction", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"Null", ",", 
         RowBox[{"Length", "@", "newaction"}]}], "]"}]}], ",", " ", 
      "deltalist"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"newaction", "[", 
            RowBox[{"[", 
             RowBox[{"#", ",", "2"}], "]"}], "]"}], "\[Equal]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Echo", "[", "\"\<ok\>\"", "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"feynaction", "[", 
             RowBox[{"[", "#", "]"}], "]"}], " ", "=", " ", 
            RowBox[{"FormTrace", "[", 
             RowBox[{"newaction", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Echo", "[", 
              RowBox[{"feynaction", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"feynaction", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", "deltalist"}], "}"}], " ",
             "=", " ", 
            RowBox[{"ConserveDiracDeltas", "[", 
             RowBox[{"feynaction", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Echo", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"feynaction", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], ",", "deltalist"}], "}"}], 
              "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"feynaction", "[", 
             RowBox[{"[", "#", "]"}], "]"}], " ", "=", " ", 
            RowBox[{"ConservePropMomentum", "[", 
             RowBox[{
              RowBox[{"feynaction", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", "deltalist"}], "]"}]}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ")"}], "&"}], "/@", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "newaction"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"FormTrace", "[", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"feynaction", "/.", 
          RowBox[{"Null", "\[Rule]", "Nothing"}]}], "]"}], "//", "Factor"}], 
       "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.7669059829003415`*^9, 3.7669062655371275`*^9}, {
   3.7669063318023853`*^9, 3.7669063364588966`*^9}, {3.7669063812171817`*^9, 
   3.766906392122977*^9}, {3.766906857603132*^9, 3.766906868787239*^9}, {
   3.766906933052437*^9, 3.766906934082706*^9}, {3.7669070030096517`*^9, 
   3.7669070054670506`*^9}, {3.766907055585267*^9, 3.76690708388256*^9}, {
   3.7669102975873885`*^9, 3.766910313806992*^9}, 3.7669103956804533`*^9, 
   3.766910433134248*^9, {3.766910707304736*^9, 3.7669107170237055`*^9}, {
   3.766910777443058*^9, 3.7669107781382313`*^9}, {3.766911232027916*^9, 
   3.766911393575035*^9}, {3.7669116304305954`*^9, 3.7669116349205823`*^9}, {
   3.766912142298168*^9, 3.7669121690175347`*^9}, {3.7669124100174217`*^9, 
   3.766912464651305*^9}, {3.7669125251374464`*^9, 3.766912561062488*^9}, {
   3.766912683339308*^9, 3.7669126943089886`*^9}, {3.7669127348664527`*^9, 
   3.766912755673818*^9}, {3.766913129736101*^9, 3.7669131335807858`*^9}, 
   3.766913288631051*^9, {3.7669133351596003`*^9, 3.7669133734680805`*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"2d145f78-9dd3-4af8-9213-b254d325a21c"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7669117287575626`*^9, 3.766911728912122*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"0d8e078b-26ee-4193-b2fe-ae97f0b3da8b"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "FieldDerivative", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FieldDerivative", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"action_", ",", "derfield_"}], "}"}], ",", "fields_", ",", 
    "BRSTfields___"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"zeroaction", ",", "allfields"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"zeroaction", " ", "=", "  ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"allfields", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"fields", ",", "BRSTfields"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"FieldDerivative", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"action", ",", "derfield", ",", "zeroaction"}], "}"}], ",", 
       "allfields"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FieldDerivative", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"action_", ",", "derfield_", ",", "zeroaction_"}], "}"}], ",", 
    "allfields_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"deraction", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"Null", ",", 
         RowBox[{"Length", "@", 
          RowBox[{"action", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], ",", " ", 
      "deractionnew", ",", "positionderfield", ",", " ", "derfieldtype", ",", 
      "positionactionfields", ",", "actionfieldtypes", ",", 
      "fermionicactionfield", ",", "Deltas", ",", "testaction", ",", " ", 
      "newaction", ",", " ", "sign"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Echo", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<start iteration\>\"", ",", "zeroaction"}], "}"}], "]"}], 
      ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"positionderfield", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Flatten", "@@", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"allfields", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "\"\<name\>\""}], "]"}], "]"}], ",", 
           RowBox[{"Head", "@", "derfield"}]}], "]"}]}], ")"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"derfieldtype", " ", "=", " ", 
      RowBox[{"allfields", "[", 
       RowBox[{"[", 
        RowBox[{"positionderfield", ",", "\"\<fieldtype\>\""}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Echo", "[", "derfieldtype", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Echo", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"allfields", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "\"\<name\>\""}], "]"}], "]"}], ",", 
          RowBox[{"Head", "@", 
           RowBox[{"action", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "}"}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"positionactionfields", " ", "=", " ", 
      RowBox[{"Flatten", "@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"allfields", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "\"\<name\>\""}], "]"}], "]"}], ",", 
             RowBox[{"Head", "@", 
              RowBox[{"action", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2", ",", "#"}], "]"}], "]"}]}]}], "]"}], 
           ")"}], "&"}], "/@", 
         RowBox[{"Table", "[", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"action", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], "]"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Echo", "[", "positionactionfields", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"actionfieldtypes", " ", "=", "  ", 
      RowBox[{"allfields", "[", 
       RowBox[{"[", 
        RowBox[{"positionactionfields", ",", "\"\<fieldtype\>\""}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Echo", "[", "actionfieldtypes", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"fermionicactionfield", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<fermion\>\"", ",", "\"\<antifermion\>\"", ",", 
             "\"\<ghost\>\"", ",", "\"\<antighost\>\"", ",", 
             "\"\<BRSTfermion\>\""}], "}"}], ",", 
           RowBox[{"actionfieldtypes", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], "]"}], ")"}], "&"}], "/@", 
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "@", "actionfieldtypes"}]}], "}"}]}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Echo", "[", 
        RowBox[{"fermionicactionfield", "/.", 
         RowBox[{"False", "\[Rule]", "Nothing"}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"sign", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "@", 
             RowBox[{"action", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2", ",", "#"}], "]"}], "]"}]}], " ", 
            "\[Equal]", " ", 
            RowBox[{"Head", "@", "derfield"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Echo", "[", "\"\<same fields\>\"", "]"}], ";"}], "*)"}],
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Deltas", " ", "=", " ", 
             RowBox[{"GetDeltas", "[", 
              RowBox[{
               RowBox[{"action", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2", ",", "#"}], "]"}], "]"}], ",", 
               "derfield", ",", "derfieldtype"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Echo", "[", "Deltas", "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "\"\<fermion\>\"", ",", "\"\<antifermion\>\"", ",", 
                  "\"\<ghost\>\"", ",", "\"\<antighost\>\"", ",", 
                  "\"\<BRSTfermion\>\""}], "}"}], ",", "derfieldtype"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"sign", " ", "=", " ", 
               RowBox[{"sign", "*", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"-", "1"}], ")"}], "^", 
                 RowBox[{"(", 
                  RowBox[{"Length", "@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"fermionicactionfield", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"(", 
                    RowBox[{"#", "-", "1"}], ")"}]}], "]"}], "]"}], "/.", 
                    RowBox[{"False", "\[Rule]", "Nothing"}]}], ")"}]}], 
                  ")"}]}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"deraction", "[", 
              RowBox[{"[", "#", "]"}], "]"}], " ", "=", "  ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"sign", "*", 
                RowBox[{"action", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", "Deltas"}], ",", 
               RowBox[{"Drop", "[", 
                RowBox[{
                 RowBox[{"action", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"{", "#", "}"}]}], "]"}]}], "}"}]}], ";"}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "Nothing"}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}], "&"}], "/@", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"action", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"deractionnew", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"zeroaction", ",", 
        RowBox[{"deraction", "/.", 
         RowBox[{"Null", "\[Rule]", "Nothing"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Echo", "[", "deractionnew", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Echo", "[", "action", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"newaction", " ", "=", " ", 
      RowBox[{"Drop", "[", 
       RowBox[{"action", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Echo", "[", 
        RowBox[{"{", 
         RowBox[{"newaction", ",", "derfield", ",", "deractionnew"}], "}"}], 
        "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"FieldDerivative", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"newaction", ",", "derfield", ",", "deractionnew"}], "}"}], 
       ",", "allfields"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FieldDerivative", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "field_", ",", "deractionnew_"}], "}"}], ",", 
    "allfields_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Return", "[", "deractionnew", "]"}]}]}], "Input",
 CellChangeTimes->{{3.766901738002263*^9, 3.7669020402672367`*^9}, {
   3.7669020729715214`*^9, 3.7669020758579445`*^9}, 3.7669024107331457`*^9, {
   3.7669024605712643`*^9, 3.7669024663675137`*^9}, {3.7669025382936153`*^9, 
   3.766902624306602*^9}, {3.7669027508064003`*^9, 3.7669027955307035`*^9}, {
   3.766902838762974*^9, 3.7669029068040175`*^9}, {3.7669029607135057`*^9, 
   3.7669033180623674`*^9}, {3.766903349560282*^9, 3.7669035220512695`*^9}, 
   3.7669035844408197`*^9, {3.766903815756029*^9, 3.766903849818499*^9}, {
   3.7669039042614126`*^9, 3.766903960707162*^9}, {3.766904026975895*^9, 
   3.7669041165573473`*^9}, {3.766904188019162*^9, 3.7669043738668423`*^9}, {
   3.766904507945161*^9, 3.766904648727485*^9}, {3.7669046942696686`*^9, 
   3.766904785954176*^9}, {3.7669048564545283`*^9, 3.766904864177867*^9}, {
   3.766904902990139*^9, 3.7669052719281206`*^9}, {3.766905508320612*^9, 
   3.7669055145140476`*^9}, {3.766905545106352*^9, 3.766905549055758*^9}, {
   3.7669055899663334`*^9, 3.7669056054110155`*^9}, {3.76690565584661*^9, 
   3.7669056938339796`*^9}, {3.7669058656911025`*^9, 3.766905904282854*^9}, {
   3.766906524761338*^9, 3.7669065563737364`*^9}, {3.7669065883821*^9, 
   3.766906640690157*^9}, {3.7669070102053733`*^9, 3.7669070299017076`*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"72d8f109-0c32-49df-b342-5415ea7851bf"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7669052161573296`*^9, 3.766905216283967*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"8a6bfa8a-11d6-495f-a310-814bb3949672"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "GetDeltas", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetDeltas", "[", 
    RowBox[{"actionfield_", ",", "derfield_", ",", "derfieldtype_"}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "Deltas", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Switch", "[", 
       RowBox[{
       "derfieldtype", ",", "\[IndentingNewLine]", " ", "\"\<scalar\>\"", ",", 
        RowBox[{"Deltas", " ", "=", 
         RowBox[{"deltaDirac", "[", 
          RowBox[{
           RowBox[{"actionfield", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"derfield", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\"\<boson\>\"", ",", " ", 
        RowBox[{"Deltas", " ", "=", " ", 
         RowBox[{
          RowBox[{"deltaDirac", "[", 
           RowBox[{
            RowBox[{"actionfield", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"derfield", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], 
          RowBox[{"deltaLor", "[", 
           RowBox[{
            RowBox[{"actionfield", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"derfield", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", 
          RowBox[{"deltaAdj", "[", 
           RowBox[{
            RowBox[{"actionfield", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"derfield", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", "\"\<fermion\>\"", ",", " ", 
        RowBox[{"Deltas", " ", "=", " ", 
         RowBox[{
          RowBox[{"deltaDirac", "[", 
           RowBox[{
            RowBox[{"actionfield", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"derfield", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], 
          RowBox[{"deltaLor", "[", 
           RowBox[{
            RowBox[{"actionfield", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"derfield", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", 
          RowBox[{"deltaAdj", "[", 
           RowBox[{
            RowBox[{"actionfield", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"derfield", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", "\"\<antifermion\>\"", ",", " ", 
        RowBox[{"Deltas", " ", "=", " ", 
         RowBox[{
          RowBox[{"deltaDirac", "[", 
           RowBox[{
            RowBox[{"actionfield", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"derfield", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], 
          RowBox[{"deltaLor", "[", 
           RowBox[{
            RowBox[{"actionfield", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"derfield", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", 
          RowBox[{"deltaAdj", "[", 
           RowBox[{
            RowBox[{"actionfield", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"derfield", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", "\"\<ghost\>\"", ",", "  ", 
        RowBox[{"Deltas", " ", "=", "  ", 
         RowBox[{
          RowBox[{"deltaDirac", "[", 
           RowBox[{
            RowBox[{"actionfield", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"derfield", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], 
          RowBox[{"deltaAdj", "[", 
           RowBox[{
            RowBox[{"actionfield", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"derfield", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", "\"\<antighost\>\"", ",", "  ", 
        RowBox[{"Deltas", " ", "=", 
         RowBox[{
          RowBox[{"deltaDirac", "[", 
           RowBox[{
            RowBox[{"actionfield", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"derfield", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], 
          RowBox[{"deltaAdj", "[", 
           RowBox[{
            RowBox[{"actionfield", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"derfield", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", "\"\<BRSTfermion\>\"", ",", " ", 
        RowBox[{"Deltas", " ", "=", " ", 
         RowBox[{
          RowBox[{"deltaDirac", "[", 
           RowBox[{
            RowBox[{"actionfield", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"derfield", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], 
          RowBox[{"deltaLor", "[", 
           RowBox[{
            RowBox[{"actionfield", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"derfield", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", 
          RowBox[{"deltaAdj", "[", 
           RowBox[{
            RowBox[{"actionfield", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"derfield", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", "\"\<BRSTboson\>\"", ",", "  ", 
        RowBox[{"Deltas", " ", "=", " ", 
         RowBox[{
          RowBox[{"deltaDirac", "[", 
           RowBox[{
            RowBox[{"actionfield", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"derfield", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], 
          RowBox[{"deltaAdj", "[", 
           RowBox[{
            RowBox[{"actionfield", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"derfield", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "Deltas", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7669035291697917`*^9, 3.766903788886133*^9}, {
  3.7669039965123663`*^9, 3.766904012415818*^9}, {3.7669041395398607`*^9, 
  3.7669041431262693`*^9}, {3.766910988924094*^9, 3.7669110096855497`*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"8e63e1bb-7317-4e4b-80b6-d1e7042fb0e1"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7669016730553646`*^9, 3.7669016738782654`*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"727dd6fe-4877-4951-99f8-234729186e54"]
}, Closed]],

Cell[CellGroupData[{

Cell["Insert Feynman Rules", "Section",
 CellChangeTimes->{{3.755946492910046*^9, 3.755946500824215*^9}, {
  3.755946680612664*^9, 3.7559466815788717`*^9}, {3.75603980949984*^9, 
  3.7560398148908653`*^9}, {3.7560406963084908`*^9, 3.7560406995491886`*^9}, {
  3.7561913770158415`*^9, 3.7561913796470623`*^9}, {3.7561955783773932`*^9, 
  3.756195584272127*^9}, {3.7562073445334387`*^9, 3.756207347443736*^9}, {
  3.756627373857559*^9, 3.75662738055461*^9}, {3.756635616565727*^9, 
  3.7566356277808156`*^9}, {3.7570524303250065`*^9, 3.757052433988364*^9}, {
  3.761283044328466*^9, 3.7612830460351963`*^9}, {3.7612830768874474`*^9, 
  3.7612830792472878`*^9}, {3.761289444027043*^9, 3.761289448887339*^9}, {
  3.7612894814202676`*^9, 
  3.761289485154708*^9}},ExpressionUUID->"d37f6455-e56b-4714-9b5f-\
b8e0d40a3d42"],

Cell[CellGroupData[{

Cell["Not needed...", "Subsection",
 CellChangeTimes->{{3.7752099914060445`*^9, 3.775209995907121*^9}, {
  3.7752115043784785`*^9, 
  3.7752115068010178`*^9}},ExpressionUUID->"98b1ff58-4e66-4200-ad78-\
e5b54945bfc0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "SuperindexRulesExt", "]"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"needs", " ", "to", " ", "be", " ", "adjusted", " ", "for", " ", 
     RowBox[{"fermions", "/", "ghosts"}]}], " ", "\[Rule]", " ", 
    RowBox[{
    "lorentz", " ", "indices", " ", "and", " ", "for", " ", "higher", " ", 
     "order", " ", "correlation", " ", "functions"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SuperindexRulesExt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fieldList_", ",", "superindexList_"}], "}"}], ",", "fields_"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"SuperindexRulesExt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fieldList", ",", "superindexList"}], "}"}], ",", 
    RowBox[{"{", "}"}], ",", "fields"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SuperindexRulesExt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fieldList_", ",", "superindexList_"}], "}"}], ",", "Indices_", 
    ",", "fields_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "field1", ",", " ", "superindex1", ",", " ", "Allfields", ",", " ", 
      "IndicesNew", ",", " ", "PositionField", ",", " ", "fieldListNew", ",", 
      " ", "superindexListNew"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"field1", " ", "=", " ", 
      RowBox[{"First", "[", "fieldList", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"superindex1", " ", "=", " ", 
      RowBox[{"First", "[", "superindexList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PositionField", " ", "=", " ", 
      RowBox[{"First", "@", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"field1", " ", "\[Equal]", " ", 
             RowBox[{"fields", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", "\"\<name\>\""}], "]"}], "]"}]}], "&"}], "/@", 
           RowBox[{"Table", "[", 
            RowBox[{"i", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "@", "fields"}]}], "}"}]}], "]"}]}], ",", 
          "True"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"fields", "[", 
        RowBox[{"[", 
         RowBox[{"PositionField", ",", "\"\<fieldtype\>\""}], "]"}], "]"}], 
       ",", "\[IndentingNewLine]", "\"\<scalar\>\"", ",", " ", 
       RowBox[{"IndicesNew", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"Indices", ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"superindex1", ",", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<pext\>\"", ",", 
                RowBox[{"ToString", "[", "superindex1", "]"}]}], "]"}], 
              "]"}]}], "}"}], "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\"\<boson\>\"", ",", " ", 
       RowBox[{"IndicesNew", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"Indices", ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"superindex1", ",", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<pext\>\"", ",", 
                RowBox[{"ToString", "[", "superindex1", "]"}]}], "]"}], "]"}],
              ",", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<muext\>\"", ",", 
                RowBox[{"ToString", "[", "superindex1", "]"}]}], "]"}], "]"}],
              ",", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<iext\>\"", ",", 
                RowBox[{"ToString", "[", "superindex1", "]"}]}], "]"}], 
              "]"}]}], "}"}], "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\"\<fermion\>\"", ",", " ", 
       RowBox[{"IndicesNew", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"Indices", ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"superindex1", " ", ",", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<pext\>\"", ",", 
                RowBox[{"ToString", "[", "superindex1", "]"}]}], "]"}], "]"}],
              ",", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<muext\>\"", ",", 
                RowBox[{"ToString", "[", "superindex1", "]"}]}], "]"}], "]"}],
              ",", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<iext\>\"", ",", 
                RowBox[{"ToString", "[", "superindex1", "]"}]}], "]"}], 
              "]"}]}], "}"}], "}"}]}], "]"}]}], ",", " ", 
       "\"\<antifermion\>\"", ",", " ", 
       RowBox[{"IndicesNew", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"Indices", ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"superindex1", " ", ",", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<pext\>\"", ",", 
                RowBox[{"ToString", "[", "superindex1", "]"}]}], "]"}], "]"}],
              ",", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<muext\>\"", ",", 
                RowBox[{"ToString", "[", "superindex1", "]"}]}], "]"}], "]"}],
              ",", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<iext\>\"", ",", 
                RowBox[{"ToString", "[", "superindex1", "]"}]}], "]"}], 
              "]"}]}], "}"}], "}"}]}], "]"}]}], ",", "\"\<ghost\>\"", ",", 
       RowBox[{"IndicesNew", " ", "=", "  ", 
        RowBox[{"Join", "[", 
         RowBox[{"Indices", ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"superindex1", " ", ",", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<pext\>\"", ",", 
                RowBox[{"ToString", "[", "superindex1", "]"}]}], "]"}], "]"}],
              ",", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<iext\>\"", ",", 
                RowBox[{"ToString", "[", "superindex1", "]"}]}], "]"}], 
              "]"}]}], "}"}], "}"}]}], "]"}]}], ",", "   ", 
       "\[IndentingNewLine]", "\"\<antighost\>\"", ",", "  ", 
       RowBox[{"IndicesNew", " ", "=", "  ", 
        RowBox[{"Join", "[", 
         RowBox[{"Indices", ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"superindex1", " ", ",", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<pext\>\"", ",", 
                RowBox[{"ToString", "[", "superindex1", "]"}]}], "]"}], "]"}],
              ",", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<iext\>\"", ",", 
                RowBox[{"ToString", "[", "superindex1", "]"}]}], "]"}], 
              "]"}]}], "}"}], "}"}]}], "]"}]}], ",", "   ", 
       "\[IndentingNewLine]", "\"\<BRSTfermion\>\"", ",", 
       RowBox[{"IndicesNew", " ", "=", "  ", 
        RowBox[{"Join", "[", 
         RowBox[{"Indices", ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"superindex1", " ", ",", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<pext\>\"", ",", 
                RowBox[{"ToString", "[", "superindex1", "]"}]}], "]"}], "]"}],
              ",", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<muext\>\"", ",", 
                RowBox[{"ToString", "[", "superindex1", "]"}]}], "]"}], "]"}],
              ",", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<iext\>\"", ",", 
                RowBox[{"ToString", "[", "superindex1", "]"}]}], "]"}], 
              "]"}]}], "}"}], "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\"\<BRSTboson\>\"", ",", "  ", 
       RowBox[{"IndicesNew", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"Indices", ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"superindex1", " ", ",", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<pext\>\"", ",", 
                RowBox[{"ToString", "[", "superindex1", "]"}]}], "]"}], "]"}],
              ",", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<muext\>\"", ",", 
                RowBox[{"ToString", "[", "superindex1", "]"}]}], "]"}], "]"}],
              ",", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<iext\>\"", ",", 
                RowBox[{"ToString", "[", "superindex1", "]"}]}], "]"}], 
              "]"}]}], "}"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"fieldListNew", " ", "=", " ", 
      RowBox[{"Drop", "[", 
       RowBox[{"fieldList", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"superindexListNew", " ", "=", " ", 
      RowBox[{"Drop", "[", 
       RowBox[{"superindexList", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"SuperindexRulesExt", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fieldListNew", ",", "superindexListNew"}], "}"}], ",", 
       "IndicesNew", ",", "fields"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SuperindexRulesExt", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", "Indices_", ",", "fields_"}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "Indices", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"SuperindexRulesExt", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"field1_", ",", "field2_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"a_", ",", "b_"}], "}"}]}], "}"}], ",", "fields_"}], "]"}], 
    " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"PositionField", ",", "FieldType", ",", "IndicesNew"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IndicesNew", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"field1", ",", "field2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PositionField", " ", "=", " ", 
        RowBox[{"First", "@", 
         RowBox[{"Flatten", "@", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"field1", " ", "\[Equal]", " ", 
               RowBox[{"fields", "[", 
                RowBox[{"[", 
                 RowBox[{"#", ",", "\"\<name\>\""}], "]"}], "]"}]}], "&"}], "/@", 
             RowBox[{"Table", "[", 
              RowBox[{"i", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "@", "fields"}]}], "}"}]}], "]"}]}], ",", 
            "True"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"fields", "[", 
           RowBox[{"[", 
            RowBox[{"PositionField", ",", "\"\<fieldtype\>\""}], "]"}], "]"}],
           " ", "\[Equal]", "  ", "\"\<scalar\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"IndicesNew", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"field1", ",", "field2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", ",", "pext"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"b", ",", "qext"}], "}"}]}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"fields", "[", 
             RowBox[{"[", 
              RowBox[{"PositionField", ",", "\"\<fieldtype\>\""}], "]"}], 
             "]"}], " ", "\[Equal]", "  ", "\"\<boson\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"IndicesNew", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"field1", ",", "field2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"a", ",", "muext", ",", "iext", ",", "pext"}], "}"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{"b", ",", "nuext", ",", "jext", ",", "qext"}], 
                 "}"}]}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"fields", "[", 
               RowBox[{"[", 
                RowBox[{"PositionField", ",", "\"\<fieldtype\>\""}], "]"}], 
               "]"}], " ", "\[Equal]", "  ", "\"\<fermion\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"IndicesNew", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"field1", ",", "field2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"a", " ", ",", 
                    RowBox[{"(*", 
                    RowBox[{"mu", ","}], "*)"}], "i", ",", "p"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"b", ",", 
                    RowBox[{"(*", 
                    RowBox[{"nu", ","}], "*)"}], "j", ",", "q"}], "}"}]}], 
                 "}"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "IndicesNew", "]"}]}]}], "\n", "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7614608725429506`*^9, 3.7614608751037045`*^9}, {
  3.761460965900084*^9, 3.7614609892132473`*^9}, {3.7614610315871873`*^9, 
  3.761461121509733*^9}, {3.7618981450245895`*^9, 3.761898159845951*^9}, {
  3.761901733131668*^9, 3.76190213846707*^9}, {3.76190231073265*^9, 
  3.7619024533168497`*^9}, {3.76190279909372*^9, 3.7619029274453635`*^9}, {
  3.761903178846278*^9, 3.7619032173716297`*^9}, {3.7619032535782347`*^9, 
  3.7619033820208445`*^9}, {3.7619034127593193`*^9, 3.761903416121744*^9}, {
  3.761903457712173*^9, 3.761903494986936*^9}, {3.762772517974415*^9, 
  3.762772544132209*^9}, {3.7627727707523994`*^9, 3.7627728094558964`*^9}, {
  3.7627729568188457`*^9, 3.7627730299237337`*^9}, {3.7627731530550795`*^9, 
  3.7627731542330594`*^9}, {3.7627731849772143`*^9, 3.7627732214600034`*^9}, {
  3.7651811193228397`*^9, 3.765181465537939*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"2d97077c-0214-45be-a7aa-7a778d645042"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "MomentumConservation", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MomentumConservation", "[", 
   RowBox[{
   "dummyRHS_", ",", "ExternalSuperindexReplacement_", ",", "PositionReg_"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ExternalMomenta", ",", "SignRules", ",", "newVar", ",", " ", "PrefVar", 
      ",", "PosNewMom", ",", "RunningIndex", ",", "MemberList", ",", 
      RowBox[{"FullDeltaList", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"MomentumCons", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ",", " ", "AllMomenta"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ExternalMomenta", " ", "=", " ", 
      RowBox[{"ExternalSuperindexReplacement", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2", ",", "2"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SignRules", " ", "=", "  ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"n_", "?", "NumericQ"}], "*", "q_"}], " ", "\[Rule]", " ", 
        "q"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Echo", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dummyRHS", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "\"\<indices\>\"", ",", "2", ",", "All", 
           ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"dummyRHS", "[", 
         RowBox[{"[", 
          RowBox[{
          "1", ",", "\"\<indices\>\"", ",", "2", ",", "All", ",", "2"}], 
          "]"}], "]"}]}], "}"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"dummyRHS", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "\"\<indices\>\"", ",", "2", ",", 
              "All", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"dummyRHS", "[", 
            RowBox[{"[", 
             RowBox[{
             "1", ",", "\"\<indices\>\"", ",", "2", ",", "#", ",", "1"}], 
             "]"}], "]"}]}], "]"}], ",", "      ", 
         RowBox[{"(*", 
          RowBox[{
          "check", " ", "which", " ", "reg", " ", "index", " ", "connects", 
           " ", "to", " ", "the", " ", "last", " ", "entry", " ", "in", " ", 
           "the", " ", "Diagram"}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Echo", "[", "\"\<yay member\>\"", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newVar", " ", "=", " ", 
           RowBox[{
            RowBox[{"dummyRHS", "[", 
             RowBox[{"[", 
              RowBox[{
              "1", ",", "\"\<indices\>\"", ",", "2", ",", "#", ",", "2"}], 
              "]"}], "]"}], "/.", "SignRules"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"PrefVar", " ", "=", " ", 
           RowBox[{
            RowBox[{"dummyRHS", "[", 
             RowBox[{"[", 
              RowBox[{
              "1", ",", "\"\<indices\>\"", ",", "2", ",", "#", ",", "2"}], 
              "]"}], "]"}], "/", "newVar"}]}], ";"}]}], "\[IndentingNewLine]",
         "\[IndentingNewLine]", "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Echo", "[", "newVar", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "PositionReg"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"PrefVar", ">", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MomentumCons", " ", "=", " ", 
            RowBox[{"Flatten", "@", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"PrefVar", "*", "newVar"}], "-", "q"}], "\[Equal]", 
                "0"}], ",", "newVar"}], "]"}]}]}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MomentumCons", " ", "=", " ", 
            RowBox[{"Flatten", "@", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"PrefVar", "*", "newVar"}], "+", "q"}], "\[Equal]", 
                "0"}], ",", "newVar"}], "]"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MomentumCons", " ", "=", " ", 
         RowBox[{"Flatten", "@", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"PrefVar", "*", "newVar"}], "+", 
              RowBox[{"dummyRHS", "[", 
               RowBox[{"[", 
                RowBox[{
                "1", ",", "\"\<indices\>\"", ",", "2", ",", "2", ",", "2"}], 
                "]"}], "]"}]}], "\[Equal]", "0"}], ",", "newVar"}], "]"}]}]}],
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Echo", "[", "MomentumCons", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"FullDeltaList", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"FullDeltaList", "/.", "MomentumCons"}], "]"}], ",", 
        "MomentumCons"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Echo", "[", "FullDeltaList", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"AllMomenta", " ", "=", " ", 
          RowBox[{
           RowBox[{"dummyRHS", "[", 
            RowBox[{"[", 
             RowBox[{
             "#", ",", "\"\<indices\>\"", ",", "2", ",", "All", ",", "2"}], 
             "]"}], "]"}], "/.", "FullDeltaList"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Echo", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<all allmomenta\>\"", ",", "AllMomenta"}], "}"}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"RunningIndex", " ", "=", " ", "1"}], ",", " ", 
           RowBox[{"RunningIndex", "\[LessEqual]", 
            RowBox[{"Length", "@", "AllMomenta"}]}], ",", " ", 
           RowBox[{"RunningIndex", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Echo", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<runningIndex\>\"", ",", "RunningIndex"}], "}"}], 
             "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{"List", ",", "ExternalMomenta"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"{", "q", "}"}], "}"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"AllMomenta", "[", 
                   RowBox[{"[", "RunningIndex", "]"}], "]"}], "}"}], "/.", 
                 "SignRules"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"PosNewMom", " ", "=", " ", 
                RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Echo", "[", "\"\<no new mom\>\"", "]"}], ";"}], 
              "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Echo", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"AllMomenta", "[", 
                   RowBox[{"[", "RunningIndex", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"List", "@@@", 
                    RowBox[{"{", 
                    RowBox[{"AllMomenta", "[", 
                    RowBox[{"[", "RunningIndex", "]"}], "]"}], "}"}]}], "]"}],
                     "/.", "SignRules"}], ")"}], "/.", 
                   RowBox[{
                    RowBox[{"n_", "?", "NumericQ"}], "\[Rule]", "Nothing"}]}],
                   ",", 
                  RowBox[{"Length", "@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"List", "@@@", 
                    RowBox[{"{", 
                    RowBox[{"AllMomenta", "[", 
                    RowBox[{"[", "RunningIndex", "]"}], "]"}], "}"}]}], "]"}],
                     "/.", "SignRules"}], "/.", 
                    RowBox[{
                    RowBox[{"n_", "?", "NumericQ"}], "\[Rule]", "Nothing"}]}],
                     ")"}]}], ",", "\"\<shouldbe\>\"", ",", "1"}], "}"}], 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"List", "@@@", 
                    RowBox[{"{", 
                    RowBox[{"AllMomenta", "[", 
                    RowBox[{"[", "RunningIndex", "]"}], "]"}], "}"}]}], "]"}],
                     "/.", "SignRules"}], ")"}], "/.", 
                    RowBox[{
                    RowBox[{"n_", "?", "NumericQ"}], "\[Rule]", "Nothing"}]}],
                     ")"}]}], "==", "1"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                  "Echo", "[", "\"\<only one mom in this entry\>\"", "]"}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"PosNewMom", " ", "=", " ", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"List", "@@@", "ExternalMomenta"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "q", "}"}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"AllMomenta", "[", 
                    RowBox[{"[", "RunningIndex", "]"}], "]"}], "}"}], "/.", 
                    "SignRules"}]}], "]"}], "]"}], ";"}], "*)"}], 
                   "RunningIndex"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"Echo", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<newmom\>\"", ",", " ", 
                    RowBox[{"AllMomenta", "[", 
                    RowBox[{"[", "RunningIndex", "]"}], "]"}], ",", 
                    "PosNewMom"}], "}"}], "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"RunningIndex", " ", "=", " ", 
                   RowBox[{
                    RowBox[{"Length", "@", "AllMomenta"}], "+", "1"}]}], 
                  ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                  "Echo", "[", "\"\<more than one mom in this entry\>\"", 
                   "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"MemberList", " ", "=", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"List", ",", "ExternalMomenta"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "q", "}"}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"AllMomenta", "[", 
                    RowBox[{"[", 
                    RowBox[{"RunningIndex", ",", "#"}], "]"}], "]"}], "}"}], "/.",
                     "SignRules"}]}], "]"}], "&"}], "/@", 
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"AllMomenta", "[", 
                    RowBox[{"[", "RunningIndex", "]"}], "]"}]}]}], "}"}]}], 
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"Echo", "[", "MemberList", "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"AllTrue", "[", 
                    RowBox[{"MemberList", ",", "TrueQ"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "Echo", "[", "\"\<all mom are external\>\"", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PosNewMom", " ", "=", " ", 
                    RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "Echo", "[", "\"\<find out position of false\>\"", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"PosNewMom", " ", "=", " ", 
                    RowBox[{"{", 
                    RowBox[{"RunningIndex", ",", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"List", ",", "ExternalMomenta"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "q", "}"}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"AllMomenta", "[", 
                    RowBox[{"[", 
                    RowBox[{"RunningIndex", ",", "#"}], "]"}], "]"}], "}"}], "/.",
                     "SignRules"}]}], "]"}], "&"}], "/@", 
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"AllMomenta", "[", 
                    RowBox[{"[", "RunningIndex", "]"}], "]"}]}]}], "}"}]}], 
                    "]"}]}], ")"}], ",", "False"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Echo", "[", 
                    RowBox[{"{", 
                    RowBox[{"PosNewMom", ",", 
                    RowBox[{"AllMomenta", "[", 
                    RowBox[{"[", "RunningIndex", "]"}], "]"}]}], "}"}], "]"}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{"RunningIndex", " ", "=", " ", 
                    RowBox[{
                    RowBox[{"Length", "@", "AllMomenta"}], "+", "1"}]}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Echo", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<posNewMom\>\"", ",", "PosNewMom"}], "}"}], 
                "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Echo", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<runningindexEnd\>\"", ",", "RunningIndex"}], "}"}],
              "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Echo", "[", "PosNewMom", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "PosNewMom", "}"}], "]"}]}], "\[Equal]", "1"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AllMomenta", " ", "=", " ", 
             RowBox[{"Drop", "[", 
              RowBox[{"AllMomenta", ",", 
               RowBox[{"{", "PosNewMom", "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Echo", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<AllMomenta\>\"", ",", "AllMomenta"}], "}"}], "]"}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"newVar", " ", "=", " ", 
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{
                RowBox[{"dummyRHS", "[", 
                 RowBox[{"[", 
                  RowBox[{
                  "#", ",", "\"\<indices\>\"", ",", "2", ",", "PosNewMom", 
                   ",", "2"}], "]"}], "]"}], "/.", "FullDeltaList"}], "]"}], "/.",
               "SignRules"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"PrefVar", " ", "=", 
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{
                RowBox[{"dummyRHS", "[", 
                 RowBox[{"[", 
                  RowBox[{
                  "#", ",", "\"\<indices\>\"", ",", "2", ",", "PosNewMom", 
                   ",", "2"}], "]"}], "]"}], "/.", "FullDeltaList"}], "]"}], 
              "/", "newVar"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"MomentumCons", " ", "=", " ", 
             RowBox[{"Flatten", "@", 
              RowBox[{"Solve", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"PrefVar", "*", "newVar"}], " ", "+", " ", 
                    RowBox[{"Total", "[", "AllMomenta", "]"}]}], "/.", 
                   "FullDeltaList"}], ")"}], "\[Equal]", "0"}], ",", 
                "newVar"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Echo", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"PrefVar", "*", "newVar"}], " ", "+", " ", 
                   RowBox[{"Total", "[", "AllMomenta", "]"}]}], "/.", 
                  "FullDeltaList"}], ")"}], "\[Equal]", "0"}], ",", 
               "newVar"}], "}"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Echo", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Length", "@", "dummyRHS"}], "+", "1"}], ")"}], "-",
                 "#"}], ",", "MomentumCons"}], "}"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"FullDeltaList", " ", "=", " ", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Evaluate", "[", 
                RowBox[{"FullDeltaList", "/.", "MomentumCons"}], "]"}], ",", 
               "MomentumCons"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Echo", "[", "FullDeltaList", "]"}], ";"}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"{", "PosNewMom", "}"}], "]"}]}], "\[Equal]", "2"}], 
              ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AllMomenta", " ", "=", " ", 
                RowBox[{"Delete", "[", 
                 RowBox[{"AllMomenta", ",", 
                  RowBox[{"{", "PosNewMom", "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Echo", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<AllMomenta\>\"", ",", "AllMomenta"}], "}"}], 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Echo", "[", "FullDeltaList", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Echo", "[", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Evaluate", "[", 
                   RowBox[{
                    RowBox[{"dummyRHS", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    "#", ",", "\"\<indices\>\"", ",", "2", ",", "All", ",", 
                    "2"}], "]"}], "]"}], "/.", "FullDeltaList"}], "]"}], "/.",
                   "SignRules"}], ")"}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"newVar", " ", "=", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{"dummyRHS", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    "#", ",", "\"\<indices\>\"", ",", "2", ",", "All", ",", 
                    "2"}], "]"}], "]"}], "/.", "FullDeltaList"}], "]"}], "/.",
                    "SignRules"}], ")"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"PosNewMom", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"PosNewMom", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Echo", "[", 
                RowBox[{"(", 
                 RowBox[{"Evaluate", "[", 
                  RowBox[{
                   RowBox[{"dummyRHS", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    "#", ",", "\"\<indices\>\"", ",", "2", ",", "All", ",", 
                    "2"}], "]"}], "]"}], "/.", "FullDeltaList"}], "]"}], 
                 ")"}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"PrefVar", " ", "=", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{"dummyRHS", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    "#", ",", "\"\<indices\>\"", ",", "2", ",", "All", ",", 
                    "2"}], "]"}], "]"}], "/.", "FullDeltaList"}], "]"}], 
                    ")"}], "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"PosNewMom", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"PosNewMom", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "/", 
                  "newVar"}], ")"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Echo", "[", "PrefVar", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"MomentumCons", " ", "=", " ", 
                RowBox[{"Flatten", "@", 
                 RowBox[{"Solve", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"PrefVar", "*", "newVar"}], " ", "+", " ", 
                    RowBox[{"Total", "[", "AllMomenta", "]"}]}], "/.", 
                    "FullDeltaList"}], ")"}], "\[Equal]", "0"}], ",", 
                   "newVar"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Echo", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"PrefVar", "*", "newVar"}], " ", "+", " ", 
                    RowBox[{"Total", "[", "AllMomenta", "]"}]}], "/.", 
                    "FullDeltaList"}], ")"}], "\[Equal]", "0"}], ",", 
                  "newVar"}], "}"}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Echo", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "@", "dummyRHS"}], "+", "1"}], ")"}], 
                   "-", "#"}], ",", "MomentumCons"}], "}"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"FullDeltaList", " ", "=", " ", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Evaluate", "[", 
                   RowBox[{"FullDeltaList", "/.", "MomentumCons"}], "]"}], 
                  ",", "MomentumCons"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Echo", "[", "FullDeltaList", "]"}], ";"}], 
              "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "Nothing"}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}], ")"}], "&"}], "/@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "@", "dummyRHS"}], "+", "1"}], ")"}], "-", "i"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "@", "dummyRHS"}], "-", "1"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "FullDeltaList", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]}], "Input",
 CellChangeTimes->{{3.766385109647072*^9, 3.766385290328933*^9}, {
   3.766385322857348*^9, 3.766385512577093*^9}, {3.7663855766494875`*^9, 
   3.7663856775880632`*^9}, {3.766385711941677*^9, 3.7663858063495626`*^9}, {
   3.766385948430193*^9, 3.766386026978029*^9}, {3.7663860597931256`*^9, 
   3.76638607391183*^9}, {3.766386113324138*^9, 3.766386135579976*^9}, {
   3.766386174456696*^9, 3.766386191095909*^9}, {3.766386221733911*^9, 
   3.7663862408623247`*^9}, {3.7663863180688715`*^9, 3.766386323641594*^9}, {
   3.7663863878488493`*^9, 3.7663864063325405`*^9}, {3.766386584053132*^9, 
   3.766386635974659*^9}, {3.766387232121028*^9, 3.766387245031577*^9}, {
   3.766387276249667*^9, 3.766387284092405*^9}, {3.7663875078003955`*^9, 
   3.7663875316793904`*^9}, 3.766387567955504*^9, {3.766387762543766*^9, 
   3.766387862503895*^9}, {3.766387897797541*^9, 3.766387956717225*^9}, 
   3.766388012348445*^9, 3.7663881031387568`*^9, {3.7663882003438845`*^9, 
   3.766388299860574*^9}, {3.766388498204322*^9, 3.766388655649248*^9}, {
   3.7663887192392488`*^9, 3.766388719549419*^9}, {3.7663927994710255`*^9, 
   3.7663928072373667`*^9}, {3.766392843533431*^9, 3.7663928566438913`*^9}, {
   3.7663929708166323`*^9, 3.7663929772260756`*^9}, {3.766393089790742*^9, 
   3.7663931427312107`*^9}, {3.7663938870849466`*^9, 
   3.7663938948677316`*^9}, {3.7663951763906007`*^9, 
   3.7663951846116514`*^9}, {3.766395232886037*^9, 3.7663953753630757`*^9}, {
   3.766395548507168*^9, 3.7663955512049527`*^9}, {3.7663958751862097`*^9, 
   3.7663959008243213`*^9}, {3.766396032544203*^9, 3.766396056052619*^9}, {
   3.766396335591241*^9, 3.766396412889658*^9}, {3.766396457535302*^9, 
   3.766396601331862*^9}, {3.7663966345858765`*^9, 3.766396644389092*^9}, {
   3.766396698804621*^9, 3.766396733916895*^9}, {3.766396779094417*^9, 
   3.766396899507844*^9}, {3.766396930740155*^9, 3.766396932019735*^9}, {
   3.766397140814598*^9, 3.766397156012968*^9}, {3.7663972073916483`*^9, 
   3.766397212331417*^9}, {3.766397736792144*^9, 3.7663977411844015`*^9}, {
   3.766397782535853*^9, 3.766397821598493*^9}, {3.7663978756629653`*^9, 
   3.766397901840275*^9}, {3.7663980896026945`*^9, 3.7663980931091723`*^9}, {
   3.766398300220535*^9, 3.7663983229478064`*^9}, {3.7663986016227665`*^9, 
   3.766398735350585*^9}, {3.766398825367934*^9, 3.7663988329247317`*^9}, {
   3.766398916373644*^9, 3.766398969687563*^9}, {3.766399064201887*^9, 
   3.766399072713106*^9}, {3.766399102993157*^9, 3.7663991407921524`*^9}, {
   3.7663992603873987`*^9, 3.766399287361289*^9}, 3.7663993279519663`*^9, {
   3.766405266193008*^9, 3.7664052737817245`*^9}, {3.766405309916093*^9, 
   3.7664053271077657`*^9}, {3.766405452243348*^9, 3.7664054526582637`*^9}, {
   3.7664055268668776`*^9, 3.7664055348854113`*^9}, {3.7664055719919844`*^9, 
   3.766405614124732*^9}, {3.7664056736281013`*^9, 3.7664056858709745`*^9}, {
   3.766405733280428*^9, 3.7664057351513968`*^9}, {3.7664058244397135`*^9, 
   3.7664058607505264`*^9}, {3.766405894811655*^9, 3.766405911114144*^9}, {
   3.766406044972668*^9, 3.7664060600264235`*^9}, {3.766406161743493*^9, 
   3.766406202568139*^9}, {3.766489836813903*^9, 3.766489906966224*^9}, {
   3.76649112604281*^9, 3.7664912187513547`*^9}, {3.7664912546283274`*^9, 
   3.7664912627380657`*^9}, {3.7664912972659035`*^9, 3.766491304444949*^9}, {
   3.7667427056017637`*^9, 3.766742717746267*^9}, {3.766743195010149*^9, 
   3.7667432048837333`*^9}, {3.766816170568722*^9, 3.7668161781194305`*^9}, {
   3.7668162311418524`*^9, 3.766816246919703*^9}, {3.768545832299781*^9, 
   3.7685458407113476`*^9}, {3.7685459166085763`*^9, 
   3.7685459204638534`*^9}, {3.768546121663971*^9, 3.7685461236996975`*^9}, {
   3.768546811447302*^9, 3.768546826992834*^9}, {3.7685469515913525`*^9, 
   3.768546952620637*^9}, {3.7685469922168875`*^9, 3.76854710005057*^9}, {
   3.768547185079957*^9, 3.7685471860051937`*^9}, {3.768547300157497*^9, 
   3.768547308898491*^9}, {3.768547415228389*^9, 3.768547498595453*^9}, {
   3.7685475459977746`*^9, 3.768547547742084*^9}, {3.768547752162667*^9, 
   3.7685477657713614`*^9}, {3.768548136328093*^9, 3.7685482013095903`*^9}, {
   3.768548234704027*^9, 3.768548247041083*^9}, {3.7685483448851347`*^9, 
   3.7685483725866385`*^9}, {3.7685484244430275`*^9, 3.768548482415514*^9}, {
   3.7685485572146053`*^9, 3.768548562056175*^9}, {3.76854894988066*^9, 
   3.7685489542463818`*^9}, {3.76854918373363*^9, 3.7685492127095356`*^9}, {
   3.7685492983187304`*^9, 3.768549306194016*^9}, {3.7685493496448717`*^9, 
   3.7685494210022573`*^9}, {3.7685494576293287`*^9, 
   3.7685495182895794`*^9}, {3.768549549240821*^9, 3.7685496028008423`*^9}, {
   3.7685496405224943`*^9, 3.7685496484622693`*^9}, {3.7685497746818905`*^9, 
   3.7685498134722037`*^9}, {3.768631601626584*^9, 3.768631602224029*^9}, {
   3.7686316678086147`*^9, 3.76863167241131*^9}, {3.7686317389815397`*^9, 
   3.768631762017202*^9}, {3.768631920337104*^9, 3.7686319219497633`*^9}, {
   3.768632223428178*^9, 3.768632230029566*^9}, {3.7686323392678556`*^9, 
   3.7686323395092106`*^9}, {3.768632417134062*^9, 3.7686324586445885`*^9}, {
   3.768633161294366*^9, 3.768633183268358*^9}, {3.7688169606316805`*^9, 
   3.768817118748605*^9}, {3.768817156237852*^9, 3.7688171773541903`*^9}, {
   3.768817219450248*^9, 3.768817278777415*^9}, {3.768817308943515*^9, 
   3.7688173465683775`*^9}, {3.768817810346404*^9, 3.768817858803877*^9}, {
   3.7688182249645615`*^9, 3.768818226998704*^9}, {3.7688189395064077`*^9, 
   3.768818992831463*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"6f8807ed-da56-4984-848d-590a22e598bd"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Clear", "[", "ShiftLoopMomentum", "]"}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "adjust", " ", "for", " ", "an", " ", "option", " ", "where", " ", "we", 
      " ", "want"}], " ", "+", 
     RowBox[{"q", " ", "in", " ", "the", " ", "reg"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ShiftLoopMomentum", "[", "diagram_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "diagramnew", ",", "regDerMomentum", ",", "\[IndentingNewLine]", 
        "argnew", ",", "p"}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"regDerMomentum", "=", 
        RowBox[{
         RowBox[{"(", "diagram", ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a_.", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"b_.", " ", 
               RowBox[{"rdot", "[", "x_", "]"}]}], "+", 
              RowBox[{"c__", " ", "d_."}]}], ")"}]}], "\[RuleDelayed]", "  ", 
           "x"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Echo", "[", "regDerMomentum", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"argnew", "=", 
        RowBox[{"First", "[", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"regDerMomentum", "\[Equal]", 
            RowBox[{"-", "qnew"}]}], ",", "q"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"argnew", "/.", 
           RowBox[{"{", 
            RowBox[{"qnew", "\[Rule]", "q"}], "}"}]}], ",", 
          RowBox[{
           RowBox[{"diagram", "/.", "argnew"}], "/.", 
           RowBox[{"{", 
            RowBox[{"qnew", "\[Rule]", "q"}], "}"}]}]}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "*)"}]], "Input",ExpressionUUID->"14225a19-e280-4311-adbe-5d7174e18152"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ConserveMomentum", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConserveMomentum", "[", "expr_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "dummy", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"IntegerQ", "[", "expr", "]"}], "\[Equal]", "True"}], " ", "||",
        " ", 
       RowBox[{
        RowBox[{"IntegerQ", "[", 
         RowBox[{"(", 
          RowBox[{"expr", "/", 
           RowBox[{"(", 
            RowBox[{"expr", "/.", 
             RowBox[{
              RowBox[{"deltaDirac", "[", 
               RowBox[{"a_", ",", "b_"}], "]"}], "\[Rule]", "1"}]}], ")"}]}], 
          ")"}], "]"}], " ", "\[Equal]", " ", "True"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ConserveMomentum", "[", 
       RowBox[{"expr", ",", 
        RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ConserveMomentum", "[", 
       RowBox[{
        RowBox[{"expr", "/.", 
         RowBox[{
          RowBox[{"deltaDirac", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], "\[Rule]", "1"}]}], ",", "   ", 
        RowBox[{"List", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"deltaDirac", "[", 
            RowBox[{"dummy", ",", "dummy"}], "]"}], "*", 
           RowBox[{"Factor", "[", 
            RowBox[{"(", 
             RowBox[{"expr", "/", 
              RowBox[{"(", 
               RowBox[{"expr", "/.", 
                RowBox[{
                 RowBox[{"deltaDirac", "[", 
                  RowBox[{"a_", ",", "b_"}], "]"}], "\[Rule]", "1"}]}], 
               ")"}]}], ")"}], "]"}]}], ")"}]}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConserveMomentum", "[", 
    RowBox[{"expr_", ",", "deltaList_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"newexpr", ",", " ", "newdeltaList"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newexpr", " ", "=", "  ", 
       RowBox[{"expr", "/.", 
        RowBox[{
         RowBox[{"Last", "[", 
          RowBox[{"First", "[", "deltaList", "]"}], "]"}], "\[Rule]", " ", 
         RowBox[{"First", "[", 
          RowBox[{"First", "[", "deltaList", "]"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newdeltaList", " ", "=", " ", 
       RowBox[{
        RowBox[{"Drop", "[", 
         RowBox[{"deltaList", ",", "1"}], "]"}], "/.", 
        RowBox[{
         RowBox[{"Last", "[", 
          RowBox[{"First", "[", "deltaList", "]"}], "]"}], "\[Rule]", " ", 
         RowBox[{"First", "[", 
          RowBox[{"First", "[", "deltaList", "]"}], "]"}]}]}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"is", " ", "this", " ", "correct", 
        RowBox[{"??", "?"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ConserveMomentum", "[", 
       RowBox[{"newexpr", ",", " ", "newdeltaList"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConserveMomentum", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"{", "}"}]}], "]"}], " ", ":=", " ", "expr"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0F1IUwEYxvGzDBtCDuIEpcUIwwwplcDMJJxKnQ46Yc5VZm7KlrozUYaR
TjDzrovCYBDNQUOYRAUp7EItCvrQTRMGmVOxBkPQojBCIgiz8z8XLz94bp6H
90hLp8W1SxCEXPUw69s9UUr/bhqIpx3DVyPWfEwZ9EV4WLztwuv9Gz3YYzzX
j5NvUndRKGnz41q78ACtq31BzHpkCOHv7PgzNFhHp/B5o/E1OvYXv8PHd5JR
jAycnsOhxIsF3KkcW0ZvwdhnbHj6dQsL30f+4MmRq9va7kp3TFa9Od40j+WO
1pp21dK6t1ewfEa0o3n2oxODjmk3SitDCh5acnbhXELRDKQSvZgbO+HDrfq8
++hcPu7HvbWZdQp/ksKaPyXfJVyw7b6MB21CIw7Ltms4WF3qwml7XxvKRvtD
3Ik2BfDi5sYMBpWJeYyGx3Ue1cUytx5fDq9XYNkZsQoPbH5qwdG0iAdD+b1d
uJZ+S9OcU92NGR+8mt1Oi9xBbk5aUGfuUPBoLMeDX2q3OzHUHPaiEJiqMO1R
+0p8F9Cv19mxJk9sxn+nfhQFVQcz689i1d+khKtPTDKe/7UvjhOTNzT/A0DL
Cbw=
  "],
 CellLabel->
  "In[155]:=",ExpressionUUID->"79cf7902-e6a5-430e-9b5d-ec0006b5377b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "RenameLoopMomentum", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RenameLoopMomentum", "[", "expr_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "LoopMomentum", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LoopMomentum", " ", "=", "  ", 
      RowBox[{"Union", "@", 
       RowBox[{"StringCases", "[", 
        RowBox[{
         RowBox[{"ToString", "[", "expr", "]"}], ",", " ", 
         RowBox[{"\"\<p$\>\"", "~~", 
          RowBox[{"DigitCharacter", ".."}]}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Echo", "[", "LoopMomentum", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "LoopMomentum"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ToExpression", "[", "LoopMomentum", "]"}], ",", 
          RowBox[{"expr", "/.", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Rule", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ToExpression", "[", "LoopMomentum", "]"}], ",", 
               RowBox[{"{", "qold", "}"}]}], "}"}]}], "]"}]}]}], "}"}], "]"}],
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Echo", "[", "\"\<noLoopMom\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", "expr"}], "}"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.7621638547253075`*^9, 3.7621638601040735`*^9}, {
  3.7621644867299232`*^9, 3.7621644922561674`*^9}, {3.7621655628319254`*^9, 
  3.7621655762811785`*^9}, {3.762168166704251*^9, 3.762168167625275*^9}, {
  3.762771890186042*^9, 3.762771894992541*^9}, {3.7656126235625715`*^9, 
  3.7656126750850153`*^9}, {3.765612707427741*^9, 3.7656127338144317`*^9}, {
  3.7656127770020795`*^9, 3.765612798809753*^9}, {3.7656129863919325`*^9, 
  3.7656129986952167`*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"8b1aa336-1fbb-4e14-8498-dba55b7ba3b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetDiagramValue", "[", 
   RowBox[{
   "RHS_", ",", "externalfields_", ",", "externalindices_", ",", " ", 
    "fields_", ",", "BRSTfields___"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dummyRHS", " ", "=", " ", "RHS"}], ",", " ", 
      RowBox[{"DiagVars", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"Null", ",", 
         RowBox[{"Length", "@", "RHS"}]}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"DiagVars", "[", 
            RowBox[{"[", "#", "]"}], "]"}], ",", " ", 
           RowBox[{"dummyRHS", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], "}"}], " ", "=", " ", 
         RowBox[{"InsertFeynRules", "[", 
          RowBox[{
           RowBox[{"dummyRHS", "[", 
            RowBox[{"[", "#", "]"}], "]"}], ",", " ", "externalfields", ",", 
           " ", "externalindices", ",", " ", "fields", ",", " ", 
           "BRSTfields"}], "]"}]}], ")"}], "&"}], "/@", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "dummyRHS"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"DiagVars", ",", "dummyRHS"}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.761456746180703*^9, 3.7614569594460955`*^9}, 
   3.7614570233227553`*^9, {3.7614571046183023`*^9, 3.7614571091370306`*^9}, {
   3.7627730616492376`*^9, 3.76277306377116*^9}, {3.7651844095926123`*^9, 
   3.7651844117941294`*^9}, {3.7656107461032634`*^9, 3.7656107718663898`*^9}, 
   3.7656111882837677`*^9},
 CellLabel->
  "In[159]:=",ExpressionUUID->"f8a32361-555c-4077-be12-7110b34862a0"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ConservePropMomentum", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConservePropMomentum", "[", 
   RowBox[{"diagram_", ",", "deltaList_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newdiagram", ",", " ", "newdeltaList"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"List", "@@", 
          RowBox[{"Sign", "[", 
           RowBox[{"Last", "[", 
            RowBox[{"First", "[", "deltaList", "]"}], "]"}], "]"}]}], "]"}], "==",
         "1"}], ","}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newdiagram", " ", "=", "  ", 
      RowBox[{
       RowBox[{"diagram", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Last", "[", 
           RowBox[{"First", "[", "deltaList", "]"}], "]"}], "\[Rule]", " ", 
          RowBox[{"(", 
           RowBox[{"(*", "-", "*)"}], 
           RowBox[{"First", "[", 
            RowBox[{"First", "[", "deltaList", "]"}], "]"}], ")"}]}], "}"}]}],
        "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newdeltaList", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Drop", "[", 
         RowBox[{"deltaList", ",", "1"}], "]"}], "/.", 
        RowBox[{
         RowBox[{"Last", "[", 
          RowBox[{"First", "[", "deltaList", "]"}], "]"}], "\[Rule]", " ", 
         RowBox[{"(", 
          RowBox[{"(*", "-", "*)"}], 
          RowBox[{"First", "[", 
           RowBox[{"First", "[", "deltaList", "]"}], "]"}], ")"}]}]}], "//", 
       "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newdiagram", " ", "=", "  ", 
           RowBox[{
            RowBox[{"diagram", "/.", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"-", 
                RowBox[{"Last", "[", 
                 RowBox[{"First", "[", "deltaList", "]"}], "]"}]}], ")"}], 
              "\[Rule]", " ", 
              RowBox[{"First", "[", 
               RowBox[{"First", "[", "deltaList", "]"}], "]"}]}]}], "//", 
            "Simplify"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"newdeltaList", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Drop", "[", 
              RowBox[{"deltaList", ",", "1"}], "]"}], "/.", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"-", 
                RowBox[{"Last", "[", 
                 RowBox[{"First", "[", "deltaList", "]"}], "]"}]}], ")"}], 
              "\[Rule]", " ", 
              RowBox[{"First", "[", 
               RowBox[{"First", "[", "deltaList", "]"}], "]"}]}]}], "//", 
            "Simplify"}]}], ";"}]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"ConservePropMomentum", "[", 
      RowBox[{"newdiagram", ",", " ", "newdeltaList"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConservePropMomentum", "[", 
   RowBox[{"diagram_", ",", 
    RowBox[{"{", "}"}]}], "]"}], " ", ":=", " ", "diagram", " "}]}], "Input",
 CellChangeTimes->{
  3.7620863657144613`*^9, {3.7620863989173846`*^9, 3.7620864670022373`*^9}, {
   3.7620875460859456`*^9, 3.7620875489678583`*^9}, {3.762087840776084*^9, 
   3.7620878527842584`*^9}, {3.7621630510322294`*^9, 
   3.7621630521123734`*^9}, {3.766157060640643*^9, 3.7661570662086344`*^9}, {
   3.7661573960183783`*^9, 3.766157400921276*^9}, {3.7661574470766134`*^9, 
   3.7661574652787013`*^9}, {3.7661575767588825`*^9, 
   3.7661576844376454`*^9}, {3.76615783114886*^9, 3.766157849236057*^9}, {
   3.7661579620209427`*^9, 3.7661579682488794`*^9}, {3.766158081359129*^9, 
   3.766158083928341*^9}, {3.766158202578946*^9, 3.7661582561800666`*^9}, {
   3.76629932811537*^9, 3.766299369976962*^9}, {3.766300787840641*^9, 
   3.766300797439506*^9}, {3.7663008284727573`*^9, 3.7663008355360804`*^9}, {
   3.766301808693799*^9, 3.7663018169760647`*^9}, {3.766305456311121*^9, 
   3.7663054745800867`*^9}, {3.766305765398715*^9, 3.766305787446353*^9}, {
   3.7663063378580294`*^9, 3.766306340640306*^9}, {3.76630823807141*^9, 
   3.766308242314084*^9}, {3.7663083204865165`*^9, 3.7663083279256015`*^9}, {
   3.766308497719701*^9, 3.7663085049952745`*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"2c8605d3-2419-4351-b42d-5ef31b0110d3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Aux Functions", "Subsection",
 CellChangeTimes->{{3.7752099914060445`*^9, 
  3.775209995907121*^9}},ExpressionUUID->"a559ea9c-7198-42bc-a828-\
c0c69e1b6789"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "FindFirstVertex", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindFirstVertex", "[", 
   RowBox[{"diag_", ",", " ", "firstsuperindex_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "posFirstVertex", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myEcho", "[", 
      RowBox[{"\"\<FindFirstVertex\>\"", ",", "3"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"pattern", " ", "=", " ", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<nPoint\>\""}], ",", 
        RowBox[{"\"\<indices\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"___", ",", 
           RowBox[{"{", 
            RowBox[{"___", ",", "firstsuperindex"}], "}"}], ",", "___"}], 
          "}"}]}], ",", "__"}], "\[RightAssociation]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"posFirstVertex", " ", "=", " ", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"diag", ",", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"diag", ",", "pattern"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"myEcho", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Position of first vertex\>\"", ",", "posFirstVertex"}], 
        "}"}], ",", "3"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "posFirstVertex", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQnTv5ncxShTeOIn3xziC6q/+KP4jO4DkSAqKLAtk2
gWima93bQXTL4qoDIFrSUuAgiL72QfwkiLbR7wPTZY+OnAfRq+6wXgDRlzJb
roDoJ8uXPQXRCQsdmZaB1Gk0sIBosUc9uiC61+irAYg2LE93ANFrZj91BNGa
J9eEgmhn4wdgeoVnVQqIlnPvBdNVL8ozQPT7ouBMEK13ybPqGJB2sFnWCKL9
brybDaKVVJo3gOg9H25sAdFGX75vBdEtO1/vBNFND2V2geg7Kl37QLTZ1dn7
QfTZGaUnwHyOp+dA9CSPl8angHSlF48JiAYAO9KivQ==
  "],
 CellLabel->
  "In[125]:=",ExpressionUUID->"46be70e7-de70-4dd9-9f2d-3558ff35b6f0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindFirstVertex", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Prefactor\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"-", 
        FractionBox["1", "2"]}], "}"}]}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<Propagator\>\""}], ",", 
       RowBox[{"\"\<indices\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", "i"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"cbar", ",", "i$3391"}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<nPoint\>\""}], ",", 
       RowBox[{"\"\<indices\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", "iext$3389"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"cbar", ",", "i$3391"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", "i$3392"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"\"\<nPoint\>\"", "\[Rule]", "3"}], ",", 
       RowBox[{"\"\<spec\>\"", "\[Rule]", "\"\<none\>\""}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<Propagator\>\""}], ",", 
       RowBox[{"\"\<indices\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", "i$3392"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"cbar", ",", "i$3408"}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<nPoint\>\""}], ",", 
       RowBox[{"\"\<indices\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", "iext$3400"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"cbar", ",", "i$3408"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", "i$3409"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"\"\<nPoint\>\"", "\[Rule]", "3"}], ",", 
       RowBox[{"\"\<spec\>\"", "\[Rule]", "\"\<none\>\""}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<Propagator\>\""}], ",", 
       RowBox[{"\"\<indices\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", "i$3409"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"cbar", ",", "j"}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<Regulatordot\>\""}], ",", 
       RowBox[{"\"\<indices\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"cbar", ",", "j"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", "i"}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}]}], "}"}], ",", "iext$3389"}], "]"}]], "Input",
 CellChangeTimes->{{3.7752118658287067`*^9, 3.7752118989545307`*^9}, 
   3.775212134690279*^9, 3.7752130726432123`*^9, 3.775280027805232*^9, {
   3.7752800629642625`*^9, 3.775280072140179*^9}, {3.7752804121228476`*^9, 
   3.775280416373153*^9}, {3.775287716994359*^9, 3.775287717181815*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"a9f0eb58-f735-4600-90ff-1a05f1563b46"],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{{3.7752800732339735`*^9, 3.775280107644807*^9}, 
   3.7752801424922094`*^9, {3.775280357887068*^9, 3.7752803739153023`*^9}, {
   3.775280417013876*^9, 3.7752804274157453`*^9}, 3.775280489620081*^9, {
   3.7752805555138717`*^9, 3.7752805606079316`*^9}, 3.7752805946370926`*^9, {
   3.775280630431862*^9, 3.775280634291391*^9}, {3.775280699752384*^9, 
   3.7752807613288507`*^9}, 3.775287717822717*^9, 3.7753644824336147`*^9, 
   3.775372774893487*^9},
 CellLabel->
  "Out[127]=",ExpressionUUID->"13b85e15-c850-4872-a72c-7948f6fe68dd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "gives", " ", "the", " ", "correct", " ", "number", " ", "of", " ", 
    "indices", " ", "for", " ", "the", " ", "prop", " ", "fields"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "SuperindexRules", "]"}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SuperindexRules", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"field1_", ",", "a_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"field2_", ",", "b_"}], "}"}]}], "}"}], ",", "fields_"}], 
     "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "positionField1", ",", "superindices1", ",", "superindices2", ",", 
        "indicesNew"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"myEcho", "[", 
        RowBox[{"\"\<Superindex Rules\>\"", ",", "3"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"positionField1", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{"Head", ",", 
                RowBox[{"fields", "[", 
                 RowBox[{"[", 
                  RowBox[{"\"\<bosonic\>\"", ",", "All"}], "]"}], "]"}]}], 
               "]"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{"Head", ",", 
                RowBox[{"Flatten", "@", 
                 RowBox[{"fields", "[", 
                  RowBox[{"[", 
                   RowBox[{"\"\<fermionic\>\"", ",", "All"}], "]"}], 
                  "]"}]}]}], "]"}]}], "]"}]}], ",", "field1"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"superindices1", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{"Unique", ",", 
          RowBox[{"List", "@@", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Flatten", "@", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"fields", "[", 
                 RowBox[{"[", 
                  RowBox[{"\"\<bosonic\>\"", ",", "All"}], "]"}], "]"}], ",", 
                RowBox[{"fields", "[", 
                 RowBox[{"[", 
                  RowBox[{"\"\<fermionic\>\"", ",", "All"}], "]"}], "]"}]}], 
               "]"}]}], ")"}], "[", 
            RowBox[{"[", "positionField1", "]"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"superindices2", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{"Unique", ",", 
          RowBox[{"List", "@@", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Flatten", "@", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"fields", "[", 
                 RowBox[{"[", 
                  RowBox[{"\"\<bosonic\>\"", ",", "All"}], "]"}], "]"}], ",", 
                RowBox[{"fields", "[", 
                 RowBox[{"[", 
                  RowBox[{"\"\<fermionic\>\"", ",", "All"}], "]"}], "]"}]}], 
               "]"}]}], ")"}], "[", 
            RowBox[{"[", "positionField1", "]"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"indicesNew", " ", "=", " ", 
        RowBox[{"(*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"field1", ",", "superindices1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"field2", ",", "superindices2"}], "}"}]}], "}"}], "*)"}], 
        RowBox[{"{", 
         RowBox[{"superindices1", ",", "superindices2"}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "indicesNew", "]"}]}]}], "\n", 
     "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.761294165124239*^9, 3.7612942049521046`*^9}, {
   3.761294429579362*^9, 3.7612945325619564`*^9}, {3.7612993933832865`*^9, 
   3.7612994536182995`*^9}, {3.7612996505708537`*^9, 3.761299652554392*^9}, {
   3.761299849411281*^9, 3.76129992087298*^9}, {3.7613000892892737`*^9, 
   3.7613001313681927`*^9}, {3.7613002130772595`*^9, 
   3.7613002748473597`*^9}, {3.7613003383135834`*^9, 3.761300450894662*^9}, {
   3.761300487560414*^9, 3.7613005171503983`*^9}, {3.7613005599039893`*^9, 
   3.761300587570051*^9}, {3.761300625387249*^9, 3.7613006522479153`*^9}, {
   3.761300685358889*^9, 3.761300685955324*^9}, {3.761305020599666*^9, 
   3.7613050402240314`*^9}, 3.7613050890188503`*^9, {3.76130514515767*^9, 
   3.7613051677055798`*^9}, {3.7613053887211876`*^9, 3.761305435515271*^9}, {
   3.761898097626832*^9, 3.761898134417116*^9}, {3.7620839230182447`*^9, 
   3.762083927574035*^9}, {3.7620840674317665`*^9, 3.7620841250585227`*^9}, {
   3.7620841860907173`*^9, 3.762084232934188*^9}, {3.762772446914625*^9, 
   3.7627724709395323`*^9}, {3.762773306773173*^9, 3.7627733389937572`*^9}, {
   3.7627734420786467`*^9, 3.762773510558077*^9}, {3.7644794538744116`*^9, 
   3.764479455451689*^9}, 3.7644831116768413`*^9, {3.765183658642869*^9, 
   3.7651836678974886`*^9}, {3.765207034598666*^9, 3.765207036767997*^9}, 
   3.765208008056156*^9, 3.775281224772264*^9, {3.775281255337457*^9, 
   3.775281299941157*^9}, {3.7752813467877135`*^9, 3.7752813498240814`*^9}, {
   3.775281418853651*^9, 3.775281476778876*^9}, {3.775283077360478*^9, 
   3.7752830783605213`*^9}, {3.7752831898068695`*^9, 
   3.7752832411069927`*^9}, {3.7752832737883053`*^9, 
   3.7752832993721457`*^9}, {3.77528333369664*^9, 3.7752833592237444`*^9}, {
   3.7752834138390207`*^9, 3.7752837052149076`*^9}, {3.775286036623576*^9, 
   3.77528604296837*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"30413f8f-f67c-430e-b162-8f9a64931bf1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SuperindexRules", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "i"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"cbar", ",", "i$3391"}], "}"}]}], "}"}], ",", "fields"}], 
  "]"}]], "Input",
 CellChangeTimes->{3.77528131692575*^9, 3.7752813634841805`*^9},
 CellLabel->
  "In[130]:=",ExpressionUUID->"9cbfd97c-04d4-415c-bd60-d4cb3f0e4c78"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p$3770", ",", "i$3771"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p$3772", ",", "i$3773"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7752813177852187`*^9, 3.775281363780908*^9, 3.7752835449751434`*^9, {
   3.7752835805023355`*^9, 3.7752837061211953`*^9}, 3.775364482730421*^9, 
   3.775372775002836*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"242fcd79-d4b1-4fd3-bf3c-12ad5f2f9e01"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SuperindexRules", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"A", ",", "i"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"A", ",", "i$3391"}], "}"}]}], "}"}], ",", "fields"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.775283718450838*^9, 3.7752837194665833`*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"8815aae7-829f-4e59-bbc5-4feca6155e80"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p$3775", ",", 
     RowBox[{"{", 
      RowBox[{"mu$3776", ",", "i$3776"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p$3777", ",", 
     RowBox[{"{", 
      RowBox[{"mu$3778", ",", "i$3778"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.77528372034133*^9, 3.7753644830278206`*^9, 
  3.775372775080943*^9},
 CellLabel->
  "Out[131]=",ExpressionUUID->"bd92a6a4-6447-41f4-9135-690330b7b3bb"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Clear", "[", "FindPositionNewMomentum", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindPositionNewMomentum", "[", 
   RowBox[{
   "allmomenta_", ",", "externalMomenta_", ",", "signRules_", ",", 
    "loopMom_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"iter", ",", "posNewMom", ",", "memberList"}], "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"myEcho", "[", 
      RowBox[{"\"\<Find Position New\>\"", ",", "5"}], "]"}], ";", "\n", "\n", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"iter", " ", "\[LessEqual]", 
        RowBox[{"Length", "@", "allmomenta"}]}], ",", " ", 
       RowBox[{"iter", "++"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"myEcho", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<check index if new momentum: \>\"", ",", " ", 
            RowBox[{"allmomenta", "[", 
             RowBox[{"[", "iter", "]"}], "]"}]}], "}"}], ",", "5"}], "]"}], 
        ";", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{"List", ",", "externalMomenta"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", "loopMom", "}"}], "}"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"allmomenta", "[", 
               RowBox[{"[", "iter", "]"}], "]"}], "}"}], "/.", 
             "signRules"}]}], "]"}], ",", "\n", "\t\t", 
          RowBox[{
           RowBox[{"posNewMom", " ", "=", " ", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"myEcho", "[", 
            RowBox[{"\"\<no new mom\>\"", ",", "5"}], "]"}], ";"}], 
          "\[IndentingNewLine]", "\t\t", ",", "\[IndentingNewLine]", "\t", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{"List", "@@@", 
                    RowBox[{"{", 
                    RowBox[{"allmomenta", "[", 
                    RowBox[{"[", "iter", "]"}], "]"}], "}"}]}], "]"}], "/.", 
                   "signRules"}], ")"}], "/.", 
                 RowBox[{
                  RowBox[{"n_", "?", "NumericQ"}], "\[Rule]", "Nothing"}]}], 
                ")"}]}], "==", "1"}], ",", "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{
              RowBox[{"myEcho", "[", 
               RowBox[{"\"\<only one mom in this entry\>\"", ",", "5"}], 
               "]"}], ";", "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"posNewMom", " ", "=", " ", "iter"}], ";", 
              "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"myEcho", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\"\<newmom\>\"", ",", " ", 
                  RowBox[{"allmomenta", "[", 
                   RowBox[{"[", "iter", "]"}], "]"}], ",", " ", "posNewMom"}],
                  "}"}], ",", "5"}], "]"}], ";", "\[IndentingNewLine]", 
              "\t\t\t", 
              RowBox[{"iter", " ", "=", " ", 
               RowBox[{
                RowBox[{"Length", "@", "allmomenta"}], "+", "1"}]}], ";"}], 
             "\[IndentingNewLine]", "\t\t\t", ",", "\[IndentingNewLine]", 
             "\t\t\t", 
             RowBox[{
              RowBox[{"myEcho", "[", 
               RowBox[{"\"\<more than one mom in this entry\>\"", ",", "5"}], 
               "]"}], ";", "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"memberList", " ", "=", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"List", ",", "externalMomenta"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "loopMom", "}"}], "}"}]}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"allmomenta", "[", 
                    RowBox[{"[", 
                    RowBox[{"iter", ",", "#"}], "]"}], "]"}], "}"}], "/.", 
                    "signRules"}]}], "]"}], "&"}], "/@", 
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"allmomenta", "[", 
                    RowBox[{"[", "iter", "]"}], "]"}]}]}], "}"}]}], "]"}]}]}],
               ";", "\[IndentingNewLine]", "\t\t\t", "\[IndentingNewLine]", 
              "\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"AllTrue", "[", 
                 RowBox[{"memberList", ",", "TrueQ"}], "]"}], ",", 
                "\[IndentingNewLine]", "\t\t\t\t", 
                RowBox[{
                 RowBox[{"myEcho", "[", 
                  RowBox[{"\"\<all mom are external\>\"", ",", "5"}], "]"}], 
                 ";", "\[IndentingNewLine]", "\t\t\t\t", 
                 RowBox[{"posNewMom", " ", "=", " ", 
                  RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
                "\t\t\t\t", ",", "\[IndentingNewLine]", "\t\t\t\t", 
                RowBox[{
                 RowBox[{"myEcho", "[", 
                  RowBox[{"\"\<find out position of false\>\"", ",", "5"}], 
                  "]"}], ";", "\[IndentingNewLine]", "\t\t\t\t", 
                 RowBox[{"posNewMom", " ", "=", " ", 
                  RowBox[{"{", 
                   RowBox[{"iter", ",", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"List", ",", "externalMomenta"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "loopMom", "}"}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"allmomenta", "[", 
                    RowBox[{"[", 
                    RowBox[{"iter", ",", "#"}], "]"}], "]"}], "}"}], "/.", 
                    "signRules"}]}], "]"}], "&"}], "/@", 
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"allmomenta", "[", 
                    RowBox[{"[", "iter", "]"}], "]"}]}]}], "}"}]}], "]"}]}], 
                    ")"}], ",", "False"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}]}], ";", 
                 "\[IndentingNewLine]", "\t\t\t\t", 
                 RowBox[{"iter", " ", "=", " ", 
                  RowBox[{
                   RowBox[{"Length", "@", "allmomenta"}], "+", "1"}]}], 
                 ";"}]}], "\[IndentingNewLine]", "\t\t\t", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "\t\t", "]"}], ";", "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"myEcho", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<posNewMom\>\"", ",", "posNewMom"}], "}"}], ",", 
             "5"}], "]"}], ";"}]}], "\[IndentingNewLine]", "\t", "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\n", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "posNewMom", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Code",
 CellChangeTimes->{{3.7752947404236836`*^9, 3.775295065224693*^9}, {
   3.7752966243900795`*^9, 3.775296667116191*^9}, {3.77529669737292*^9, 
   3.7752969124114933`*^9}, {3.7752972411147304`*^9, 3.775297297421282*^9}, {
   3.7752975471192474`*^9, 3.7752976004496117`*^9}, {3.775369249099407*^9, 
   3.7753692571205535`*^9}, 3.7753725223487864`*^9},
 CellLabel->
  "In[132]:=",ExpressionUUID->"ad8f0e7d-d3e9-43c9-9391-772f2790bc64"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindPositionNewMomentum", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "p"}], "-", "q"}], ",", "p$138684"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "p"}], ",", "p"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"q$_", " ", 
      RowBox[{"n$_", "?", "NumericQ"}]}], "\[Rule]", "q"}], "}"}], ",", "q"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.7753692159066467`*^9, 3.7753692236888924`*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"2f16505f-8546-4a84-9c14-a44c292e1644"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.7753692249707465`*^9, 3.775369259379711*^9, 
  3.775369416910201*^9, 3.7753727751753454`*^9},
 CellLabel->
  "Out[134]=",ExpressionUUID->"91c7c5e4-21eb-49f0-87fd-fe289a577ba7"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Clear", "[", "FixMomentum", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FixMomentum", "[", 
   RowBox[{
   "object_", ",", "posNewMom_", ",", "allmomenta_", ",", "fullDeltaList_", 
    ",", "signRules_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "allmomentanew", ",", "newVar", ",", " ", "prefVar", ",", "momentumCons",
       ",", " ", 
      RowBox[{"newfullDeltaList", " ", "=", " ", "fullDeltaList"}]}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myEcho", "[", 
      RowBox[{"\"\<Fix Momentum\>\"", ",", "5"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "posNewMom", "}"}], "]"}]}], "\[Equal]", "1"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myEcho", "[", 
         RowBox[{"\"\<only one new mom\>\"", ",", "5"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"allmomentanew", " ", "=", " ", 
         RowBox[{"Drop", "[", 
          RowBox[{"allmomenta", ",", 
           RowBox[{"{", "posNewMom", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"newVar", " ", "=", " ", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"object", "[", 
             RowBox[{"[", 
              RowBox[{
              "\"\<indices\>\"", ",", "posNewMom", ",", "2", ",", "1"}], 
              "]"}], "]"}], "/.", "fullDeltaList"}], "]"}], "/.", 
          "signRules"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"prefVar", " ", "=", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"object", "[", 
             RowBox[{"[", 
              RowBox[{
              "\"\<indices\>\"", ",", "posNewMom", ",", "2", ",", "1"}], 
              "]"}], "]"}], "/.", "fullDeltaList"}], "]"}], "/", "newVar"}]}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"momentumCons", " ", "=", " ", 
         RowBox[{"Flatten", "@", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"prefVar", "*", "newVar"}], " ", "+", " ", 
                RowBox[{"Total", "[", "allmomentanew", "]"}]}], "/.", 
               "fullDeltaList"}], ")"}], "\[Equal]", "0"}], ",", "newVar"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"newfullDeltaList", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"fullDeltaList", "/.", "momentumCons"}], "]"}], ",", 
           "momentumCons"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", "posNewMom", "}"}], "]"}]}], "\[Equal]", "2"}], ",",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myEcho", "[", 
            RowBox[{"\"\<more than one new mom\>\"", ",", "5"}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"allmomentanew", " ", "=", " ", 
            RowBox[{"Delete", "[", 
             RowBox[{"allmomenta", ",", 
              RowBox[{"{", "posNewMom", "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"newVar", " ", "=", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Evaluate", "[", 
                RowBox[{
                 RowBox[{"object", "[", 
                  RowBox[{"[", 
                   RowBox[{
                   "\"\<indices\>\"", ",", "2", ",", "All", ",", "2", ",", 
                    "1"}], "]"}], "]"}], "/.", "fullDeltaList"}], "]"}], "/.",
                "signRules"}], ")"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"posNewMom", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"posNewMom", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"prefVar", " ", "=", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{
                  RowBox[{"object", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    "\"\<indices\>\"", ",", "2", ",", "All", ",", "2", ",", 
                    "1"}], "]"}], "]"}], "/.", "fullDeltaList"}], "]"}], 
                ")"}], "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"posNewMom", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"posNewMom", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "/", 
              "newVar"}], ")"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"momentumCons", " ", "=", " ", 
            RowBox[{"Flatten", "@", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"prefVar", "*", "newVar"}], " ", "+", " ", 
                   RowBox[{"Total", "[", "allmomentanew", "]"}]}], "/.", 
                  "fullDeltaList"}], ")"}], "\[Equal]", "0"}], ",", 
               "newVar"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"newfullDeltaList", " ", "=", " ", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{"fullDeltaList", "/.", "momentumCons"}], "]"}], ",", 
              "momentumCons"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "Nothing"}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "newfullDeltaList", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7752975098077526`*^9, 3.7752975420465574`*^9}, {
  3.7752976102161264`*^9, 3.7752976127791233`*^9}, {3.775297651816385*^9, 
  3.775297895582494*^9}, {3.7752979771280327`*^9, 3.7752980654114447`*^9}, {
  3.7752980996426473`*^9, 3.7752981132441864`*^9}, {3.7752983533582573`*^9, 
  3.775298461509453*^9}, {3.775298492194423*^9, 3.7752985103049307`*^9}, {
  3.7753685240058937`*^9, 3.775368569617834*^9}, {3.7753694027347546`*^9, 
  3.7753694079696064`*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"2cce13d4-4aa2-4f57-b2db-413e31d36a5a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FixMomentum", "[", 
  RowBox[{
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<Propagator\>\""}], ",", 
     RowBox[{"\"\<indices\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"A", ",", 
          RowBox[{"{", 
           RowBox[{"p$87607", ",", 
            RowBox[{"{", 
             RowBox[{"mu$87608", ",", "i$87608"}], "}"}]}], "}"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", 
          RowBox[{"{", 
           RowBox[{"p$87609", ",", 
            RowBox[{"{", 
             RowBox[{"mu$87610", ",", "i$87610"}], "}"}]}], "}"}]}], "}"}]}], 
       "}"}]}]}], "\[RightAssociation]"}], ",", "2", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "q"}], ",", "p$87609"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p$87607", "\[Rule]", 
     RowBox[{"-", "q"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"q$_", " ", 
      RowBox[{"n$_", "?", "NumericQ"}]}], "\[Rule]", "q"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.775368474449996*^9, 3.7753684773455715`*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"dc50e2c3-9f19-43de-bd86-a8c0b3d44d5b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"p$87607", "\[Rule]", 
    RowBox[{"-", "q"}]}], ",", 
   RowBox[{"p$87609", "\[Rule]", "q"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7753684784077477`*^9, {3.77536853530917*^9, 3.7753685751501303`*^9}, 
   3.7753694193635936`*^9, 3.7753727752690783`*^9},
 CellLabel->
  "Out[137]=",ExpressionUUID->"b9654f10-3762-4d81-85e4-7b6b39e2747c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "somehow", " ", "it", " ", "also", " ", "fixes", " ", "external", " ", 
     "momenta"}], "..."}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", "MomentumConservationVert", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MomentumConservationVert", "[", 
     RowBox[{
     "diag_", ",", "replacementList_", ",", "positionFirstVert_", ",", 
      "loopMom_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"newReplList", " ", "=", " ", "replacementList"}], ",", 
        "externalMomenta", ",", "signRules", ",", "newVar", ",", " ", 
        "prefVar", ",", "posNewMom", ",", "RunningIndex", ",", "MemberList", 
        ",", 
        RowBox[{"FullDeltaList", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"MomentumCons", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ",", " ", "allMomenta"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"newReplList", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"List", "@@", 
             RowBox[{"(", 
              RowBox[{"replacementList", "[", 
               RowBox[{"[", 
                RowBox[{"#", ",", "2"}], "]"}], "]"}], ")"}]}], ")"}], "&"}], 
          "/@", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "@", "replacementList"}]}], "}"}]}], "]"}]}], 
         ")"}]}], 
       RowBox[{"(*", 
        RowBox[{"[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "*)"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"signRules", " ", "=", "  ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"n_", "?", "NumericQ"}], "*", "q_"}], " ", "\[Rule]", 
          "loopMom"}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"externalMomenta", " ", "=", " ", 
        RowBox[{"replacementList", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2", ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "check", " ", "which", " ", "entry", " ", "is", " ", "to", " ", "the",
          " ", "right", " ", "of", " ", "the", " ", "first", " ", "vertex"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"positionFirstVert", "<", 
          RowBox[{"Length", "@", "diag"}]}], ",", "                ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"diag", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"positionFirstVert", "+", "1"}], ",", 
                   "\"\<indices\>\"", ",", "All", ",", "2"}], "]"}], "]"}], 
                ",", 
                RowBox[{"diag", "[", 
                 RowBox[{"[", 
                  RowBox[{
                  "positionFirstVert", ",", "\"\<indices\>\"", ",", "#", ",", 
                   "2"}], "]"}], "]"}]}], "]"}], ",", "    ", 
              "\[IndentingNewLine]", "  ", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"newVar", " ", "=", " ", 
                RowBox[{"diag", "[", 
                 RowBox[{"[", 
                  RowBox[{
                  "positionFirstVert", ",", "\"\<indices\>\"", ",", "#", ",", 
                   "2", ",", "1"}], "]"}], "]"}]}], ";"}]}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], "&"}], "/@", 
           RowBox[{"Table", "[", 
            RowBox[{"i", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "@", 
                RowBox[{"diag", "[", 
                 RowBox[{"[", 
                  RowBox[{
                  "positionFirstVert", ",", "\"\<indices\>\"", ",", "All", 
                   ",", "2"}], "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"diag", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "\"\<indices\>\"", ",", "All", ",", "2"}],
                   "]"}], "]"}], ",", 
                RowBox[{"diag", "[", 
                 RowBox[{"[", 
                  RowBox[{
                  "positionFirstVert", ",", "\"\<indices\>\"", ",", "#", ",", 
                   "2"}], "]"}], "]"}]}], "]"}], ",", "   ", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"newVar", " ", "=", " ", 
                RowBox[{"diag", "[", 
                 RowBox[{"[", 
                  RowBox[{
                  "positionFirstVert", ",", "\"\<indices\>\"", ",", "#", ",", 
                   "2", ",", "1"}], "]"}], "]"}]}], ";"}]}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], "&"}], "/@", 
           RowBox[{"Table", "[", 
            RowBox[{"i", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "@", 
                RowBox[{"diag", "[", 
                 RowBox[{"[", 
                  RowBox[{
                  "positionFirstVert", ",", "\"\<indices\>\"", ",", "All", 
                   ",", "2"}], "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"myEcho", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<momentum which connects to the right of the first vertex is: \
\>\"", ",", "newVar"}], "}"}], ",", "4"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"...", "..."}], "..."}], "..."}], "..."}], 
                    "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], 
                    "..."}], "..."}], "..."}], "where", " ", "does", " ", 
                 "PrefVar", " ", "come", " ", "from"}], "..."}], "..."}], 
              "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"check", " ", "if", " ", "there", " ", "is", " ", "any", " ", 
         RowBox[{"loop", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"{", "positionFirstVert", "}"}]}], ">", "0"}], ",", 
         "           ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"MomentumCons", " ", "=", " ", 
           RowBox[{"Flatten", "@", 
            RowBox[{"Solve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"newVar", "+", "loopMom"}], "\[Equal]", "0"}], ",", 
              "newVar"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"MomentumCons", " ", "=", " ", 
           RowBox[{"Flatten", "@", 
            RowBox[{"Solve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"prefVar", "*", "newVar"}], "+", 
                RowBox[{"replacementList", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}]}], 
               "\[Equal]", "0"}], ",", "newVar"}], "]"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"myEcho", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Momentum cons.: \>\"", ",", " ", "MomentumCons"}], 
          "}"}], ",", "4"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"...", "..."}], "..."}], "..."}], "..."}], 
                    "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], 
                    "..."}], "..."}], "..."}], "where", " ", "does", " ", 
                 "PrefVar", " ", "come", " ", "from"}], "..."}], "..."}], 
              "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"FullDeltaList", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"FullDeltaList", "/.", "MomentumCons"}], "]"}], ",", 
          "MomentumCons"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"myEcho", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Delta List of momenta: \>\"", ",", "FullDeltaList"}], 
          "}"}], ",", "4"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "go", " ", "through", " ", "the", " ", "diagram", " ", "from", " ", 
          "left", " ", "to", " ", "right"}], ",", " ", 
         RowBox[{
         "starting", " ", "from", " ", "the", " ", "first", " ", "vertex"}]}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myEcho", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<check object no. \>\"", ",", "#"}], "}"}], ",", 
             "4"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"allMomenta", " ", "=", " ", 
            RowBox[{
             RowBox[{"diag", "[", 
              RowBox[{"[", 
               RowBox[{
               "#", ",", "\"\<indices\>\"", ",", "All", ",", "2", ",", "1"}], 
               "]"}], "]"}], "/.", "FullDeltaList"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"myEcho", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<all momenta in the object which is momentum fixed right \
now\>\"", ",", "allMomenta"}], "}"}], ",", "4"}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "find", " ", "out", " ", "position", " ", "of", " ", "new", " ", 
             "momentum", " ", "which", " ", "is", " ", "not", " ", "yet", " ",
              "fixed"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"myEcho", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<here.............................\>\"", ",", "allMomenta", 
               ",", "externalMomenta", ",", "signRules", ",", "loopMom"}], 
              "}"}], ",", "6"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"posNewMom", " ", "=", " ", 
            RowBox[{"FindPositionNewMomentum", "[", 
             RowBox[{
             "allMomenta", ",", "externalMomenta", ",", "signRules", ",", 
              "loopMom"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"myEcho", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<here.............................\>\"", ",", 
               RowBox[{"diag", "[", 
                RowBox[{"[", "#", "]"}], "]"}], ",", "posNewMom", ",", 
               "allMomenta", ",", "FullDeltaList", ",", "signRules"}], "}"}], 
             ",", "6"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"FullDeltaList", " ", "=", " ", 
            RowBox[{"FixMomentum", "[", 
             RowBox[{
              RowBox[{"diag", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", "posNewMom", ",", 
              "allMomenta", ",", "FullDeltaList", ",", "signRules"}], "]"}]}],
            ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}], "&"}], "/@", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"positionFirstVert", "+", "1"}], ",", 
              RowBox[{"Length", "@", "diag"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"positionFirstVert", "-", "1"}]}], "}"}]}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "FullDeltaList", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7688200667044754`*^9, 3.7688200696620817`*^9}, 
   3.768823345802194*^9, {3.7688866841815834`*^9, 3.768886692315838*^9}, {
   3.7688868187687936`*^9, 3.7688869029225526`*^9}, {3.768886947936404*^9, 
   3.7688870400141735`*^9}, {3.768887522288484*^9, 3.7688875279403696`*^9}, {
   3.768887646596061*^9, 3.7688876671604433`*^9}, {3.7688877184434767`*^9, 
   3.7688877578056297`*^9}, {3.7688878346332703`*^9, 3.768887841042467*^9}, {
   3.7688878727704587`*^9, 3.7688879172260675`*^9}, {3.7688880055611043`*^9, 
   3.7688880634553556`*^9}, {3.7688880948917437`*^9, 3.768888134225556*^9}, {
   3.768888184746688*^9, 3.768888255181963*^9}, {3.76888828646194*^9, 
   3.7688884202431507`*^9}, {3.7705420506058245`*^9, 
   3.7705421496453395`*^9}, {3.775287598252745*^9, 3.7752876446670504`*^9}, 
   3.77528773981357*^9, {3.7752919737044287`*^9, 3.7752919765612993`*^9}, {
   3.775292466631889*^9, 3.7752925312514*^9}, {3.77529293830964*^9, 
   3.7752929578327703`*^9}, {3.775293001857293*^9, 3.7752930231713223`*^9}, {
   3.7752930714879446`*^9, 3.7752933540832143`*^9}, {3.775293395891272*^9, 
   3.7752934237957635`*^9}, {3.775293468689406*^9, 3.77529350559316*^9}, {
   3.7752935401574526`*^9, 3.7752935406730385`*^9}, {3.775293576222107*^9, 
   3.7752936013069015`*^9}, {3.775293675794965*^9, 3.775293703723974*^9}, {
   3.7752940718589563`*^9, 3.775294098749502*^9}, {3.775294197289628*^9, 
   3.7752942164436455`*^9}, {3.7752942477276106`*^9, 
   3.7752942760272975`*^9}, {3.7752943719533377`*^9, 
   3.7752945657623787`*^9}, {3.7752946036729794`*^9, 3.77529462359616*^9}, {
   3.775294666521507*^9, 3.7752946869652076`*^9}, {3.77529471968705*^9, 
   3.7752947348451705`*^9}, {3.775296924131328*^9, 3.7752969459779844`*^9}, {
   3.7752971287922664`*^9, 3.7752971351528215`*^9}, {3.7752973251576996`*^9, 
   3.7752973433537836`*^9}, 3.775297505776187*^9, {3.775297906911536*^9, 
   3.7752979726120825`*^9}, {3.7752980697738695`*^9, 
   3.7752980714636865`*^9}, {3.7752986592327113`*^9, 
   3.7752986721713743`*^9}, {3.775364515241275*^9, 3.775364560074955*^9}, {
   3.775368082488662*^9, 3.775368111668915*^9}, {3.7753681425088873`*^9, 
   3.7753682066112356`*^9}, {3.7753682797347045`*^9, 3.775368279854542*^9}, {
   3.7753693749698772`*^9, 3.7753693960434513`*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"2966e46c-8b4a-4bc6-ad4a-ccb9eb2f7327"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MomentumConservationVert", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<Propagator\>\""}], ",", 
       RowBox[{"\"\<indices\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"{", 
             RowBox[{"p$138677", ",", "i$138678"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"cbar", ",", 
            RowBox[{"{", 
             RowBox[{"p$138679", ",", "i$138680"}], "}"}]}], "}"}]}], 
         "}"}]}]}], "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<nPoint\>\""}], ",", 
       RowBox[{"\"\<indices\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", 
             RowBox[{"p", ",", "nu", ",", "n"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"cbar", ",", 
            RowBox[{"{", 
             RowBox[{"p$138679", ",", "i$138680"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"{", 
             RowBox[{"p$138682", ",", "i$138683"}], "}"}]}], "}"}]}], "}"}]}],
        ",", 
       RowBox[{"\"\<nPoint\>\"", "\[Rule]", "3"}], ",", 
       RowBox[{"\"\<spec\>\"", "\[Rule]", "\"\<none\>\""}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<Propagator\>\""}], ",", 
       RowBox[{"\"\<indices\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"{", 
             RowBox[{"p$138682", ",", "i$138683"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"cbar", ",", 
            RowBox[{"{", 
             RowBox[{"p$138684", ",", "i$138685"}], "}"}]}], "}"}]}], 
         "}"}]}]}], "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<nPoint\>\""}], ",", 
       RowBox[{"\"\<indices\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "p"}], ",", "mu", ",", "m"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"cbar", ",", 
            RowBox[{"{", 
             RowBox[{"p$138684", ",", "i$138685"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"{", 
             RowBox[{"p$138687", ",", "i$138688"}], "}"}]}], "}"}]}], "}"}]}],
        ",", 
       RowBox[{"\"\<nPoint\>\"", "\[Rule]", "3"}], ",", 
       RowBox[{"\"\<spec\>\"", "\[Rule]", "\"\<none\>\""}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<Propagator\>\""}], ",", 
       RowBox[{"\"\<indices\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"{", 
             RowBox[{"p$138687", ",", "i$138688"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"cbar", ",", 
            RowBox[{"{", 
             RowBox[{"p$138689", ",", "i$138690"}], "}"}]}], "}"}]}], 
         "}"}]}]}], "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<Regulatordot\>\""}], ",", 
       RowBox[{"\"\<indices\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"cbar", ",", 
            RowBox[{"{", 
             RowBox[{"p$138689", ",", "i$138690"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"{", 
             RowBox[{"p$138677", ",", "i$138678"}], "}"}]}], "}"}]}], 
         "}"}]}]}], "\[RightAssociation]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"iext$138399", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "p"}], ",", "mu", ",", "m"}], "}"}]}], ",", 
     RowBox[{"iext$138410", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"p", ",", "nu", ",", "n"}], "}"}]}]}], "}"}], ",", "4", ",", 
   "q"}], "]"}]], "Input",
 CellChangeTimes->{{3.775287746996614*^9, 3.7752877866541977`*^9}, 
   3.775297453104514*^9, {3.775368032316996*^9, 3.7753680338309793`*^9}, {
   3.77536904084645*^9, 3.775369041456479*^9}, 3.77536910782802*^9, {
   3.775369147701309*^9, 3.775369151149873*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"ee643d31-6d36-499c-ab8d-5cc817c9f12a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"p$138687", "\[Rule]", 
    RowBox[{"-", "q"}]}], ",", 
   RowBox[{"p$138689", "\[Rule]", "q"}], ",", 
   RowBox[{"p$138677", "\[Rule]", 
    RowBox[{"-", "q"}]}], ",", 
   RowBox[{"p$138679", "\[Rule]", "q"}], ",", 
   RowBox[{"p$138682", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "p"}], "-", "q"}]}], ",", 
   RowBox[{"p$138684", "\[Rule]", 
    RowBox[{"p", "+", "q"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7752877877328143`*^9, 3.775291982155452*^9, 3.775292501900792*^9, 
   3.7752932290012045`*^9, {3.7752934836921616`*^9, 3.775293509968461*^9}, 
   3.775294107092727*^9, 3.7752942205066557`*^9, {3.7752942527906046`*^9, 
   3.7752942803119864`*^9}, 3.7752944117681627`*^9, 3.775294637597328*^9, 
   3.775297088021542*^9, 3.775297140811488*^9, 3.7752973088334265`*^9, 
   3.775297347113587*^9, 3.7752974548231554`*^9, 3.775298075874605*^9, 
   3.7752981208904095`*^9, 3.775298408622547*^9, {3.775298440867695*^9, 
   3.7752984681507006`*^9}, 3.7752985181522017`*^9, {3.7753680680989523`*^9, 
   3.775368126893687*^9}, 3.775368254736059*^9, 3.775368370966243*^9, 
   3.7753685922369766`*^9, 3.7753689658736243`*^9, 3.775369050222853*^9, 
   3.7753691182464113`*^9, 3.7753691610889235`*^9, 3.775369279733902*^9, 
   3.77536943052147*^9, 3.7753727754252872`*^9},
 CellLabel->
  "Out[140]=",ExpressionUUID->"a24d6d9d-da32-4a6b-8270-c4eb39678c3c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ShiftLoopMomentum", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ShiftLoopMomentum", "[", 
   RowBox[{"Regdot_", ",", "loopIndex_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "SignRules", ",", "oldMomentum", ",", "  ", "oldMomClear", ",", 
      "Prefold", ",", " ", "shift", ",", "qnew"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SignRules", " ", "=", "  ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"n_", "?", "NumericQ"}], "*", "q_"}], " ", "\[Rule]", " ", 
        "q"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"oldMomentum", " ", "=", " ", 
      RowBox[{"Regdot", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "\"\<indices\>\"", ",", "2", ",", "2", ",", "1"}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"oldMomClear", " ", "=", " ", 
      RowBox[{"oldMomentum", "/.", "SignRules"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Prefold", " ", "=", " ", 
      RowBox[{
       RowBox[{"oldMomentum", "/", "oldMomClear"}], "//", "FullSimplify"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"myEcho", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"oldMomentum", ",", "Prefold"}], "}"}], ",", "5"}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"-", "loopIndex"}], "]"}], ",", "loopIndex"}], "}"}], ",",
          "oldMomentum"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myEcho", "[", 
         RowBox[{"\"\<true\>\"", ",", "5"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", "Regdot", ",", "loopIndex"}], "}"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Prefold", "<", " ", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myEcho", "[", 
            RowBox[{"\"\<<0\>\"", ",", "5"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"shift", " ", "=", " ", 
            RowBox[{"First", "[", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"oldMomentum", " ", "\[Equal]", " ", "qnew"}], ",", 
               " ", "loopIndex"}], "]"}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myEcho", "[", 
            RowBox[{"\"\<>0\>\"", ",", "5"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"shift", " ", "=", " ", 
            RowBox[{"First", "[", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"oldMomentum", " ", "\[Equal]", " ", 
                RowBox[{"-", "qnew"}]}], ",", " ", "loopIndex"}], "]"}], 
             "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"shift", ",", 
           RowBox[{"Regdot", "/.", "shift"}], ",", "qnew"}], "}"}], "]"}]}]}],
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7619911201062775`*^9, 3.761991133169756*^9}, {
   3.7619919396920004`*^9, 3.76199194390152*^9}, {3.761992089477474*^9, 
   3.7619921338401976`*^9}, {3.7619923973314104`*^9, 3.761992420310689*^9}, {
   3.761992464468788*^9, 3.761992483321273*^9}, {3.761992561561549*^9, 
   3.761992567037445*^9}, {3.761992644274514*^9, 3.7619926770179276`*^9}, {
   3.7619927257568703`*^9, 3.7619929329922304`*^9}, {3.7619929953071566`*^9, 
   3.761993048124022*^9}, {3.762069219498151*^9, 3.7620692445135803`*^9}, {
   3.762069378828868*^9, 3.7620694600848045`*^9}, {3.762069526036312*^9, 
   3.762069568598451*^9}, {3.7620697244959855`*^9, 3.7620697706637664`*^9}, 
   3.762070115542805*^9, {3.7620701727148695`*^9, 3.762070351892233*^9}, {
   3.7620707673432336`*^9, 3.762070769393128*^9}, {3.7620708672753253`*^9, 
   3.762070882339737*^9}, {3.7620710977602067`*^9, 3.762071118827815*^9}, {
   3.762078193808934*^9, 3.7620781973663626`*^9}, {3.76207830360693*^9, 
   3.7620783192422476`*^9}, {3.762078365344684*^9, 3.7620783663087378`*^9}, 
   3.762078538673733*^9, {3.762079241854387*^9, 3.7620792732961073`*^9}, {
   3.762079348644294*^9, 3.7620794148544397`*^9}, {3.762165124693494*^9, 
   3.762165136618412*^9}, {3.7621655809553657`*^9, 3.762165625631518*^9}, {
   3.7621679039875174`*^9, 3.7621680682625017`*^9}, {3.76216812405447*^9, 
   3.762168188653511*^9}, {3.7621683034387217`*^9, 3.762168303927952*^9}, {
   3.7688900482701864`*^9, 3.768890055623907*^9}, {3.768890108546507*^9, 
   3.7688901348940477`*^9}, {3.7688925758629417`*^9, 3.768892588909926*^9}, {
   3.768892945275782*^9, 3.7688929614277067`*^9}, {3.7688931699926767`*^9, 
   3.768893174987998*^9}, {3.7688932724313407`*^9, 3.7688932810462375`*^9}, {
   3.7688936919066415`*^9, 3.76889378506812*^9}, {3.7688939355752306`*^9, 
   3.7688939778169465`*^9}, {3.7688941303377523`*^9, 3.7688941304869084`*^9}, 
   3.775370418503688*^9, {3.775371303395708*^9, 3.7753713518436933`*^9}, {
   3.7753713861131835`*^9, 3.775371412251403*^9}, {3.7753715409774194`*^9, 
   3.7753715898757787`*^9}, {3.775371645241563*^9, 3.7753716535808177`*^9}, {
   3.775371692435143*^9, 3.775371721047186*^9}, 3.775372174749206*^9, 
   3.7753725383036985`*^9},
 CellLabel->
  "In[141]:=",ExpressionUUID->"512ee036-d36f-41d7-80a6-3672b7e65af6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ShiftLoopMomentum", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<Regulatordot\>\""}], ",", 
      RowBox[{"\"\<indices\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"A", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "q"}], "-", "p"}], ",", 
             RowBox[{"{", 
              RowBox[{"mu$205772", ",", "i$205772"}], "}"}]}], "}"}]}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"A", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"q", "+", "p"}], ",", 
             RowBox[{"{", 
              RowBox[{"mu$205784", ",", "i$205784"}], "}"}]}], "}"}]}], 
          "}"}]}], "}"}]}]}], "\[RightAssociation]"}], "}"}], ",", "q"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7688931964365444`*^9, 3.7688931974941015`*^9}, {
  3.7752949902757072`*^9, 3.7752949979959126`*^9}, {3.7753712151467485`*^9, 
  3.775371243917294*^9}, {3.7753714376172605`*^9, 3.7753714463192115`*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"404ec411-c931-4128-809f-dcd628d737ca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"q", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "p"}], "-", "qnew$3803"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Regulatordot\"\>"}], ",", 
      RowBox[{"\<\"indices\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"A", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "p"}], "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "p"}], "-", "qnew$3803"}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"mu$205772", ",", "i$205772"}], "}"}]}], "}"}]}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"A", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p", "+", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "p"}], "-", "qnew$3803"}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"mu$205784", ",", "i$205784"}], "}"}]}], "}"}]}], 
          "}"}]}], "}"}]}]}], "\[RightAssociation]"}], "}"}], ",", 
   "qnew$3803"}], "}"}]], "Output",
 CellChangeTimes->{
  3.775371244573386*^9, {3.7753714344805813`*^9, 3.775371446756527*^9}, 
   3.7753715923204355`*^9, 3.7753716547372246`*^9, 3.7753717280354276`*^9, 
   3.7753727755033956`*^9},
 CellLabel->
  "Out[143]=",ExpressionUUID->"83a9ff07-e0d4-4eef-bb56-3dec8ceb9bec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ShiftLoopMomentum", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<Regulatordot\>\""}], ",", 
      RowBox[{"\"\<indices\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"A", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "q"}], ",", 
             RowBox[{"{", 
              RowBox[{"mu$230216", ",", "i$230216"}], "}"}]}], "}"}]}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"A", ",", 
           RowBox[{"{", 
            RowBox[{"q", ",", 
             RowBox[{"{", 
              RowBox[{"mu$230228", ",", "i$230228"}], "}"}]}], "}"}]}], 
          "}"}]}], "}"}]}]}], "\[RightAssociation]"}], "}"}], ",", "q"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7753716151377897`*^9, 3.7753716212489595`*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"8be995aa-939c-4f72-acce-3d4d280154af"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Regulatordot\"\>"}], ",", 
      RowBox[{"\<\"indices\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"A", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "q"}], ",", 
             RowBox[{"{", 
              RowBox[{"mu$230216", ",", "i$230216"}], "}"}]}], "}"}]}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"A", ",", 
           RowBox[{"{", 
            RowBox[{"q", ",", 
             RowBox[{"{", 
              RowBox[{"mu$230228", ",", "i$230228"}], "}"}]}], "}"}]}], 
          "}"}]}], "}"}]}]}], "\[RightAssociation]"}], "}"}], ",", "q"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.775371621943367*^9, 3.7753716843031864`*^9, 
  3.7753717291241736`*^9, 3.77537277556341*^9},
 CellLabel->
  "Out[144]=",ExpressionUUID->"035d9915-a8b6-464c-a26b-ce7a237897c2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["right now....", "Subsection",
 CellChangeTimes->{{3.7752099914060445`*^9, 3.775209995907121*^9}, {
  3.7752100262969236`*^9, 
  3.7752100277187843`*^9}},ExpressionUUID->"12e32e81-fe54-4a42-a9fc-\
6769ec412ea3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "BRSTSuperindexRules", "]"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"needs", " ", "to", " ", "be", " ", "adjusted", " ", "for", " ", 
     RowBox[{"fermions", "/", "ghosts"}]}], " ", "\[Rule]", " ", 
    RowBox[{"lorentz", " ", "indices"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BRSTSuperindexRules", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"BRSTfield_", ",", "a_"}], "}"}], ",", "fields_", ",", 
    "BRSTfields_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "PositionField", ",", "FieldType", ",", "IndicesNew", ",", " ", 
      "Allfields"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IndicesNew", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"BRSTfield", ",", "a"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Allfields", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"fields", ",", "BRSTfields"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"PositionField", " ", "=", " ", 
      RowBox[{"First", "@", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"BRSTfield", " ", "\[Equal]", " ", 
             RowBox[{"Allfields", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", "\"\<name\>\""}], "]"}], "]"}]}], "&"}], "/@", 
           RowBox[{"Table", "[", 
            RowBox[{"i", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "@", "Allfields"}]}], "}"}]}], "]"}]}], ",", 
          "True"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"Allfields", "[", 
        RowBox[{"[", 
         RowBox[{"PositionField", ",", "\"\<fieldtype\>\""}], "]"}], "]"}], 
       ",", "\[IndentingNewLine]", " ", "\"\<scalar\>\"", ",", 
       RowBox[{"IndicesNew", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"BRSTfield", ",", 
          RowBox[{"{", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "a", "}"}], ",", 
             RowBox[{"Unique", "[", 
              RowBox[{"{", "p", "}"}], "]"}]}], "]"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", "\"\<boson\>\"", ",", " ", 
       RowBox[{"IndicesNew", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"BRSTfield", ",", 
          RowBox[{"{", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "a", "}"}], ",", 
             RowBox[{"Unique", "[", 
              RowBox[{"{", 
               RowBox[{"p", ",", "mu", ",", "i"}], "}"}], "]"}]}], "]"}], 
           "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", "\"\<fermion\>\"", 
       ",", " ", 
       RowBox[{"IndicesNew", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"BRSTfield", ",", 
          RowBox[{"{", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "a", "}"}], ",", 
             RowBox[{"Unique", "[", 
              RowBox[{"{", 
               RowBox[{"p", ",", "mu", ",", "i"}], "}"}], "]"}]}], "]"}], 
           "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       "\"\<antifermion\>\"", ",", " ", 
       RowBox[{"IndicesNew", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"BRSTfield", ",", 
          RowBox[{"{", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "a", "}"}], ",", 
             RowBox[{"Unique", "[", 
              RowBox[{"{", 
               RowBox[{"p", ",", "mu", ",", "i"}], "}"}], "]"}]}], "]"}], 
           "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", "\"\<ghost\>\"", ",",
        "  ", 
       RowBox[{"IndicesNew", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"BRSTfield", ",", 
          RowBox[{"{", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "a", "}"}], ",", 
             RowBox[{"Unique", "[", 
              RowBox[{"{", 
               RowBox[{"p", ",", "i"}], "}"}], "]"}]}], "]"}], "}"}]}], 
         "}"}]}], ",", "\[IndentingNewLine]", "\"\<antighost\>\"", ",", "  ", 
       RowBox[{"IndicesNew", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"BRSTfield", ",", 
          RowBox[{"{", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "a", "}"}], ",", 
             RowBox[{"Unique", "[", 
              RowBox[{"{", 
               RowBox[{"p", ",", "i"}], "}"}], "]"}]}], "]"}], "}"}]}], 
         "}"}]}], ",", "\[IndentingNewLine]", "\"\<BRSTfermion\>\"", ",", " ", 
       RowBox[{"IndicesNew", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"BRSTfield", ",", 
          RowBox[{"{", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "a", "}"}], ",", 
             RowBox[{"Unique", "[", 
              RowBox[{"{", 
               RowBox[{"p", ",", "mu", ",", "i"}], "}"}], "]"}]}], "]"}], 
           "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", "\"\<BRSTboson\>\"", 
       ",", "  ", 
       RowBox[{"IndicesNew", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"BRSTfield", ",", 
          RowBox[{"{", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "a", "}"}], ",", 
             RowBox[{"Unique", "[", 
              RowBox[{"{", 
               RowBox[{"p", ",", "i"}], "}"}], "]"}]}], "]"}], "}"}]}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "IndicesNew", "]"}]}]}], "\n", "]"}]}]}], "Input",
 CellChangeTimes->{{3.7651839774960675`*^9, 3.7651840984468746`*^9}, {
   3.7651842590402794`*^9, 3.76518427060351*^9}, {3.765207018140624*^9, 
   3.7652070184382224`*^9}, 3.7652080138550053`*^9, 3.7652095908277473`*^9, {
   3.765209662070263*^9, 3.765209747053411*^9}, {3.765209927412073*^9, 
   3.7652099311933527`*^9}, {3.765209983234194*^9, 3.765210027172697*^9}, {
   3.7652100861863394`*^9, 3.7652100866010523`*^9}, {3.7652107951317434`*^9, 
   3.765210798533103*^9}, {3.7656108649960146`*^9, 3.7656108673373203`*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"ed2fdba8-bfdf-46db-8af4-c328ea673c9e"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.7753724126930466`*^9},ExpressionUUID->"1e6f57f9-b3dd-4d7a-81bf-\
e7d4fde1e382"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "SwitchRegIndices", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SwitchRegIndices", "[", 
   RowBox[{"allProps_", ",", "allRegs_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dummyallRegs", " ", "=", " ", "allRegs"}], ",", 
      "LeftIndexPos"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myEcho", "[", 
      RowBox[{"\"\<SwitchRegIndices\>\"", ",", "3"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Echo", "[", 
      RowBox[{"{", 
       RowBox[{"allProps", ",", "allRegs"}], "}"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"LeftIndexPos", " ", "=", " ", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"allProps", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "\"\<indices\>\"", ",", "All", ",", "2"}], 
                "]"}], "]"}], ",", 
              RowBox[{"allRegs", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "\"\<indices\>\"", ",", "#", ",", "2"}], 
                "]"}], "]"}]}], "]"}], ")"}], "&"}], "/@", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"allRegs", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "\"\<indices\>\""}], "]"}], "]"}]}]}], 
             "}"}]}], "]"}]}], ",", "True"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Echo", "[", "LeftIndexPos", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Echo", "[", 
      RowBox[{"allRegs", "[", 
       RowBox[{"[", 
        RowBox[{
        "1", ",", "\"\<indices\>\"", ",", "2", ",", "LeftIndexPos", ",", 
         "2"}], "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dummyallRegs", "[", 
       RowBox[{"[", 
        RowBox[{
        "1", ",", "\"\<indices\>\"", ",", "2", ",", "LeftIndexPos", ",", 
         "2"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{"-", " ", 
       RowBox[{"allRegs", "[", 
        RowBox[{"[", 
         RowBox[{
         "1", ",", "\"\<indices\>\"", ",", "2", ",", "LeftIndexPos", ",", 
          "2"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "dummyallRegs", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7668140417411966`*^9, 3.7668140914061203`*^9}, {
   3.7668142131241417`*^9, 3.766814220643813*^9}, {3.766814537954586*^9, 
   3.7668145646296034`*^9}, {3.7668149220567503`*^9, 3.766814949663514*^9}, {
   3.76681507527186*^9, 3.7668152808516493`*^9}, {3.766815322000859*^9, 
   3.7668153671151676`*^9}, {3.7668155011360903`*^9, 3.766815506534622*^9}, {
   3.766815540577098*^9, 3.766815560915663*^9}, {3.766815704397385*^9, 
   3.766815704948912*^9}, {3.766816099379554*^9, 3.7668160999330425`*^9}, {
   3.775287151989854*^9, 3.7752871853369465`*^9}, 3.7752875713221426`*^9, {
   3.7753722571618805`*^9, 3.7753722605530195`*^9}, {3.775372327467194*^9, 
   3.7753723504821043`*^9}, {3.7753724516687994`*^9, 3.775372470435692*^9}},
 CellLabel->
  "In[373]:=",ExpressionUUID->"c9ec9369-845b-4e86-94e1-09c1bafa392c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<Regulatordot\>\""}], ",", 
     RowBox[{"\"\<indices\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"A", ",", 
          RowBox[{"{", 
           RowBox[{"p$258779", ",", 
            RowBox[{"{", 
             RowBox[{"mu$258780", ",", "i$258780"}], "}"}]}], "}"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", 
          RowBox[{"{", 
           RowBox[{"p$258791", ",", 
            RowBox[{"{", 
             RowBox[{"mu$258792", ",", "i$258792"}], "}"}]}], "}"}]}], 
         "}"}]}], "}"}]}]}], "\[RightAssociation]"}], "}"}], "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "\"\<indices\>\"", ",", "All", ",", "2", ",", "1"}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7753724187538414`*^9, 3.775372443224065*^9}},
 CellLabel->
  "In[369]:=",ExpressionUUID->"bd878245-23db-44ba-9a96-d1481644e82c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"p$258779", ",", "p$258791"}], "}"}]], "Output",
 CellChangeTimes->{{3.775372423800873*^9, 3.7753724435051613`*^9}},
 CellLabel->
  "Out[369]=",ExpressionUUID->"174108e1-a409-4653-b5b2-ad9dba4f958b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Main Function", "Subsection",
 CellChangeTimes->{{3.7752099914060445`*^9, 
  3.775210016418378*^9}},ExpressionUUID->"991ed968-166d-455a-adc6-\
1a3f385b2e6a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Add", " ", "loop", " ", "index", " ", "as", " ", "option"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7752876648150997`*^9, 3.7752876716296463`*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"94c2eaf6-aebc-4caa-b588-e97b5193db2d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "InsertFeynRules", "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "takes", " ", "as", " ", "RHS", " ", "one", " ", "single", " ", 
    "diagram"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InsertFeynRules", "[", 
   RowBox[{
   "diag_", ",", "derivativeList_", ",", "superindexReplacementList_", ",", 
    "fields_", ",", "loopIndex_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dummyDiagObj", " ", "=", " ", 
       RowBox[{"Drop", "[", 
        RowBox[{"diag", ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}], ",", " ", 
      RowBox[{"prefDiag", " ", "=", " ", 
       RowBox[{"diag", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{"allIndices", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ",", "firstsuperindex", ",", "positionReg", ",", 
      "posFirstVertex", ",", "allProps", ",", "allVertices", ",", " ", 
      "allBRSTVertices", ",", "allRegdot", ",", "allReg", ",", 
      "fullDeltaList", ",", "ShiftLoopMom", ",", "OutgoingIndexReplacement", 
      ",", "SuperindexReplacement", ",", 
      RowBox[{"AllVarsList", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ",", "diagramValue", ",", "qnew", ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "BRSTinVert", ",", " ", "PositionBRST", ",", " ", "BRSTsDiag", ",", 
      "OutgoingBRSTIndexReplacement", ",", 
      RowBox[{"BRSTSuperindexReplacement", " ", "=", " ", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myEcho", "[", 
      RowBox[{"\"\<Insert Feynman Rules\>\"", ",", "1"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Identification", " ", "of", " ", "different", " ", "objects"}],
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"allProps", " ", "=", " ", 
      RowBox[{"Cases", "[", 
       RowBox[{"dummyDiagObj", ",", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<Propagator\>\""}], ",", 
          "___"}], "|>"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"allBRSTVertices", " ", "=", " ", 
      RowBox[{"Cases", "[", 
       RowBox[{"dummyDiagObj", ",", 
        RowBox[{"<|", 
         RowBox[{"___", ",", 
          RowBox[{"\"\<BRST\>\"", "\[Rule]", "True"}], ",", "___"}], "|>"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"positionReg", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"dummyDiagObj", ",", "\"\<Regulator\>\""}], "]"}], ",", 
        RowBox[{"Position", "[", 
         RowBox[{"dummyDiagObj", ",", "\"\<Regulatordot\>\""}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"(", 
          RowBox[{"Flatten", "[", "positionReg", "]"}], ")"}]}], ">", "0"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"positionReg", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"positionReg", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "}"}]}], ";"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"positionReg", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myEcho", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Position Reg/Regdot: \>\"", ",", "positionReg"}], "}"}], 
       ",", "3"}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "the", " ", "first", " ", "vertex", " ", "is", " ", "the", " ", "one", 
       " ", "which", " ", "has", " ", "the", " ", "first", " ", "field", " ", 
       "of", " ", "the", " ", "derivative", " ", "list", " ", "in", " ", 
       "it"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"posFirstVertex", " ", "=", " ", 
      RowBox[{"FindFirstVertex", "[", 
       RowBox[{"dummyDiagObj", ",", " ", 
        RowBox[{"superindexReplacementList", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"...", "..."}], "..."}], "..."}], "..."}], 
                    "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], 
                "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], "..."}],
          "..."}], ".", "why"}], " ", "do", " ", "I", " ", "switch", " ", 
       "the", " ", "momentum", " ", "here", 
       RowBox[{"??", "?"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "allBRSTVertices"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"BRSTinVert", " ", "=", " ", 
         RowBox[{"First", "@", 
          RowBox[{"Flatten", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"dummyBRSTVertices", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "\"\<indices\>\"", ",", "1"}], "]"}], 
                 "]"}], ",", 
                RowBox[{"BRSTfields", "[", 
                 RowBox[{"[", 
                  RowBox[{"#", ",", "\"\<name\>\""}], "]"}], "]"}]}], "]"}], 
              "&"}], "/@", 
             RowBox[{"Table", "[", 
              RowBox[{"i", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "@", "BRSTfields"}]}], "}"}]}], "]"}]}], 
            ")"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"PositionBRST", " ", "=", " ", 
         RowBox[{"First", "@", 
          RowBox[{"Flatten", "@", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"dummyBRSTVertices", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "\"\<indices\>\"", ",", "1"}], "]"}], "]"}], 
             ",", "BRSTinVert"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"BRSTsDiag", " ", "=", " ", 
         RowBox[{"dummyBRSTVertices", "[", 
          RowBox[{"[", 
           RowBox[{
           "1", ",", "\"\<indices\>\"", ",", "All", ",", "PositionBRST"}], 
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"BRSTSuperindexReplacement", " ", "=", "  ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{"Rule", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"BRSTsDiag", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "}"}], " ", ",", " ", 
               RowBox[{
                RowBox[{"BRSTSuperindexRules", "[", 
                 RowBox[{"BRSTsDiag", ",", "fields", ",", "BRSTfields"}], 
                 "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ",", "2"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"OutgoingBRSTIndexReplacement", " ", "=", " ", 
         RowBox[{
          RowBox[{"BRSTSuperindexReplacement", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}], "\[Rule]", " ", 
          RowBox[{"-", 
           RowBox[{"BRSTSuperindexReplacement", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}]}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"...", "..."}], "..."}], "..."}], "..."}], 
                    "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], 
               "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], 
        "..."}], "."}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "replace", " ", "the", " ", "superindices", " ", "of", " ", "the", " ", 
       "props", " ", "with", " ", "the", " ", "proper", " ", "number", " ", 
       "of", " ", "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"SuperindexReplacement", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Rule", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"allProps", "[", 
                RowBox[{"[", 
                 RowBox[{"#", ",", "\"\<indices\>\"", ",", "All", ",", "2"}], 
                 "]"}], "]"}], " ", ",", "  ", 
               RowBox[{"SuperindexRules", "[", 
                RowBox[{
                 RowBox[{"allProps", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", "\"\<indices\>\""}], "]"}], "]"}], ",", 
                 "fields"}], "]"}]}], "}"}]}], "]"}], ")"}], "&"}], "/@", 
         RowBox[{"Table", "[", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "@", "allProps"}]}], "}"}]}], "]"}]}], ",", 
        "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myEcho", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Superindex Prop Rules: \>\"", ",", "SuperindexReplacement"}], 
        "}"}], ",", "3"}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"...", "..."}], "..."}], "..."}], "..."}], 
                    "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], 
                    "..."}], "..."}], "..."}], ".."}], "why"}], "..."}], 
                    "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], 
               "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], 
        "..."}], "..."}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"OutgoingIndexReplacement", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"SuperindexReplacement", "[", 
           RowBox[{"[", 
            RowBox[{"#", ",", "2", ",", "1"}], "]"}], "]"}], "\[Rule]", " ", 
          RowBox[{"-", 
           RowBox[{"SuperindexReplacement", "[", 
            RowBox[{"[", 
             RowBox[{"#", ",", "2", ",", "1"}], "]"}], "]"}]}]}], ")"}], 
        "&"}], "/@", 
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "@", "SuperindexReplacement"}]}], "}"}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myEcho", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Outgoing Index Rules: \>\"", ",", " ", 
         "OutgoingIndexReplacement"}], "}"}], ",", "3"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"...", "..."}], "..."}], "..."}], "..."}], 
                    "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], 
                    "..."}], "..."}], "..."}], ".."}], "why"}], "..."}], 
                    "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], 
               "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], 
        "..."}], "..."}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"SuperindexReplacement", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{
       "BRSTSuperindexReplacement", ",", "SuperindexReplacement", ",", 
        "superindexReplacementList"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"...", "..."}], "..."}], "..."}], "..."}], 
                   "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], "do",
              " ", "I", " ", "even", " ", "need", " ", "this", " ", "index", 
             " ", "switching", " ", 
             RowBox[{"shit", "?", " ", "I"}], " ", "dont", " ", "think", " ", 
             "so"}], "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"allProps", " ", "=", " ", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"dummyDiagObj", ",", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<Propagator\>\""}], ",", 
           "___"}], "|>"}]}], "]"}], "/.", "SuperindexReplacement"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myEcho", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<new prop indices: \>\"", ",", "allProps"}], "}"}], ",", 
       "3"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"allVertices", " ", "=", " ", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"dummyDiagObj", ",", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<nPoint\>\""}], ",", 
           "___"}], "|>"}]}], "]"}], "/.", "SuperindexReplacement"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myEcho", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<new vertex indices: \>\"", ",", "allVertices"}], "}"}], 
       ",", "3"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"allReg", " ", "=", " ", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"dummyDiagObj", ",", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<Regulator\>\""}], ",", 
           "___"}], "|>"}]}], "]"}], "/.", "SuperindexReplacement"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"allRegdot", " ", "=", " ", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"dummyDiagObj", ",", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<Regulatordot\>\""}], ",", 
           "___"}], "|>"}]}], " ", "]"}], "/.", "SuperindexReplacement"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "allRegdot"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"allRegdot", " ", "=", " ", 
           RowBox[{"SwitchRegIndices", "[", 
            RowBox[{"allProps", ",", "allRegdot"}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"allReg", " ", "=", " ", 
           RowBox[{"SwitchRegIndices", "[", 
            RowBox[{"allProps", ",", "allReg"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"...", "..."}], "..."}], "..."}], "..."}], 
                  "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], "do", 
            " ", "I", " ", "even", " ", "need", " ", "this", " ", "index", 
            " ", "switching", " ", 
            RowBox[{"shit", "?", " ", "I"}], " ", "dont", " ", "think", " ", 
            "so"}], "..."}], "..."}], "..."}], "..."}], "..."}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dummyDiagObj", " ", "=", " ", 
      RowBox[{"dummyDiagObj", "/.", "SuperindexReplacement"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myEcho", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "dummyDiagObj", ",", "superindexReplacementList", ",", 
         "posFirstVertex", ",", "loopIndex"}], "}"}], ",", "6"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fullDeltaList", " ", "=", " ", 
      RowBox[{"MomentumConservationVert", "[", 
       RowBox[{
       "dummyDiagObj", ",", "superindexReplacementList", ",", 
        "posFirstVertex", ",", "loopIndex"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dummyDiagObj", " ", "=", " ", 
      RowBox[{"dummyDiagObj", "/.", "fullDeltaList"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"allProps", " ", "=", " ", 
      RowBox[{"allProps", "/.", "fullDeltaList"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"allVertices", " ", "=", " ", 
      RowBox[{"allVertices", "/.", "fullDeltaList"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"allReg", " ", "=", " ", 
      RowBox[{"allReg", "/.", "fullDeltaList"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"allRegdot", " ", "=", " ", 
      RowBox[{"allRegdot", "/.", "fullDeltaList"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"myEcho", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fullDeltaList", ",", "dummyDiagObj", ",", "allReg", ",", "allRegdot",
          ",", "allProps"}], "}"}], ",", "5"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"ShiftLoopMom", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "allRegdot"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ShiftLoopMom", ",", " ", "allRegdot", ",", "qnew"}], "}"}],
          " ", "=", " ", 
         RowBox[{"ShiftLoopMomentum", "[", 
          RowBox[{"allRegdot", ",", "loopIndex"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "allReg"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ShiftLoopMom", ",", " ", "allReg", ",", "qnew"}], "}"}], 
           " ", "=", " ", 
           RowBox[{"ShiftLoopMomentum", "[", 
            RowBox[{"allReg", ",", "loopIndex"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myEcho", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Shift Loop Mom and new diagram: \>\"", ",", "ShiftLoopMom", ",", 
         "dummyDiagObj", ",", "qnew"}], "}"}], ",", "3"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"allProps", " ", "=", " ", 
      RowBox[{"allProps", "/.", "ShiftLoopMom"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"allVertices", " ", "=", " ", 
      RowBox[{"allVertices", "/.", "ShiftLoopMom"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"allReg", " ", "=", 
      RowBox[{"allReg", "/.", "ShiftLoopMom"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"allRegdot", " ", "=", " ", 
      RowBox[{"allRegdot", "/.", "ShiftLoopMom"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Prepare", " ", "objects", " ", "such", " ", "that", " ", "one", " ", 
       "can", " ", "easily", " ", "insert", " ", "the", " ", "Feynman", " ", 
       "Rules"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"AllVarsList", " ", "=", " ", 
      RowBox[{"Union", "@", 
       RowBox[{"Join", "[", 
        RowBox[{"AllVarsList", ",", 
         RowBox[{"Flatten", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Union", "@", 
              RowBox[{"Flatten", "@", 
               RowBox[{"allProps", "[", 
                RowBox[{"[", 
                 RowBox[{"#", ",", "\"\<indices\>\"", ",", "All", ",", "2"}], 
                 "]"}], "]"}]}]}], "&"}], "/@", 
            RowBox[{"Table", "[", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "@", "allProps"}]}], "}"}]}], "]"}]}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"allProps", "[", 
          RowBox[{"[", "#", "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<G\>\"", ",", 
             RowBox[{"Map", "[", 
              RowBox[{"ToString", ",", 
               RowBox[{"allProps", "[", 
                RowBox[{"[", 
                 RowBox[{"#", ",", "\"\<indices\>\"", ",", "All", ",", "1"}], 
                 "]"}], "]"}]}], "]"}]}], "]"}], "]"}], "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"allProps", "[", 
            RowBox[{"[", 
             RowBox[{"#", ",", "\"\<indices\>\"", ",", "All", ",", "2"}], 
             "]"}], "]"}], "]"}], "]"}]}], ")"}], "&"}], "/@", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "allProps"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"AllVarsList", " ", "=", " ", 
      RowBox[{"Union", "@", 
       RowBox[{"Join", "[", 
        RowBox[{"AllVarsList", ",", 
         RowBox[{"Flatten", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Union", "@", 
              RowBox[{"Flatten", "@", 
               RowBox[{"allVertices", "[", 
                RowBox[{"[", 
                 RowBox[{"#", ",", "\"\<indices\>\"", ",", "All", ",", "2"}], 
                 "]"}], "]"}]}]}], "&"}], "/@", 
            RowBox[{"Table", "[", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "@", "allVertices"}]}], "}"}]}], "]"}]}], 
           ")"}]}]}], "]"}]}]}], ";", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"allVertices", "[", 
          RowBox[{"[", "#", "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<\[CapitalGamma]\>\"", ",", 
             RowBox[{"Map", "[", 
              RowBox[{"ToString", ",", 
               RowBox[{"allVertices", "[", 
                RowBox[{"[", 
                 RowBox[{"#", ",", "\"\<indices\>\"", ",", "All", ",", "1"}], 
                 "]"}], "]"}]}], "]"}]}], "]"}], "]"}], "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"allVertices", "[", 
            RowBox[{"[", 
             RowBox[{"#", ",", "\"\<indices\>\"", ",", "All", ",", "2"}], 
             "]"}], "]"}], "]"}], "]"}]}], ")"}], "&"}], "/@", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "allVertices"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"AllVarsList", " ", "=", " ", 
      RowBox[{"Union", "@", 
       RowBox[{"Join", "[", 
        RowBox[{"AllVarsList", ",", 
         RowBox[{"Flatten", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Union", "@", 
              RowBox[{"Flatten", "@", 
               RowBox[{"allReg", "[", 
                RowBox[{"[", 
                 RowBox[{"#", ",", "\"\<indices\>\"", ",", "All", ",", "2"}], 
                 "]"}], "]"}]}]}], "&"}], "/@", 
            RowBox[{"Table", "[", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "@", "allReg"}]}], "}"}]}], "]"}]}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"allReg", "[", 
          RowBox[{"[", "#", "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<R\>\"", ",", 
             RowBox[{"Map", "[", 
              RowBox[{"ToString", ",", 
               RowBox[{"allReg", "[", 
                RowBox[{"[", 
                 RowBox[{"#", ",", "\"\<indices\>\"", ",", "All", ",", "1"}], 
                 "]"}], "]"}]}], "]"}]}], "]"}], "]"}], "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"allReg", "[", 
            RowBox[{"[", 
             RowBox[{"#", ",", "\"\<indices\>\"", ",", "All", ",", "2"}], 
             "]"}], "]"}], "]"}], "]"}]}], ")"}], "&"}], "/@", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "allReg"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"AllVarsList", " ", "=", " ", 
      RowBox[{"Union", "@", 
       RowBox[{"Join", "[", 
        RowBox[{"AllVarsList", ",", 
         RowBox[{"Flatten", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Union", "@", 
              RowBox[{"Flatten", "@", 
               RowBox[{"allRegdot", "[", 
                RowBox[{"[", 
                 RowBox[{"#", ",", "\"\<indices\>\"", ",", "All", ",", "2"}], 
                 "]"}], "]"}]}]}], "&"}], "/@", 
            RowBox[{"Table", "[", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "@", "allRegdot"}]}], "}"}]}], "]"}]}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"allRegdot", "[", 
          RowBox[{"[", "#", "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<Rdot\>\"", ",", 
             RowBox[{"Map", "[", 
              RowBox[{"ToString", ",", 
               RowBox[{"allRegdot", "[", 
                RowBox[{"[", 
                 RowBox[{"#", ",", "\"\<indices\>\"", ",", "All", ",", "1"}], 
                 "]"}], "]"}]}], "]"}]}], "]"}], "]"}], "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"allRegdot", "[", 
            RowBox[{"[", 
             RowBox[{"#", ",", "\"\<indices\>\"", ",", "All", ",", "2"}], 
             "]"}], "]"}], "]"}], "]"}]}], ")"}], "&"}], "/@", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "allRegdot"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "ShiftLoopMom"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AllVarsList", " ", "=", " ", 
         RowBox[{"Union", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"Union", "[", 
                 RowBox[{"Flatten", "[", "AllVarsList", "]"}], "]"}], ",", 
                "qnew"}], "]"}], ",", 
              RowBox[{"-", "qnew"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"loopIndex", ",", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"-", "loopIndex"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
        ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AllVarsList", " ", "=", " ", 
         RowBox[{"Union", "[", 
          RowBox[{"Flatten", "[", "AllVarsList", "]"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"diagramValue", " ", "=", "  ", 
      RowBox[{"prefDiag", "*", 
       RowBox[{"Apply", "[", 
        RowBox[{"Times", ",", "allProps"}], "]"}], "*", 
       RowBox[{"Apply", "[", 
        RowBox[{"Times", ",", "allVertices"}], "]"}], "*", 
       RowBox[{"Apply", "[", 
        RowBox[{"Times", ",", "allReg"}], "]"}], "*", 
       RowBox[{"Apply", "[", 
        RowBox[{"Times", ",", "allRegdot"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"AllVarsList", ",", 
        RowBox[{"diagramValue", "/.", 
         RowBox[{"qnew", "\[Rule]", "loopIndex"}]}]}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.761292490216677*^9, 3.761292626491716*^9}, {
   3.7612926723219795`*^9, 3.7612927674950056`*^9}, 3.76129305807738*^9, {
   3.761294006523538*^9, 3.7612941503573475`*^9}, {3.7612946644976797`*^9, 
   3.761294741921523*^9}, {3.761294772585949*^9, 3.761294773670802*^9}, {
   3.7612995661169767`*^9, 3.7612995944365573`*^9}, {3.761300703434873*^9, 
   3.7613007700261016`*^9}, {3.761300847611112*^9, 3.7613008592339153`*^9}, {
   3.7613010008061724`*^9, 3.7613010258617697`*^9}, {3.761301070175089*^9, 
   3.7613010989875813`*^9}, {3.761302336938572*^9, 3.761302526692627*^9}, {
   3.7613026173485622`*^9, 3.7613026255451913`*^9}, {3.7613027139844575`*^9, 
   3.7613027163777094`*^9}, {3.761303021250948*^9, 3.761303089970064*^9}, {
   3.7613031307778983`*^9, 3.7613031532110205`*^9}, {3.7613032149924917`*^9, 
   3.7613032155063686`*^9}, 3.761303256866626*^9, {3.7613032910340133`*^9, 
   3.7613033415726604`*^9}, {3.7613033942586474`*^9, 
   3.7613034391508503`*^9}, {3.7613036330800447`*^9, 3.761303642474721*^9}, {
   3.7613044082383976`*^9, 3.761304420352208*^9}, {3.7613044834666653`*^9, 
   3.761304738630164*^9}, {3.7613047961716175`*^9, 3.761304806869409*^9}, {
   3.76130484176575*^9, 3.761304956790863*^9}, {3.7613054534153347`*^9, 
   3.7613054884345927`*^9}, {3.7613055550035696`*^9, 
   3.7613056092858305`*^9}, {3.761305678607237*^9, 3.7613057452833457`*^9}, {
   3.761306154706893*^9, 3.7613061995757113`*^9}, {3.761306309161411*^9, 
   3.761306339654913*^9}, 3.761306386758635*^9, {3.7613066331678543`*^9, 
   3.7613066449337215`*^9}, {3.7613069486460686`*^9, 
   3.7613069588447857`*^9}, {3.7613070048788447`*^9, 
   3.7613070411296253`*^9}, {3.761307384758296*^9, 3.761307435581542*^9}, {
   3.7613075133387675`*^9, 3.761307560960465*^9}, {3.761307605968007*^9, 
   3.7613076308853455`*^9}, {3.7613727136812305`*^9, 
   3.7613727806591454`*^9}, {3.7613731390109043`*^9, 3.761373255247159*^9}, {
   3.7613732867230363`*^9, 3.7613732870082464`*^9}, {3.761373411853485*^9, 
   3.761373427548552*^9}, {3.761385225001584*^9, 3.7613854224189634`*^9}, {
   3.7613854584865727`*^9, 3.761385464596306*^9}, {3.7614613952147217`*^9, 
   3.761461395714551*^9}, {3.761903167914304*^9, 3.7619031710479193`*^9}, {
   3.7619036299004984`*^9, 3.7619036331381283`*^9}, {3.7620843143525343`*^9, 
   3.762084316712864*^9}, {3.762084483198273*^9, 3.7620844835917487`*^9}, {
   3.7620845631660995`*^9, 3.7620845866752567`*^9}, {3.7620848394720507`*^9, 
   3.762084840906704*^9}, 3.7620849163403015`*^9, {3.7620850870181065`*^9, 
   3.7620851022603254`*^9}, {3.76208526593073*^9, 3.7620854276350226`*^9}, {
   3.762085912002431*^9, 3.76208594108393*^9}, {3.7620860358363986`*^9, 
   3.762086195950012*^9}, {3.762086227356244*^9, 3.762086232871682*^9}, {
   3.7620862631334887`*^9, 3.7620862635010433`*^9}, {3.7620866295986004`*^9, 
   3.762086796066385*^9}, {3.7620869869789486`*^9, 3.762087147833151*^9}, {
   3.762087186084134*^9, 3.762087187769023*^9}, {3.762087331634629*^9, 
   3.7620873596232805`*^9}, 3.762087417589599*^9, {3.7620875705571504`*^9, 
   3.762087583809955*^9}, {3.7620876654218054`*^9, 3.76208768539128*^9}, {
   3.762087717571701*^9, 3.762087728359004*^9}, {3.762087770580208*^9, 
   3.7620877814874287`*^9}, {3.7620878975424385`*^9, 3.762087902300287*^9}, {
   3.7620879763472357`*^9, 3.7620880374047365`*^9}, {3.762088587863717*^9, 
   3.7620886824568033`*^9}, {3.7620887196788435`*^9, 
   3.7620887199936905`*^9}, {3.7620887771803827`*^9, 3.762088783651227*^9}, {
   3.7620888249567122`*^9, 3.762088843155718*^9}, {3.7620888822913303`*^9, 
   3.7620888876662245`*^9}, {3.7621602682938604`*^9, 
   3.7621603812043734`*^9}, {3.7621604838320117`*^9, 3.762160555599189*^9}, {
   3.7621606695922413`*^9, 3.7621606920375986`*^9}, {3.7621607254430714`*^9, 
   3.762160733895474*^9}, {3.7621608839226446`*^9, 3.762160957644784*^9}, {
   3.762161022277728*^9, 3.7621610503761854`*^9}, {3.7621611015953035`*^9, 
   3.7621611057349787`*^9}, {3.762161170755826*^9, 3.762161173067293*^9}, {
   3.762161896401228*^9, 3.7621619066722574`*^9}, {3.7621621182867303`*^9, 
   3.7621621239437833`*^9}, {3.7621624085160017`*^9, 3.762162417773438*^9}, 
   3.762162451915708*^9, {3.762162511867876*^9, 3.762162513603195*^9}, {
   3.762162620895088*^9, 3.762162631540476*^9}, {3.7621626930519266`*^9, 
   3.7621626965360975`*^9}, {3.7621629599478283`*^9, 
   3.7621629741646633`*^9}, {3.762163022073596*^9, 3.7621630424307857`*^9}, {
   3.762163105657398*^9, 3.7621631159740496`*^9}, 3.7621636665753927`*^9, {
   3.7621636984316616`*^9, 3.762163713892497*^9}, {3.76216376128421*^9, 
   3.7621637709862623`*^9}, {3.762163810908098*^9, 3.7621639449107885`*^9}, {
   3.7621639889091234`*^9, 3.7621640359645953`*^9}, {3.76216409223973*^9, 
   3.76216410179366*^9}, {3.7621643373299665`*^9, 3.762164410236729*^9}, {
   3.762164539689826*^9, 3.7621645613535285`*^9}, {3.762165142362401*^9, 
   3.7621651952839394`*^9}, {3.762165347067915*^9, 3.7621653492666698`*^9}, {
   3.762165516586459*^9, 3.762165521466889*^9}, {3.762166681419533*^9, 
   3.762166722009782*^9}, {3.7621673359856887`*^9, 3.7621673515045233`*^9}, {
   3.762167386304025*^9, 3.762167388291566*^9}, {3.762167446537222*^9, 
   3.762167450967204*^9}, {3.7621677405856953`*^9, 3.762167779437731*^9}, {
   3.7621682001262054`*^9, 3.76216820890841*^9}, {3.762168242581938*^9, 
   3.7621682606272745`*^9}, {3.762168525630968*^9, 3.7621685283345475`*^9}, {
   3.762169366099843*^9, 3.7621693926559315`*^9}, {3.7621694349230757`*^9, 
   3.7621694405957975`*^9}, 3.7621694951927533`*^9, {3.762169531934785*^9, 
   3.7621695983596373`*^9}, {3.7621696324466968`*^9, 
   3.7621696353081636`*^9}, {3.76216970681726*^9, 3.762169715602892*^9}, {
   3.7621697877886515`*^9, 3.7621698620675945`*^9}, {3.7621699377576094`*^9, 
   3.762169943171774*^9}, {3.7621702236743755`*^9, 3.762170268557784*^9}, {
   3.7621703149215736`*^9, 3.7621703199969063`*^9}, {3.7627716536102095`*^9, 
   3.7627716959113135`*^9}, {3.7627717267994766`*^9, 3.762771795043477*^9}, {
   3.76277186403868*^9, 3.7627718655766354`*^9}, {3.7627722651098523`*^9, 
   3.762772268103052*^9}, {3.7627727303825016`*^9, 3.76277276431818*^9}, {
   3.7627728180745583`*^9, 3.762772818527207*^9}, {3.762773163213295*^9, 
   3.7627731644450035`*^9}, {3.7627732579835052`*^9, 
   3.7627732921662188`*^9}, {3.762773372278068*^9, 3.7627733803354993`*^9}, {
   3.762773410833681*^9, 3.762773415272733*^9}, {3.762773549632476*^9, 
   3.7627735678357615`*^9}, {3.7627736032368402`*^9, 3.762773658424161*^9}, {
   3.7627736956214375`*^9, 3.7627737084296927`*^9}, {3.762773738868029*^9, 
   3.7627737581300354`*^9}, {3.7627738565814266`*^9, 3.762774011004856*^9}, {
   3.762774045434362*^9, 3.7627740776709957`*^9}, 3.764479968769766*^9, {
   3.764480047651125*^9, 3.7644800620552487`*^9}, {3.764480198779112*^9, 
   3.764480202765197*^9}, {3.7644802675825725`*^9, 3.76448029304994*^9}, {
   3.7644803355146275`*^9, 3.7644803415410547`*^9}, {3.764482927852171*^9, 
   3.7644829315879364`*^9}, {3.764482962639103*^9, 3.764482966528818*^9}, {
   3.7644830528945436`*^9, 3.7644830552734995`*^9}, {3.765180933468215*^9, 
   3.765180950412634*^9}, {3.765181534596143*^9, 3.7651815409996495`*^9}, {
   3.7651834372584906`*^9, 3.765183470161085*^9}, {3.7651838627772827`*^9, 
   3.765183868613595*^9}, {3.765184122299388*^9, 3.7651842513507795`*^9}, 
   3.765184305772746*^9, {3.7651843652036643`*^9, 3.765184372041726*^9}, {
   3.765184455120721*^9, 3.7651844831472297`*^9}, {3.7651845369175043`*^9, 
   3.7651845444544373`*^9}, {3.7651846831642523`*^9, 
   3.7651847602882977`*^9}, {3.765184814276168*^9, 3.7651848165557613`*^9}, {
   3.7651848721425776`*^9, 3.765184899922123*^9}, {3.7651849773195157`*^9, 
   3.765185011365918*^9}, {3.76520615839725*^9, 3.7652061800040646`*^9}, {
   3.765207635018532*^9, 3.7652076391162205`*^9}, {3.7652077754441395`*^9, 
   3.765207821230074*^9}, {3.7652079300844584`*^9, 3.765207933288955*^9}, 
   3.7652079872121844`*^9, {3.7652080229284115`*^9, 3.765208035694666*^9}, {
   3.7652081096290336`*^9, 3.7652082350464163`*^9}, {3.7652082949550858`*^9, 
   3.76520830499384*^9}, {3.765208352620532*^9, 3.7652083589607425`*^9}, {
   3.7652084408768897`*^9, 3.765208452017618*^9}, {3.765208633984056*^9, 
   3.7652087376915092`*^9}, {3.765208774342572*^9, 3.7652087956594243`*^9}, {
   3.7652089520326214`*^9, 3.7652090610352373`*^9}, {3.7652091189018044`*^9, 
   3.7652091647041516`*^9}, {3.765209198568284*^9, 3.7652093350786567`*^9}, {
   3.765209434769644*^9, 3.765209440868641*^9}, {3.7652096043914175`*^9, 
   3.765209654919057*^9}, {3.765209812737191*^9, 3.765209826218505*^9}, {
   3.765209860772315*^9, 3.7652098772877026`*^9}, {3.7652107199784627`*^9, 
   3.7652107220138135`*^9}, {3.765610660775546*^9, 3.7656107122428713`*^9}, {
   3.765610824984828*^9, 3.7656108304532056`*^9}, {3.765610885088666*^9, 
   3.7656108971853237`*^9}, {3.7656110175670137`*^9, 3.765611036810567*^9}, {
   3.765611078186214*^9, 3.765611182618021*^9}, {3.765612352320851*^9, 
   3.7656125050512285`*^9}, 3.7656126876964946`*^9, {3.7656128351246758`*^9, 
   3.7656128916331587`*^9}, {3.765612923098076*^9, 3.7656129625328555`*^9}, {
   3.765613026316374*^9, 3.765613047587723*^9}, {3.7656130819596043`*^9, 
   3.765613133655306*^9}, {3.7661392745370345`*^9, 3.766139312695865*^9}, {
   3.7661393839053435`*^9, 3.7661393869522047`*^9}, {3.7661572359879017`*^9, 
   3.7661572562782426`*^9}, {3.766157382076973*^9, 3.7661573847925053`*^9}, {
   3.76629619018487*^9, 3.7662962171734085`*^9}, {3.7662992030506353`*^9, 
   3.7662992126627684`*^9}, {3.7662992462391357`*^9, 
   3.7662992530833926`*^9}, {3.766299556302362*^9, 3.766299560038145*^9}, {
   3.7662996294888616`*^9, 3.7662997657796555`*^9}, {3.766299796749121*^9, 
   3.7662998193575554`*^9}, {3.7662998851263905`*^9, 3.766299886814065*^9}, {
   3.7663000008088245`*^9, 3.766300014075839*^9}, {3.76630005970662*^9, 
   3.766300074858597*^9}, 3.766300170409042*^9, {3.766300607003982*^9, 
   3.7663006105822053`*^9}, {3.7663007521825333`*^9, 
   3.7663007561672544`*^9}, {3.7663009403748684`*^9, 3.766300946937976*^9}, {
   3.766300997084649*^9, 3.766301001444528*^9}, {3.766301031777734*^9, 
   3.7663010473676624`*^9}, {3.7663011080573373`*^9, 
   3.7663011111359434`*^9}, {3.7663018543339434`*^9, 
   3.7663019080893087`*^9}, {3.7663019904483337`*^9, 3.7663020433568573`*^9}, 
   3.7663055654443703`*^9, {3.766305646489978*^9, 3.7663056616139402`*^9}, {
   3.766305691895934*^9, 3.766305708635751*^9}, {3.7663057965100913`*^9, 
   3.766305827918454*^9}, 3.7663059290316257`*^9, {3.7663061732422915`*^9, 
   3.7663061768048487`*^9}, {3.7663063531988754`*^9, 3.7663063538237534`*^9}, 
   3.766306414016101*^9, {3.766306461691236*^9, 3.766306502283886*^9}, {
   3.766306550824155*^9, 3.76630655527794*^9}, {3.766306613156296*^9, 
   3.766306632563882*^9}, {3.7663066653010063`*^9, 3.766306670847767*^9}, {
   3.7663067225361648`*^9, 3.7663067242394257`*^9}, 3.766306767884613*^9, {
   3.766306797887297*^9, 3.766306805528593*^9}, {3.766306843213296*^9, 
   3.7663068472605667`*^9}, {3.7663069765721145`*^9, 
   3.7663069793850317`*^9}, {3.766307076649989*^9, 3.766307084103266*^9}, {
   3.7663074752229843`*^9, 3.7663076021465516`*^9}, {3.766307701755226*^9, 
   3.766307728472045*^9}, {3.766307767695434*^9, 3.766307774213002*^9}, {
   3.76630780537226*^9, 3.766307899325618*^9}, {3.7663079316731386`*^9, 
   3.7663080702454805`*^9}, {3.766308103873612*^9, 3.7663081256782885`*^9}, {
   3.766308182450137*^9, 3.766308183778558*^9}, {3.7663082212095213`*^9, 
   3.766308228462101*^9}, {3.7663083028087487`*^9, 3.7663083077046857`*^9}, {
   3.766308361309354*^9, 3.7663083655171127`*^9}, {3.7663084165058384`*^9, 
   3.766308419247512*^9}, {3.766308673301964*^9, 3.7663086763096347`*^9}, 
   3.7663087510667477`*^9, {3.766308860848257*^9, 3.7663088822932405`*^9}, {
   3.766308946203117*^9, 3.7663089500238757`*^9}, {3.766313864693036*^9, 
   3.7663138849917397`*^9}, {3.7663139729374876`*^9, 
   3.7663140348988895`*^9}, {3.766314068413027*^9, 3.766314133221915*^9}, {
   3.766314229759568*^9, 3.766314240157198*^9}, {3.7663143466605425`*^9, 
   3.76631436353717*^9}, {3.7663143976489806`*^9, 3.766314456690667*^9}, {
   3.766314501869084*^9, 3.7663145307972956`*^9}, {3.766314576741469*^9, 
   3.7663145794003606`*^9}, {3.7663146537836337`*^9, 
   3.7663146711534667`*^9}, {3.766314746461097*^9, 3.766315002628665*^9}, {
   3.7663150913395367`*^9, 3.766315144730769*^9}, {3.766315221644149*^9, 
   3.7663152386351805`*^9}, {3.7663832968917117`*^9, 3.766383297127741*^9}, {
   3.7663834190878477`*^9, 3.7663834841191235`*^9}, {3.7663836442881174`*^9, 
   3.766383653978983*^9}, {3.7663836993747177`*^9, 3.7663837046673756`*^9}, {
   3.7663837389258056`*^9, 3.7663837441752334`*^9}, {3.7663838049163923`*^9, 
   3.7663838150913253`*^9}, {3.7663838714794474`*^9, 3.766383947014166*^9}, {
   3.7663840231083994`*^9, 3.7663840266209087`*^9}, 3.766384229341875*^9, {
   3.766384301515536*^9, 3.7663843016561966`*^9}, {3.7663844239083357`*^9, 
   3.766384432449978*^9}, {3.7663844674045787`*^9, 3.7663844737534065`*^9}, {
   3.766384507900341*^9, 3.7663846519063277`*^9}, {3.7663849083910933`*^9, 
   3.766384913736006*^9}, {3.766384968388257*^9, 3.7663849685082593`*^9}, 
   3.766385105074202*^9, {3.7663851391444936`*^9, 3.7663851413487577`*^9}, {
   3.7663888587632017`*^9, 3.766388875294525*^9}, {3.76638896854224*^9, 
   3.766388987376663*^9}, {3.7663890365244293`*^9, 3.766389070726489*^9}, {
   3.766389130889625*^9, 3.766389136767398*^9}, {3.7663921517738876`*^9, 
   3.766392185630041*^9}, {3.76639233559122*^9, 3.766392338298368*^9}, {
   3.7663924950164948`*^9, 3.7663925003672223`*^9}, {3.7664892034315553`*^9, 
   3.766489207211473*^9}, {3.766489274392589*^9, 3.766489340745099*^9}, {
   3.7664894271589117`*^9, 3.7664894283636584`*^9}, {3.766489481179356*^9, 
   3.76648950771237*^9}, {3.766489970996936*^9, 3.7664899748954763`*^9}, {
   3.7664900587132645`*^9, 3.766490126397154*^9}, {3.7664901581083126`*^9, 
   3.766490169684374*^9}, {3.766490246502824*^9, 3.766490313913474*^9}, {
   3.766490362046731*^9, 3.7664904056660347`*^9}, {3.766490455685181*^9, 
   3.7664904635351796`*^9}, {3.766490706958017*^9, 3.7664907557950726`*^9}, {
   3.7664907903592787`*^9, 3.7664909942853637`*^9}, {3.7664914545343304`*^9, 
   3.766491464988886*^9}, {3.7667425858339057`*^9, 3.766742590021674*^9}, {
   3.7667427862370024`*^9, 3.766742790638442*^9}, {3.766742857962658*^9, 
   3.766742871908347*^9}, {3.7667429256735053`*^9, 3.7667429839248285`*^9}, {
   3.7668141128265543`*^9, 3.766814208789931*^9}, {3.766814976522375*^9, 
   3.7668149799977255`*^9}, {3.7668150124238644`*^9, 3.766815039122419*^9}, {
   3.7668156238509293`*^9, 3.7668156959878845`*^9}, {3.7668160101371236`*^9, 
   3.7668160210349665`*^9}, {3.766828086816238*^9, 3.7668280896487837`*^9}, {
   3.7685462020226927`*^9, 3.768546286681206*^9}, {3.768816542375846*^9, 
   3.768816545718894*^9}, {3.7688165802977295`*^9, 3.7688165872039604`*^9}, {
   3.7688166226918316`*^9, 3.7688166252982254`*^9}, {3.768816682644203*^9, 
   3.7688166846761956`*^9}, {3.7688168809310207`*^9, 
   3.7688168854709806`*^9}, {3.768820108261264*^9, 3.768820198401501*^9}, {
   3.768820232541706*^9, 3.7688203140867877`*^9}, {3.7688209870121527`*^9, 
   3.768821013036793*^9}, {3.7688210691156273`*^9, 3.768821088305216*^9}, {
   3.7688221159375362`*^9, 3.768822145170673*^9}, {3.7688222088649244`*^9, 
   3.7688222124075065`*^9}, {3.7688224335017586`*^9, 
   3.7688224544856343`*^9}, {3.768822498276099*^9, 3.768822669056037*^9}, {
   3.768822888924266*^9, 3.768822889579485*^9}, {3.7688229349191046`*^9, 
   3.7688229657973146`*^9}, {3.768822995902994*^9, 3.7688230129664965`*^9}, {
   3.768823146365337*^9, 3.7688231499697013`*^9}, {3.7688232021395264`*^9, 
   3.768823328084777*^9}, 3.7688867224044285`*^9, {3.768886770043061*^9, 
   3.7688867984840508`*^9}, {3.7688878007704964`*^9, 
   3.7688878136402597`*^9}, {3.7688895932037554`*^9, 3.768889601959287*^9}, {
   3.768889923448259*^9, 3.7688899281277475`*^9}, {3.768890001709689*^9, 
   3.7688900070155*^9}, {3.768890259511209*^9, 3.768890262537839*^9}, {
   3.768890553898955*^9, 3.768890595088771*^9}, {3.768890740682377*^9, 
   3.7688908499226117`*^9}, {3.7688924787417526`*^9, 
   3.7688925250561123`*^9}, {3.7688927721737957`*^9, 3.768892784013732*^9}, {
   3.768892833421894*^9, 3.768892837785428*^9}, {3.770539111756788*^9, 
   3.7705391164954853`*^9}, {3.770539158036624*^9, 3.7705391854762707`*^9}, {
   3.7705392395052295`*^9, 3.770539254278614*^9}, {3.775210382248213*^9, 
   3.7752105036343117`*^9}, {3.775210553737254*^9, 3.7752105931769648`*^9}, {
   3.7752106246190853`*^9, 3.775210657783362*^9}, {3.775211581042758*^9, 
   3.775211584548195*^9}, {3.775211716457473*^9, 3.775211748626835*^9}, {
   3.7752807809443507`*^9, 3.775280911560833*^9}, {3.775281005527521*^9, 
   3.775281105656232*^9}, {3.7752811401452456`*^9, 3.775281189573555*^9}, {
   3.7752837411992145`*^9, 3.775283802875682*^9}, {3.775285889394021*^9, 
   3.775285929131876*^9}, {3.7752860220341697`*^9, 3.7752860254407644`*^9}, {
   3.7752861219882364`*^9, 3.7752861419361916`*^9}, {3.7752863724753256`*^9, 
   3.7752863995239115`*^9}, {3.7752865090568037`*^9, 
   3.7752865249019604`*^9}, {3.775286634350198*^9, 3.77528664087358*^9}, {
   3.7752869116566963`*^9, 3.7752869993022585`*^9}, {3.775287034541522*^9, 
   3.7752870573124247`*^9}, {3.7752873789901357`*^9, 3.775287386794855*^9}, {
   3.7752875190986753`*^9, 3.775287552945061*^9}, {3.7752876543607492`*^9, 
   3.775287657455021*^9}, {3.7752877299225273`*^9, 3.775287730094363*^9}, {
   3.775364890282223*^9, 3.7753649954165525`*^9}, 3.7753661948977175`*^9, {
   3.7753662501973248`*^9, 3.7753662922259607`*^9}, {3.775366825516316*^9, 
   3.7753668769874063`*^9}, {3.775367134252125*^9, 3.7753671343614397`*^9}, {
   3.775367736734592*^9, 3.775367747861275*^9}, {3.7753679709428906`*^9, 
   3.7753679733916245`*^9}, {3.7753688256938763`*^9, 3.775368835167092*^9}, {
   3.775369466556817*^9, 3.7753694932247877`*^9}, 3.775369603358945*^9, {
   3.7753698561964617`*^9, 3.7753699158304014`*^9}, {3.775369949306594*^9, 
   3.7753699834677362`*^9}, {3.77537002446325*^9, 3.775370383167596*^9}, {
   3.7753711466874886`*^9, 3.775371177701557*^9}, {3.7753714875201416`*^9, 
   3.77537152137603*^9}, {3.775371797456832*^9, 3.775371846755423*^9}, {
   3.7753718776294966`*^9, 3.7753719047514324`*^9}, {3.7753719761450987`*^9, 
   3.7753720259781265`*^9}, {3.775372076192145*^9, 3.7753721032107816`*^9}, 
   3.7753721426128283`*^9, {3.7753723649525695`*^9, 3.775372392872924*^9}, {
   3.775372499942566*^9, 3.775372503067871*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"98327eaf-a0e4-48e8-b9c6-511bdddb6108"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.775211564941335*^9, 3.7752115651757*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"03789950-3faa-4b12-aba9-8b204b0dd159"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "InsertFeynRulesAllDiags", "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "takes", " ", "as", " ", "RHS", " ", "one", " ", "single", " ", 
    "diagram"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InsertFeynRulesAllDiags", "[", 
   RowBox[{
   "allDiags_", ",", "derivativeList_", ",", "superindexReplacementList_", 
    ",", "fields_", ",", "loopIndex_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"allVars", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"Length", "@", "allDiags"}]}], "]"}]}], ",", " ", 
      RowBox[{"fullDiags", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"Null", ",", 
         RowBox[{"Length", "@", "allDiags"}]}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"myEcho", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<Insert Feynman Rules in Diagram no: \>\"", ",", "#"}], "}"}],
            ",", "1"}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"allVars", "[", 
             RowBox[{"[", "#", "]"}], "]"}], ",", 
            RowBox[{"fullDiags", "[", 
             RowBox[{"[", "#", "]"}], "]"}]}], "}"}], " ", "=", " ", 
          RowBox[{"InsertFeynRules", "[", 
           RowBox[{
            RowBox[{"allDiags", "[", 
             RowBox[{"[", "#", "]"}], "]"}], ",", "derivativeList", ",", 
            "superindexReplacementList", ",", "fields", ",", "loopIndex"}], 
           "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        ")"}], "&"}], "/@", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "allDiags"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"allVars", ",", "fullDiags"}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.761292490216677*^9, 3.761292626491716*^9}, {
   3.7612926723219795`*^9, 3.7612927674950056`*^9}, 3.76129305807738*^9, {
   3.761294006523538*^9, 3.7612941503573475`*^9}, {3.7612946644976797`*^9, 
   3.761294741921523*^9}, {3.761294772585949*^9, 3.761294773670802*^9}, {
   3.7612995661169767`*^9, 3.7612995944365573`*^9}, {3.761300703434873*^9, 
   3.7613007700261016`*^9}, {3.761300847611112*^9, 3.7613008592339153`*^9}, {
   3.7613010008061724`*^9, 3.7613010258617697`*^9}, {3.761301070175089*^9, 
   3.7613010989875813`*^9}, {3.761302336938572*^9, 3.761302526692627*^9}, {
   3.7613026173485622`*^9, 3.7613026255451913`*^9}, {3.7613027139844575`*^9, 
   3.7613027163777094`*^9}, {3.761303021250948*^9, 3.761303089970064*^9}, {
   3.7613031307778983`*^9, 3.7613031532110205`*^9}, {3.7613032149924917`*^9, 
   3.7613032155063686`*^9}, 3.761303256866626*^9, {3.7613032910340133`*^9, 
   3.7613033415726604`*^9}, {3.7613033942586474`*^9, 
   3.7613034391508503`*^9}, {3.7613036330800447`*^9, 3.761303642474721*^9}, {
   3.7613044082383976`*^9, 3.761304420352208*^9}, {3.7613044834666653`*^9, 
   3.761304738630164*^9}, {3.7613047961716175`*^9, 3.761304806869409*^9}, {
   3.76130484176575*^9, 3.761304956790863*^9}, {3.7613054534153347`*^9, 
   3.7613054884345927`*^9}, {3.7613055550035696`*^9, 
   3.7613056092858305`*^9}, {3.761305678607237*^9, 3.7613057452833457`*^9}, {
   3.761306154706893*^9, 3.7613061995757113`*^9}, {3.761306309161411*^9, 
   3.761306339654913*^9}, 3.761306386758635*^9, {3.7613066331678543`*^9, 
   3.7613066449337215`*^9}, {3.7613069486460686`*^9, 
   3.7613069588447857`*^9}, {3.7613070048788447`*^9, 
   3.7613070411296253`*^9}, {3.761307384758296*^9, 3.761307435581542*^9}, {
   3.7613075133387675`*^9, 3.761307560960465*^9}, {3.761307605968007*^9, 
   3.7613076308853455`*^9}, {3.7613727136812305`*^9, 
   3.7613727806591454`*^9}, {3.7613731390109043`*^9, 3.761373255247159*^9}, {
   3.7613732867230363`*^9, 3.7613732870082464`*^9}, {3.761373411853485*^9, 
   3.761373427548552*^9}, {3.761385225001584*^9, 3.7613854224189634`*^9}, {
   3.7613854584865727`*^9, 3.761385464596306*^9}, {3.7614613952147217`*^9, 
   3.761461395714551*^9}, {3.761903167914304*^9, 3.7619031710479193`*^9}, {
   3.7619036299004984`*^9, 3.7619036331381283`*^9}, {3.7620843143525343`*^9, 
   3.762084316712864*^9}, {3.762084483198273*^9, 3.7620844835917487`*^9}, {
   3.7620845631660995`*^9, 3.7620845866752567`*^9}, {3.7620848394720507`*^9, 
   3.762084840906704*^9}, 3.7620849163403015`*^9, {3.7620850870181065`*^9, 
   3.7620851022603254`*^9}, {3.76208526593073*^9, 3.7620854276350226`*^9}, {
   3.762085912002431*^9, 3.76208594108393*^9}, {3.7620860358363986`*^9, 
   3.762086195950012*^9}, {3.762086227356244*^9, 3.762086232871682*^9}, {
   3.7620862631334887`*^9, 3.7620862635010433`*^9}, {3.7620866295986004`*^9, 
   3.762086796066385*^9}, {3.7620869869789486`*^9, 3.762087147833151*^9}, {
   3.762087186084134*^9, 3.762087187769023*^9}, {3.762087331634629*^9, 
   3.7620873596232805`*^9}, 3.762087417589599*^9, {3.7620875705571504`*^9, 
   3.762087583809955*^9}, {3.7620876654218054`*^9, 3.76208768539128*^9}, {
   3.762087717571701*^9, 3.762087728359004*^9}, {3.762087770580208*^9, 
   3.7620877814874287`*^9}, {3.7620878975424385`*^9, 3.762087902300287*^9}, {
   3.7620879763472357`*^9, 3.7620880374047365`*^9}, {3.762088587863717*^9, 
   3.7620886824568033`*^9}, {3.7620887196788435`*^9, 
   3.7620887199936905`*^9}, {3.7620887771803827`*^9, 3.762088783651227*^9}, {
   3.7620888249567122`*^9, 3.762088843155718*^9}, {3.7620888822913303`*^9, 
   3.7620888876662245`*^9}, {3.7621602682938604`*^9, 
   3.7621603812043734`*^9}, {3.7621604838320117`*^9, 3.762160555599189*^9}, {
   3.7621606695922413`*^9, 3.7621606920375986`*^9}, {3.7621607254430714`*^9, 
   3.762160733895474*^9}, {3.7621608839226446`*^9, 3.762160957644784*^9}, {
   3.762161022277728*^9, 3.7621610503761854`*^9}, {3.7621611015953035`*^9, 
   3.7621611057349787`*^9}, {3.762161170755826*^9, 3.762161173067293*^9}, {
   3.762161896401228*^9, 3.7621619066722574`*^9}, {3.7621621182867303`*^9, 
   3.7621621239437833`*^9}, {3.7621624085160017`*^9, 3.762162417773438*^9}, 
   3.762162451915708*^9, {3.762162511867876*^9, 3.762162513603195*^9}, {
   3.762162620895088*^9, 3.762162631540476*^9}, {3.7621626930519266`*^9, 
   3.7621626965360975`*^9}, {3.7621629599478283`*^9, 
   3.7621629741646633`*^9}, {3.762163022073596*^9, 3.7621630424307857`*^9}, {
   3.762163105657398*^9, 3.7621631159740496`*^9}, 3.7621636665753927`*^9, {
   3.7621636984316616`*^9, 3.762163713892497*^9}, {3.76216376128421*^9, 
   3.7621637709862623`*^9}, {3.762163810908098*^9, 3.7621639449107885`*^9}, {
   3.7621639889091234`*^9, 3.7621640359645953`*^9}, {3.76216409223973*^9, 
   3.76216410179366*^9}, {3.7621643373299665`*^9, 3.762164410236729*^9}, {
   3.762164539689826*^9, 3.7621645613535285`*^9}, {3.762165142362401*^9, 
   3.7621651952839394`*^9}, {3.762165347067915*^9, 3.7621653492666698`*^9}, {
   3.762165516586459*^9, 3.762165521466889*^9}, {3.762166681419533*^9, 
   3.762166722009782*^9}, {3.7621673359856887`*^9, 3.7621673515045233`*^9}, {
   3.762167386304025*^9, 3.762167388291566*^9}, {3.762167446537222*^9, 
   3.762167450967204*^9}, {3.7621677405856953`*^9, 3.762167779437731*^9}, {
   3.7621682001262054`*^9, 3.76216820890841*^9}, {3.762168242581938*^9, 
   3.7621682606272745`*^9}, {3.762168525630968*^9, 3.7621685283345475`*^9}, {
   3.762169366099843*^9, 3.7621693926559315`*^9}, {3.7621694349230757`*^9, 
   3.7621694405957975`*^9}, 3.7621694951927533`*^9, {3.762169531934785*^9, 
   3.7621695983596373`*^9}, {3.7621696324466968`*^9, 
   3.7621696353081636`*^9}, {3.76216970681726*^9, 3.762169715602892*^9}, {
   3.7621697877886515`*^9, 3.7621698620675945`*^9}, {3.7621699377576094`*^9, 
   3.762169943171774*^9}, {3.7621702236743755`*^9, 3.762170268557784*^9}, {
   3.7621703149215736`*^9, 3.7621703199969063`*^9}, {3.7627716536102095`*^9, 
   3.7627716959113135`*^9}, {3.7627717267994766`*^9, 3.762771795043477*^9}, {
   3.76277186403868*^9, 3.7627718655766354`*^9}, {3.7627722651098523`*^9, 
   3.762772268103052*^9}, {3.7627727303825016`*^9, 3.76277276431818*^9}, {
   3.7627728180745583`*^9, 3.762772818527207*^9}, {3.762773163213295*^9, 
   3.7627731644450035`*^9}, {3.7627732579835052`*^9, 
   3.7627732921662188`*^9}, {3.762773372278068*^9, 3.7627733803354993`*^9}, {
   3.762773410833681*^9, 3.762773415272733*^9}, {3.762773549632476*^9, 
   3.7627735678357615`*^9}, {3.7627736032368402`*^9, 3.762773658424161*^9}, {
   3.7627736956214375`*^9, 3.7627737084296927`*^9}, {3.762773738868029*^9, 
   3.7627737581300354`*^9}, {3.7627738565814266`*^9, 3.762774011004856*^9}, {
   3.762774045434362*^9, 3.7627740776709957`*^9}, 3.764479968769766*^9, {
   3.764480047651125*^9, 3.7644800620552487`*^9}, {3.764480198779112*^9, 
   3.764480202765197*^9}, {3.7644802675825725`*^9, 3.76448029304994*^9}, {
   3.7644803355146275`*^9, 3.7644803415410547`*^9}, {3.764482927852171*^9, 
   3.7644829315879364`*^9}, {3.764482962639103*^9, 3.764482966528818*^9}, {
   3.7644830528945436`*^9, 3.7644830552734995`*^9}, {3.765180933468215*^9, 
   3.765180950412634*^9}, {3.765181534596143*^9, 3.7651815409996495`*^9}, {
   3.7651834372584906`*^9, 3.765183470161085*^9}, {3.7651838627772827`*^9, 
   3.765183868613595*^9}, {3.765184122299388*^9, 3.7651842513507795`*^9}, 
   3.765184305772746*^9, {3.7651843652036643`*^9, 3.765184372041726*^9}, {
   3.765184455120721*^9, 3.7651844831472297`*^9}, {3.7651845369175043`*^9, 
   3.7651845444544373`*^9}, {3.7651846831642523`*^9, 
   3.7651847602882977`*^9}, {3.765184814276168*^9, 3.7651848165557613`*^9}, {
   3.7651848721425776`*^9, 3.765184899922123*^9}, {3.7651849773195157`*^9, 
   3.765185011365918*^9}, {3.76520615839725*^9, 3.7652061800040646`*^9}, {
   3.765207635018532*^9, 3.7652076391162205`*^9}, {3.7652077754441395`*^9, 
   3.765207821230074*^9}, {3.7652079300844584`*^9, 3.765207933288955*^9}, 
   3.7652079872121844`*^9, {3.7652080229284115`*^9, 3.765208035694666*^9}, {
   3.7652081096290336`*^9, 3.7652082350464163`*^9}, {3.7652082949550858`*^9, 
   3.76520830499384*^9}, {3.765208352620532*^9, 3.7652083589607425`*^9}, {
   3.7652084408768897`*^9, 3.765208452017618*^9}, {3.765208633984056*^9, 
   3.7652087376915092`*^9}, {3.765208774342572*^9, 3.7652087956594243`*^9}, {
   3.7652089520326214`*^9, 3.7652090610352373`*^9}, {3.7652091189018044`*^9, 
   3.7652091647041516`*^9}, {3.765209198568284*^9, 3.7652093350786567`*^9}, {
   3.765209434769644*^9, 3.765209440868641*^9}, {3.7652096043914175`*^9, 
   3.765209654919057*^9}, {3.765209812737191*^9, 3.765209826218505*^9}, {
   3.765209860772315*^9, 3.7652098772877026`*^9}, {3.7652107199784627`*^9, 
   3.7652107220138135`*^9}, {3.765610660775546*^9, 3.7656107122428713`*^9}, {
   3.765610824984828*^9, 3.7656108304532056`*^9}, {3.765610885088666*^9, 
   3.7656108971853237`*^9}, {3.7656110175670137`*^9, 3.765611036810567*^9}, {
   3.765611078186214*^9, 3.765611182618021*^9}, {3.765612352320851*^9, 
   3.7656125050512285`*^9}, 3.7656126876964946`*^9, {3.7656128351246758`*^9, 
   3.7656128916331587`*^9}, {3.765612923098076*^9, 3.7656129625328555`*^9}, {
   3.765613026316374*^9, 3.765613047587723*^9}, {3.7656130819596043`*^9, 
   3.765613133655306*^9}, {3.7661392745370345`*^9, 3.766139312695865*^9}, {
   3.7661393839053435`*^9, 3.7661393869522047`*^9}, {3.7661572359879017`*^9, 
   3.7661572562782426`*^9}, {3.766157382076973*^9, 3.7661573847925053`*^9}, {
   3.76629619018487*^9, 3.7662962171734085`*^9}, {3.7662992030506353`*^9, 
   3.7662992126627684`*^9}, {3.7662992462391357`*^9, 
   3.7662992530833926`*^9}, {3.766299556302362*^9, 3.766299560038145*^9}, {
   3.7662996294888616`*^9, 3.7662997657796555`*^9}, {3.766299796749121*^9, 
   3.7662998193575554`*^9}, {3.7662998851263905`*^9, 3.766299886814065*^9}, {
   3.7663000008088245`*^9, 3.766300014075839*^9}, {3.76630005970662*^9, 
   3.766300074858597*^9}, 3.766300170409042*^9, {3.766300607003982*^9, 
   3.7663006105822053`*^9}, {3.7663007521825333`*^9, 
   3.7663007561672544`*^9}, {3.7663009403748684`*^9, 3.766300946937976*^9}, {
   3.766300997084649*^9, 3.766301001444528*^9}, {3.766301031777734*^9, 
   3.7663010473676624`*^9}, {3.7663011080573373`*^9, 
   3.7663011111359434`*^9}, {3.7663018543339434`*^9, 
   3.7663019080893087`*^9}, {3.7663019904483337`*^9, 3.7663020433568573`*^9}, 
   3.7663055654443703`*^9, {3.766305646489978*^9, 3.7663056616139402`*^9}, {
   3.766305691895934*^9, 3.766305708635751*^9}, {3.7663057965100913`*^9, 
   3.766305827918454*^9}, 3.7663059290316257`*^9, {3.7663061732422915`*^9, 
   3.7663061768048487`*^9}, {3.7663063531988754`*^9, 3.7663063538237534`*^9}, 
   3.766306414016101*^9, {3.766306461691236*^9, 3.766306502283886*^9}, {
   3.766306550824155*^9, 3.76630655527794*^9}, {3.766306613156296*^9, 
   3.766306632563882*^9}, {3.7663066653010063`*^9, 3.766306670847767*^9}, {
   3.7663067225361648`*^9, 3.7663067242394257`*^9}, 3.766306767884613*^9, {
   3.766306797887297*^9, 3.766306805528593*^9}, {3.766306843213296*^9, 
   3.7663068472605667`*^9}, {3.7663069765721145`*^9, 
   3.7663069793850317`*^9}, {3.766307076649989*^9, 3.766307084103266*^9}, {
   3.7663074752229843`*^9, 3.7663076021465516`*^9}, {3.766307701755226*^9, 
   3.766307728472045*^9}, {3.766307767695434*^9, 3.766307774213002*^9}, {
   3.76630780537226*^9, 3.766307899325618*^9}, {3.7663079316731386`*^9, 
   3.7663080702454805`*^9}, {3.766308103873612*^9, 3.7663081256782885`*^9}, {
   3.766308182450137*^9, 3.766308183778558*^9}, {3.7663082212095213`*^9, 
   3.766308228462101*^9}, {3.7663083028087487`*^9, 3.7663083077046857`*^9}, {
   3.766308361309354*^9, 3.7663083655171127`*^9}, {3.7663084165058384`*^9, 
   3.766308419247512*^9}, {3.766308673301964*^9, 3.7663086763096347`*^9}, 
   3.7663087510667477`*^9, {3.766308860848257*^9, 3.7663088822932405`*^9}, {
   3.766308946203117*^9, 3.7663089500238757`*^9}, {3.766313864693036*^9, 
   3.7663138849917397`*^9}, {3.7663139729374876`*^9, 
   3.7663140348988895`*^9}, {3.766314068413027*^9, 3.766314133221915*^9}, {
   3.766314229759568*^9, 3.766314240157198*^9}, {3.7663143466605425`*^9, 
   3.76631436353717*^9}, {3.7663143976489806`*^9, 3.766314456690667*^9}, {
   3.766314501869084*^9, 3.7663145307972956`*^9}, {3.766314576741469*^9, 
   3.7663145794003606`*^9}, {3.7663146537836337`*^9, 
   3.7663146711534667`*^9}, {3.766314746461097*^9, 3.766315002628665*^9}, {
   3.7663150913395367`*^9, 3.766315144730769*^9}, {3.766315221644149*^9, 
   3.7663152386351805`*^9}, {3.7663832968917117`*^9, 3.766383297127741*^9}, {
   3.7663834190878477`*^9, 3.7663834841191235`*^9}, {3.7663836442881174`*^9, 
   3.766383653978983*^9}, {3.7663836993747177`*^9, 3.7663837046673756`*^9}, {
   3.7663837389258056`*^9, 3.7663837441752334`*^9}, {3.7663838049163923`*^9, 
   3.7663838150913253`*^9}, {3.7663838714794474`*^9, 3.766383947014166*^9}, {
   3.7663840231083994`*^9, 3.7663840266209087`*^9}, 3.766384229341875*^9, {
   3.766384301515536*^9, 3.7663843016561966`*^9}, {3.7663844239083357`*^9, 
   3.766384432449978*^9}, {3.7663844674045787`*^9, 3.7663844737534065`*^9}, {
   3.766384507900341*^9, 3.7663846519063277`*^9}, {3.7663849083910933`*^9, 
   3.766384913736006*^9}, {3.766384968388257*^9, 3.7663849685082593`*^9}, 
   3.766385105074202*^9, {3.7663851391444936`*^9, 3.7663851413487577`*^9}, {
   3.7663888587632017`*^9, 3.766388875294525*^9}, {3.76638896854224*^9, 
   3.766388987376663*^9}, {3.7663890365244293`*^9, 3.766389070726489*^9}, {
   3.766389130889625*^9, 3.766389136767398*^9}, {3.7663921517738876`*^9, 
   3.766392185630041*^9}, {3.76639233559122*^9, 3.766392338298368*^9}, {
   3.7663924950164948`*^9, 3.7663925003672223`*^9}, {3.7664892034315553`*^9, 
   3.766489207211473*^9}, {3.766489274392589*^9, 3.766489340745099*^9}, {
   3.7664894271589117`*^9, 3.7664894283636584`*^9}, {3.766489481179356*^9, 
   3.76648950771237*^9}, {3.766489970996936*^9, 3.7664899748954763`*^9}, {
   3.7664900587132645`*^9, 3.766490126397154*^9}, {3.7664901581083126`*^9, 
   3.766490169684374*^9}, {3.766490246502824*^9, 3.766490313913474*^9}, {
   3.766490362046731*^9, 3.7664904056660347`*^9}, {3.766490455685181*^9, 
   3.7664904635351796`*^9}, {3.766490706958017*^9, 3.7664907557950726`*^9}, {
   3.7664907903592787`*^9, 3.7664909942853637`*^9}, {3.7664914545343304`*^9, 
   3.766491464988886*^9}, {3.7667425858339057`*^9, 3.766742590021674*^9}, {
   3.7667427862370024`*^9, 3.766742790638442*^9}, {3.766742857962658*^9, 
   3.766742871908347*^9}, {3.7667429256735053`*^9, 3.7667429839248285`*^9}, {
   3.7668141128265543`*^9, 3.766814208789931*^9}, {3.766814976522375*^9, 
   3.7668149799977255`*^9}, {3.7668150124238644`*^9, 3.766815039122419*^9}, {
   3.7668156238509293`*^9, 3.7668156959878845`*^9}, {3.7668160101371236`*^9, 
   3.7668160210349665`*^9}, {3.766828086816238*^9, 3.7668280896487837`*^9}, {
   3.7685462020226927`*^9, 3.768546286681206*^9}, {3.768816542375846*^9, 
   3.768816545718894*^9}, {3.7688165802977295`*^9, 3.7688165872039604`*^9}, {
   3.7688166226918316`*^9, 3.7688166252982254`*^9}, {3.768816682644203*^9, 
   3.7688166846761956`*^9}, {3.7688168809310207`*^9, 
   3.7688168854709806`*^9}, {3.768820108261264*^9, 3.768820198401501*^9}, {
   3.768820232541706*^9, 3.7688203140867877`*^9}, {3.7688209870121527`*^9, 
   3.768821013036793*^9}, {3.7688210691156273`*^9, 3.768821088305216*^9}, {
   3.7688221159375362`*^9, 3.768822145170673*^9}, {3.7688222088649244`*^9, 
   3.7688222124075065`*^9}, {3.7688224335017586`*^9, 
   3.7688224544856343`*^9}, {3.768822498276099*^9, 3.768822669056037*^9}, {
   3.768822888924266*^9, 3.768822889579485*^9}, {3.7688229349191046`*^9, 
   3.7688229657973146`*^9}, {3.768822995902994*^9, 3.7688230129664965`*^9}, {
   3.768823146365337*^9, 3.7688231499697013`*^9}, {3.7688232021395264`*^9, 
   3.768823328084777*^9}, 3.7688867224044285`*^9, {3.768886770043061*^9, 
   3.7688867984840508`*^9}, {3.7688878007704964`*^9, 
   3.7688878136402597`*^9}, {3.7688895932037554`*^9, 3.768889601959287*^9}, {
   3.768889923448259*^9, 3.7688899281277475`*^9}, {3.768890001709689*^9, 
   3.7688900070155*^9}, {3.768890259511209*^9, 3.768890262537839*^9}, {
   3.768890553898955*^9, 3.768890595088771*^9}, {3.768890740682377*^9, 
   3.7688908499226117`*^9}, {3.7688924787417526`*^9, 
   3.7688925250561123`*^9}, {3.7688927721737957`*^9, 3.768892784013732*^9}, {
   3.768892833421894*^9, 3.768892837785428*^9}, {3.770539111756788*^9, 
   3.7705391164954853`*^9}, {3.770539158036624*^9, 3.7705391854762707`*^9}, {
   3.7705392395052295`*^9, 3.770539254278614*^9}, {3.775210119964821*^9, 
   3.7752102846907816`*^9}, {3.7752105986154175`*^9, 
   3.7752106149926443`*^9}, {3.775211381657735*^9, 3.775211385182088*^9}, {
   3.7752114336112113`*^9, 3.775211441127247*^9}, {3.775211544845605*^9, 
   3.775211553518481*^9}, {3.7752839509486804`*^9, 3.775283954026867*^9}, {
   3.775367064616826*^9, 3.775367067995253*^9}, {3.7753671292356625`*^9, 
   3.7753671295936637`*^9}, {3.7753677631463833`*^9, 
   3.7753677632862015`*^9}, {3.775369557134836*^9, 3.775369578847165*^9}, 
   3.7753721081627502`*^9},
 CellLabel->
  "In[149]:=",ExpressionUUID->"c9aff41c-afe5-48ac-8dc7-6331130e57a8"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1264, 637},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 215, 3, 67, "Chapter",ExpressionUUID->"7b6e3491-fbf2-4072-8ccb-c063b53122d0"],
Cell[CellGroupData[{
Cell[820, 29, 519, 8, 67, "Section",ExpressionUUID->"e5703b66-52e0-4687-a1fe-186effae4703"],
Cell[1342, 39, 2892, 72, 219, "Input",ExpressionUUID->"29fd73aa-622a-48b7-9cae-9ae38cc3e78b"],
Cell[4237, 113, 177, 3, 28, "Input",ExpressionUUID->"296592cb-8af8-4fa2-81d8-cee2d05e51a6"],
Cell[4417, 118, 1576, 38, 143, "Input",ExpressionUUID->"e6e33873-5eff-44d5-b48e-44713cfcf2f4"],
Cell[5996, 158, 1859, 44, 181, "Input",ExpressionUUID->"8a98618a-5365-4438-a42c-69471e7c856b"],
Cell[7858, 204, 177, 3, 28, "Input",ExpressionUUID->"f827826f-4f35-4967-9821-052ca76e5d6a"],
Cell[8038, 209, 6191, 153, 371, "Input",ExpressionUUID->"2d145f78-9dd3-4af8-9213-b254d325a21c"],
Cell[14232, 364, 231, 4, 67, "Input",ExpressionUUID->"0d8e078b-26ee-4193-b2fe-ae97f0b3da8b"],
Cell[14466, 370, 11851, 285, 903, "Input",ExpressionUUID->"72d8f109-0c32-49df-b342-5415ea7851bf"],
Cell[26320, 657, 231, 4, 67, "Input",ExpressionUUID->"8a6bfa8a-11d6-495f-a310-814bb3949672"],
Cell[26554, 663, 6515, 157, 276, "Input",ExpressionUUID->"8e63e1bb-7317-4e4b-80b6-d1e7042fb0e1"],
Cell[33072, 822, 179, 3, 28, "Input",ExpressionUUID->"727dd6fe-4877-4951-99f8-234729186e54"]
}, Closed]],
Cell[CellGroupData[{
Cell[33288, 830, 816, 12, 53, "Section",ExpressionUUID->"d37f6455-e56b-4714-9b5f-b8e0d40a3d42"],
Cell[CellGroupData[{
Cell[34129, 846, 216, 4, 53, "Subsection",ExpressionUUID->"98b1ff58-4e66-4200-ad78-e5b54945bfc0"],
Cell[34348, 852, 15856, 375, 1169, "Input",ExpressionUUID->"2d97077c-0214-45be-a7aa-7a778d645042"],
Cell[50207, 1229, 31615, 664, 1967, "Input",ExpressionUUID->"6f8807ed-da56-4984-848d-590a22e598bd"],
Cell[81825, 1895, 2020, 52, 219, "Input",ExpressionUUID->"14225a19-e280-4311-adbe-5d7174e18152"],
Cell[83848, 1949, 4008, 100, 257, "Input",ExpressionUUID->"79cf7902-e6a5-430e-9b5d-ec0006b5377b"],
Cell[87859, 2051, 2288, 53, 238, "Input",ExpressionUUID->"8b1aa336-1fbb-4e14-8498-dba55b7ba3b6"],
Cell[90150, 2106, 2008, 49, 143, "Input",ExpressionUUID->"f8a32361-555c-4077-be12-7110b34862a0"],
Cell[92161, 2157, 4606, 104, 295, "Input",ExpressionUUID->"2c8605d3-2419-4351-b42d-5ef31b0110d3"]
}, Closed]],
Cell[CellGroupData[{
Cell[96804, 2266, 163, 3, 37, "Subsection",ExpressionUUID->"a559ea9c-7198-42bc-a828-c0c69e1b6789"],
Cell[96970, 2271, 2166, 51, 216, "Input",ExpressionUUID->"46be70e7-de70-4dd9-9f2d-3558ff35b6f0",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[99161, 2326, 3498, 88, 132, "Input",ExpressionUUID->"a9f0eb58-f735-4600-90ff-1a05f1563b46"],
Cell[102662, 2416, 581, 9, 32, "Output",ExpressionUUID->"13b85e15-c850-4872-a72c-7948f6fe68dd"]
}, Open  ]],
Cell[103258, 2428, 5948, 131, 292, "Input",ExpressionUUID->"30413f8f-f67c-430e-b162-8f9a64931bf1",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[109231, 2563, 410, 12, 28, "Input",ExpressionUUID->"9cbfd97c-04d4-415c-bd60-d4cb3f0e4c78"],
Cell[109644, 2577, 469, 12, 32, "Output",ExpressionUUID->"242fcd79-d4b1-4fd3-bf3c-12ad5f2f9e01"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110150, 2594, 410, 12, 28, "Input",ExpressionUUID->"8815aae7-829f-4e59-bbc5-4feca6155e80"],
Cell[110563, 2608, 482, 14, 32, "Output",ExpressionUUID->"bd92a6a4-6447-41f4-9135-690330b7b3bb"]
}, Open  ]],
Cell[111060, 2625, 8549, 189, 663, "Code",ExpressionUUID->"ad8f0e7d-d3e9-43c9-9391-772f2790bc64"],
Cell[CellGroupData[{
Cell[119634, 2818, 568, 17, 28, "Input",ExpressionUUID->"2f16505f-8546-4a84-9c14-a44c292e1644"],
Cell[120205, 2837, 226, 4, 32, "Output",ExpressionUUID->"91c7c5e4-21eb-49f0-87fd-fe289a577ba7"]
}, Open  ]],
Cell[120446, 2844, 7362, 167, 900, "Input",ExpressionUUID->"2cce13d4-4aa2-4f57-b2db-413e31d36a5a",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[127833, 3015, 1226, 36, 48, "Input",ExpressionUUID->"dc50e2c3-9f19-43de-bd86-a8c0b3d44d5b"],
Cell[129062, 3053, 394, 10, 32, "Output",ExpressionUUID->"b9654f10-3762-4d81-85e4-7b6b39e2747c"]
}, Open  ]],
Cell[129471, 3066, 16697, 382, 1356, "Input",ExpressionUUID->"2966e46c-8b4a-4bc6-ad4a-ccb9eb2f7327",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[146193, 3452, 4777, 125, 143, "Input",ExpressionUUID->"ee643d31-6d36-499c-ab8d-5cc817c9f12a"],
Cell[150973, 3579, 1409, 28, 32, "Output",ExpressionUUID->"a24d6d9d-da32-4a6b-8270-c4eb39678c3c"]
}, Open  ]],
Cell[152397, 3610, 5759, 119, 425, "Input",ExpressionUUID->"512ee036-d36f-41d7-80a6-3672b7e65af6",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[158181, 3733, 1219, 32, 28, "Input",ExpressionUUID->"404ec411-c931-4128-809f-dcd628d737ca"],
Cell[159403, 3767, 1524, 43, 52, "Output",ExpressionUUID->"83a9ff07-e0d4-4eef-bb56-3dec8ceb9bec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160964, 3815, 996, 28, 28, "Input",ExpressionUUID->"8be995aa-939c-4f72-acce-3d4d280154af"],
Cell[161963, 3845, 1049, 30, 32, "Output",ExpressionUUID->"035d9915-a8b6-464c-a26b-ce7a237897c2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[163061, 3881, 216, 4, 53, "Subsection",ExpressionUUID->"12e32e81-fe54-4a42-a9fc-6769ec412ea3"],
Cell[163280, 3887, 6288, 153, 371, "Input",ExpressionUUID->"ed2fdba8-bfdf-46db-8af4-c328ea673c9e"],
Cell[169571, 4042, 149, 3, 48, "Input",ExpressionUUID->"1e6f57f9-b3dd-4d7a-81bf-e7d4fde1e382"],
Cell[169723, 4047, 3485, 80, 235, "Input",ExpressionUUID->"c9ec9369-845b-4e86-94e1-09c1bafa392c",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[173233, 4131, 1013, 28, 48, "Input",ExpressionUUID->"bd878245-23db-44ba-9a96-d1481644e82c"],
Cell[174249, 4161, 238, 5, 32, "Output",ExpressionUUID->"174108e1-a409-4653-b5b2-ad9dba4f958b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[174536, 4172, 163, 3, 53, "Subsection",ExpressionUUID->"991ed968-166d-455a-adc6-1a3f385b2e6a"],
Cell[174702, 4177, 275, 6, 28, "Input",ExpressionUUID->"94c2eaf6-aebc-4caa-b588-e97b5193db2d"],
Cell[174980, 4185, 51142, 1064, 2990, "Input",ExpressionUUID->"98327eaf-a0e4-48e8-b9c6-511bdddb6108",
 InitializationCell->True],
Cell[226125, 5251, 253, 5, 86, "Input",ExpressionUUID->"03789950-3faa-4b12-aba9-8b204b0dd159"],
Cell[226381, 5258, 19577, 298, 330, "Input",ExpressionUUID->"c9aff41c-afe5-48ac-8dc7-6331130e57a8",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

