(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    217534,       5375]
NotebookOptionsPosition[    210244,       5237]
NotebookOutlinePosition[    210665,       5254]
CellTagsIndexPosition[    210622,       5251]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Derive Functional Equation Tools", "Chapter",
 CellChangeTimes->{{3.93209220263177*^9, 
  3.93209220350491*^9}},ExpressionUUID->"aede59b2-194f-46df-ac63-\
25a1e4e2fbde"],

Cell[BoxData[
 RowBox[{"BeginPackage", "[", "\"\<QMeSderivation`Tools`\>\"", "]"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.932092206781699*^9, 
  3.9320922086022043`*^9}},ExpressionUUID->"26b1bd1d-881b-4710-9df9-\
68606cbb6f63"],

Cell[CellGroupData[{

Cell["Exports", "Section",
 CellChangeTimes->{{3.925554935377668*^9, 
  3.925554956974764*^9}},ExpressionUUID->"66d3b196-e162-4109-9eae-\
736f9d47bb81"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ReduceIdenticalFlowDiagrams", "::", "usage"}], " ", "=", " ", 
   "\"\<ReduceIdenticalFlowDiagrams[diagrams,derivativeList,symmetries]\n\n\
Reduce a set of flow equations by matching identical topologies and/or by \
utilizing a given set of symmetries.\nThe user has to supply the list of \
derivatives (i.e. external legs in the diagrams). Then, the symmetries are \
specified in the following way:\nsymmetries = {\n\t{ {1, 3}, Minus},\n\t{ {2, \
4}, Minus}\n\t{ {1, 3}, {2, 4}, Plus},\n}\nHere, two antisymmetries (as \
specified by the Minus) are given, which consist of a single cycle each (1,3) \
and (2,4). These integers refer to the legs as given in derivativeList (in \
order).\nReduceIdenticalFlowDiagrams does not construct all symmetries from \
the given ones - therefore, the full symmetry group needs to be specified. \
Therefore, we also supply the symmetry consisting of both cycles explicitly \
in the third line.\n\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.932181348978413*^9, 3.932181351108021*^9}, {
  3.932228460785002*^9, 3.93222855518638*^9}, {3.932274190842181*^9, 
  3.9322744547106524`*^9}},ExpressionUUID->"ea48f95a-f602-4077-9974-\
c881c0ff1d9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PlotSuperindexDiagram", "::", "usage"}], " ", "=", " ", 
   "\"\<PlotSuperindexDiagram[diagram, setup, options]\n\nPlot a single \
superindex diagram. The first argument to this function is the diagram \
itself, the second one is the corresponding QMeS setup.\nThe diagram has to \
be a superindex diagram.\n\nThe options for the function \
PlotSuperindexDiagram are:\n\\\"ShowEdgeLabels\\\" ->  False / True\n\tThis \
option will toggle whether edges are plotted together with labels to identify \
them.\n\\\"EdgeStyle\\\" ->  List\n\tUsing this option, one can specify the \
edge styles of different propagators. e.g.,\n\t\t\
\\\"EdgeStyle\\\"->{q->Blue,A->Orange,\[CapitalPi]->{Dashed,Thick},\[Sigma]->{\
Dashed,Thick,Purple}}.\n\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.932227941622631*^9, 3.932227988609272*^9}, {
   3.932228028255905*^9, 3.932228079141274*^9}, {3.932228110742558*^9, 
   3.932228122263984*^9}, {3.932228158228592*^9, 3.932228391016657*^9}, {
   3.932274156809449*^9, 3.932274183291034*^9}, 
   3.9323108274587708`*^9},ExpressionUUID->"8f677744-cfb0-40f4-b89f-\
c83aaf8aa0d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlotSuperindexDiagrams", "::", "usage"}], "=", 
  "\"\<PlotSuperindexDiagram[diagrams, setup, options]\n\nPlot a set of \
superindex diagrams. The first argument to this function is a list of \
diagrams, the second one is the corresponding QMeS setup.\nThe diagrams have \
to be superindex diagrams.\n\nThe options for the function \
PlotSuperindexDiagrams are:\n\\\"ShowEdgeLabels\\\" ->  False / True\n\tThis \
option will toggle whether edges are plotted together with labels to identify \
them.\n\\\"EdgeStyle\\\" ->  List\n\tUsing this option, one can specify the \
edge styles of different propagators. e.g.,\n\t\t\
\\\"EdgeStyle\\\"->{q->Blue,A->Orange,\[CapitalPi]->{Dashed,Thick},\[Sigma]->{\
Dashed,Thick,Purple}}.\n\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.932233208274609*^9, 3.932233215945693*^9}, {
  3.932275133928404*^9, 3.932275185187236*^9}, {3.932310806757222*^9, 
  3.932310814935439*^9}},ExpressionUUID->"301c841e-d18e-467c-829e-\
d2fe1d67da6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RerouteFermionicMomenta", "::", "usage"}], "=", 
  "\"\<RerouteFermionicMomenta[diagrams, setup, derivativeList]\n\nReroute \
external fermionic momenta in diagrams such that Matsubara frequencies are \
automatically correctly routed.\nIf a closed fermion loop is present, the \
momentum in this loop is marked by attaching the character 'f' to it (i.e. q \
-> qf in such a loop).\nThe first argument to this function is a list of \
diagrams, the second one is the corresponding QMeS setup. The third argument \
is the derivative list that has been used to derive the set of diagrams.\nBe \
aware, that the rerouting exploits momentum conservation - therefore, one of \
the external momenta may be eliminated if this is not yet the case.\n\
\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.93228225684037*^9, 3.9322822886898*^9}, 
   3.9323099859353027`*^9, {3.932310715963155*^9, 3.9323107977121987`*^9}, {
   3.932310836402197*^9, 
   3.932310918209069*^9}},ExpressionUUID->"1aba1273-b7c6-4f59-a812-\
5fd809f716c6"],

Cell[BoxData[
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"3ec6060e-25c6-41bf-bcdb-f69c8d8cb5cb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Debug", "Section",
 CellChangeTimes->{{3.925555181021306*^9, 
  3.925555190406625*^9}},ExpressionUUID->"c860513e-188c-43ef-9b76-\
1b904d2adeae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$DebugLevel", " ", "=", "0"}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[2]:=",ExpressionUUID->"e28b94f8-4ec5-4d82-95fc-59ffaf4ac5c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myEcho", "[", 
   RowBox[{"msg_", ",", "lvl_"}], "]"}], " ", ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"$DebugLevel", " ", ">=", "lvl"}], ",", " ", 
    RowBox[{
     RowBox[{"Echo", "[", "msg", "]"}], ";"}], ",", " ", 
    RowBox[{"Nothing", ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[3]:=",ExpressionUUID->"ab76e3eb-0df2-489c-90da-b0c1149e7958"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utilities", "Section",
 CellChangeTimes->{{3.932177970725307*^9, 
  3.9321779720559883`*^9}},ExpressionUUID->"5435ef76-4c83-491d-a479-\
2c8c1f89c7e1"],

Cell[CellGroupData[{

Cell["Tests and assertions", "Subsection",
 CellChangeTimes->{{3.932177978186654*^9, 
  3.932177982039123*^9}},ExpressionUUID->"af2e49d9-78da-4159-bd04-\
8bc58aab6a36"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TestIsSuperindexDiagram", "[", "diag_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"hasPrefactor", ",", "hasAssociations"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{
         RowBox[{"ListQ", "[", "diag", "]"}], "&&", 
         RowBox[{
          RowBox[{"Length", "[", "diag", "]"}], ">", "1"}]}], "]"}], ",", 
       RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hasAssociations", "=", 
      RowBox[{
       RowBox[{"AllTrue", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"AssociationQ", ",", 
           RowBox[{"Flatten", "@", 
            RowBox[{"diag", "[", 
             RowBox[{"[", 
              RowBox[{"2", ";;"}], "]"}], "]"}]}]}], "]"}], ",", "Identity"}],
         "]"}], "&&", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Flatten", "@", 
          RowBox[{"diag", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;"}], "]"}], "]"}]}], "]"}], ">", "0"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hasPrefactor", "=", 
      RowBox[{
       RowBox[{"Extract", "[", 
        RowBox[{
         RowBox[{"diag", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "==", 
       "\"\<Prefactor\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"hasAssociations", "&&", "hasPrefactor"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AssertIsSuperIndexDiagram", "[", 
    RowBox[{"diag_", ",", 
     RowBox[{"context_String", ":", "\"\<\>\""}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"TestIsSuperindexDiagram", "[", "diag", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "context", ",", "\"\< Argument is not a SuperIndexDiagram.\>\""}], 
       "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AssertAllSuperIndexDiagrams", "[", 
    RowBox[{"diags_List", ",", 
     RowBox[{"context_String", ":", "\"\<\>\""}]}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AssertIsSuperIndexDiagram", "[", 
       RowBox[{"#", ",", "context"}], "]"}], "&"}], ",", "diags"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.932092499302857*^9, 3.93209265608632*^9}, {
  3.93209288371324*^9, 3.932093086289074*^9}, {3.9320931397015963`*^9, 
  3.932093172331933*^9}, {3.932093221617383*^9, 3.932093235833461*^9}, {
  3.932093268583647*^9, 3.932093290189995*^9}, {3.932094675034731*^9, 
  3.932094796543549*^9}, {3.932094852173008*^9, 3.932094902480122*^9}, {
  3.932094939689563*^9, 3.932094944254856*^9}, {3.932095729312064*^9, 
  3.9320957297449923`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"c01afb9a-ad61-4425-889a-03c87ac316aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TestIsOneLoop", "[", "diag_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "internalIndices", ",", "objectIndices", ",", "assignNumber", ",", 
       "mapAssignNumber", ",", "testNumbers"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AssertIsSuperIndexDiagram", "[", 
       RowBox[{"diag", ",", "\"\<TestIsOneLoop:\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"An", " ", "expression", " ", "is", " ", "one"}], "-", 
         RowBox[{"loop", " ", "if", " ", "every", " ", "object", " ", 
          RowBox[{"(", 
           RowBox[{"vertex", " ", "or", " ", "propagator"}], ")"}], " ", 
          "has", " ", "only", " ", "one", " ", "incoming", " ", "and", " ", 
          "one", " ", "outgoing", " ", 
          RowBox[{"index", ".", "\[IndentingNewLine]", "Therefore"}]}]}], ",",
         " ", 
        RowBox[{
        "what", " ", "we", " ", "do", " ", "here", " ", "is", " ", "to", " ", 
         "check", " ", "the", " ", "number", " ", "of", " ", "internal", " ", 
         "indices", " ", "of", " ", "any", " ", "object", " ", "in", " ", 
         "the", " ", "diagram", " ", "and", " ", "testing", " ", "whether", 
         " ", "this", " ", "is", " ", "exactly", " ", "2", " ", "for", " ", 
         "all", " ", 
         RowBox[{"objects", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"internalIndices", "=", 
       RowBox[{"GetInternalIndices", "[", "diag", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectIndices", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "\"\<indices\>\"", "]"}], "&"}], ",", 
         RowBox[{"diag", "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"assignNumber", "=", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"internalIndices", ",", "#"}], "]"}], ",", "1", ",", "0"}],
          "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mapAssignNumber", "=", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{"assignNumber", ",", "#"}], "]"}], "&"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"testNumbers", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"mapAssignNumber", "[", "#", "]"}], "]"}], "&"}], ",", 
         "objectIndices"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"AllTrue", "[", 
        RowBox[{"testNumbers", ",", 
         RowBox[{
          RowBox[{"#", "==", "2"}], "&"}]}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AssertIsOneLoop", "[", 
     RowBox[{"diag_List", ",", 
      RowBox[{"context_String", ":", "\"\<\>\""}]}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"Not", "@", 
       RowBox[{"TestIsOneLoop", "[", "diag", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"context", ",", "\"\< Diagram is not one-loop.\>\""}], "]"}], 
       ";", 
       RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TestIsFlowDiagram", "[", "diag_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"content", ",", "regulatordotMatch"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"content", "=", 
       RowBox[{"SuperIndexDiagramContent", "[", "diag", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"regulatordotMatch", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"content", ",", 
         RowBox[{
          RowBox[{"StringMatchQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{"\"\<Regulatordot\>\"", "~~", "___"}]}], "]"}], "&"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "regulatordotMatch", "]"}], "==", "1"}], ",", 
        "True", ",", "False"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AssertIsFlowDiagram", "[", 
    RowBox[{"diag_List", ",", 
     RowBox[{"context_String", ":", "\"\<\>\""}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"TestIsFlowDiagram", "[", "diag", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"context", ",", "\"\< Diagram is not a flow diagram.\>\""}], 
       "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.932096757696724*^9, 3.932096786432174*^9}, {
  3.932097595895443*^9, 3.932097745029286*^9}, {3.932097808685877*^9, 
  3.932098202621862*^9}, {3.932108238419031*^9, 3.932108311419837*^9}, {
  3.932108341610519*^9, 3.93210846462273*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"0a58cf74-2354-4fca-bb76-5ece6df41991"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TestIsFullDiagram", "[", 
    RowBox[{"diag_", "/;", 
     RowBox[{
      RowBox[{"Head", "[", "diag", "]"}], "=!=", "List"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"extr", ",", "symbols"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "diag", "]"}], "===", "Association"}], "||", 
         RowBox[{
          RowBox[{"Head", "[", "diag", "]"}], "===", "Rule"}]}], ",", 
        RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"extr", "=", 
       RowBox[{"diag", "/.", 
        RowBox[{
         RowBox[{"h_", "[", 
          RowBox[{"{", "a___", "}"}], "]"}], ":>", "h"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"symbols", "=", 
       RowBox[{"GetAllSymbols", "[", "extr", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AllTrue", "[", 
       RowBox[{"symbols", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"StringPart", "[", 
             RowBox[{
              RowBox[{"ToString", "[", "#", "]"}], ",", "1"}], "]"}], "==", 
            "\"\<G\>\""}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"StringPart", "[", 
             RowBox[{
              RowBox[{"ToString", "[", "#", "]"}], ",", "1"}], "]"}], "==", 
            "\"\<\[CapitalGamma]\>\""}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"StringPart", "[", 
             RowBox[{
              RowBox[{"ToString", "[", "#", "]"}], ",", "1"}], "]"}], "==", 
            "\"\<R\>\""}], ")"}]}], "&"}]}], "\[IndentingNewLine]", "]"}]}]}],
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TestIsFullDiagram", "[", "diag_List", "]"}], ":=", 
   RowBox[{"AllTrue", "[", 
    RowBox[{"diag", ",", "TestIsFullDiagram"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AssertIsFullDiagram", "[", 
    RowBox[{"diag_", ",", 
     RowBox[{"context_String", ":", "\"\<\>\""}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"TestIsFullDiagram", "[", "diag", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"context", ",", "\"\< Argument is not a FullDiagram.\>\""}], 
       "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9323100540174913`*^9, 3.932310057477655*^9}, {
  3.932310146074576*^9, 3.9323101749480042`*^9}, {3.932310224850842*^9, 
  3.9323102546588917`*^9}, {3.932310328041493*^9, 3.932310479782414*^9}, {
  3.932310529021359*^9, 3.932310658225215*^9}, {3.93231216411018*^9, 
  3.932312189469748*^9}, {3.9323122863045807`*^9, 3.932312331317864*^9}, {
  3.93231236709827*^9, 3.932312367436141*^9}, {3.932312409708041*^9, 
  3.9323124179615498`*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"4bc213ad-e1f4-4f75-b946-17fff4b07ad4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Getting objects", "Subsection",
 CellChangeTimes->{{3.932178009618313*^9, 
  3.932178022055203*^9}},ExpressionUUID->"f34f67a9-8968-4f68-b177-\
066a97452e1d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetIndices", "[", "diag_List", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AssertIsSuperIndexDiagram", "[", 
       RowBox[{"diag", ",", "\"\<TestIsOneLoop:\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", "\"\<indices\>\"", "]"}], "&"}], ",", 
          RowBox[{"diag", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;"}], "]"}], "]"}]}], "]"}], ",", "1"}], "]"}]}]}],
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetExternalIndices", "[", "diag_List", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "allIndices", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AssertIsSuperIndexDiagram", "[", 
       RowBox[{"diag", ",", "\"\<TestIsOneLoop:\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"allIndices", "=", 
       RowBox[{"GetIndices", "[", "diag", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Keys", "@", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Counts", "[", "allIndices", "]"}], ",", 
         RowBox[{
          RowBox[{"#", "==", "1"}], "&"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetInternalIndices", "[", "diag_List", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "allIndices", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AssertIsSuperIndexDiagram", "[", 
        RowBox[{"diag", ",", "\"\<TestIsOneLoop:\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"allIndices", "=", 
        RowBox[{"GetIndices", "[", "diag", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Keys", "@", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Counts", "[", "allIndices", "]"}], ",", 
          RowBox[{
           RowBox[{"#", ">", "1"}], "&"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetIndices", "[", "obj_Association", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"obj", "[", "\"\<indices\>\"", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetExternalIndices", "[", 
    RowBox[{"diag_List", ",", "obj_Association"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"allIndices", ",", "externalIndices"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"allIndices", "=", 
       RowBox[{"GetIndices", "[", "obj", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"externalIndices", "=", 
       RowBox[{"GetExternalIndices", "[", "diag", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Select", "[", 
       RowBox[{"allIndices", ",", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"externalIndices", ",", "#"}], "]"}], "&"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetInternalIndices", "[", 
    RowBox[{"diag_List", ",", "obj_Association"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"allIndices", ",", "internalIndices"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AssertIsSuperIndexDiagram", "[", 
       RowBox[{"diag", ",", "\"\<TestIsOneLoop:\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"allIndices", "=", 
       RowBox[{"GetIndices", "[", "obj", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"internalIndices", "=", 
       RowBox[{"GetInternalIndices", "[", "diag", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Select", "[", 
       RowBox[{"allIndices", ",", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"internalIndices", ",", "#"}], "]"}], "&"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.932096846745219*^9, 3.932096941706905*^9}, {
   3.932097325018382*^9, 3.932097376088599*^9}, {3.9320974382040777`*^9, 
   3.9320975220818443`*^9}, {3.93209762404568*^9, 3.932097627406646*^9}, 
   3.9320982089641047`*^9, {3.932109671894282*^9, 3.932109854152437*^9}, {
   3.932109909091211*^9, 3.932109940172472*^9}, {3.932178058342364*^9, 
   3.932178063276268*^9}, 3.932228431604857*^9},
 CellLabel->"In[46]:=",ExpressionUUID->"a68ab892-1d13-4fae-8dd2-fccfec36b491"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetObjectIdentifier", "[", "ob_Association", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ob", "[", "\"\<type\>\"", "]"}], "<>", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}], ",", 
          RowBox[{"ob", "[", "\"\<indices\>\"", "]"}]}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetRegulatordot", "[", "diag_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AssertIsFlowDiagram", "[", 
       RowBox[{"diag", ",", "\"\<GetRegulatordot:\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"diag", ",", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"#", ",", "\"\<Regulatordot\>\"", ",", "Infinity"}], "]"}],
           "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.93217806709244*^9, 3.932178067486834*^9}, {
  3.932228434818475*^9, 3.932228438926673*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"85869703-45b3-4f00-bb0e-83d99fad6a5b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetBosons", "[", "setup_Association", "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{"Head", ",", 
     RowBox[{
      RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
      "\"\<bosonic\>\"", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetFermionPairs", "[", "setup_Association", "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
        RowBox[{"Head", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
     RowBox[{
      RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
      "\"\<fermionic\>\"", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetFermions", "[", "setup_Association", "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], "&"}], ",", 
     RowBox[{
      RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
      "\"\<fermionic\>\"", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetAntiFermions", "[", "setup_Association", "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", 
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}], ",", 
     RowBox[{
      RowBox[{"setup", "[", "\"\<FieldSpace\>\"", "]"}], "[", 
      "\"\<fermionic\>\"", "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.932178093219666*^9, {3.932220707851465*^9, 3.932220747249592*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"0a89d4a0-75e0-4c74-8f47-fc4fb248625b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetPartnerField", "[", 
    RowBox[{"field_", ",", "setup_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fermions", ",", "bosons", ",", "sel"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fermions", "=", 
       RowBox[{"GetFermionPairs", "[", "setup", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bosons", "=", 
       RowBox[{"GetBosons", "[", "setup", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"fermions", ",", "field", ",", "Infinity"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sel", "=", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"fermions", ",", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"#", ",", "field", ",", "Infinity"}], "]"}], "&"}]}], 
            "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"sel", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"sel", ",", "field"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"sel", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"bosons", ",", "field", ",", "Infinity"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "field", "]"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<field \>\"", ",", "field", ",", "\"\< not found!\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.932310703182301*^9},
 CellLabel->"In[58]:=",ExpressionUUID->"467f3b0f-adfb-484c-8f6c-999a60669b6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetAllSymbols", "[", "expr_", "]"}], ":=", 
  RowBox[{"DeleteDuplicates", "@", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"{", "expr", "}"}], ",", "_Symbol", ",", "Infinity"}], 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[59]:=",ExpressionUUID->"651d3be3-be21-417a-9017-7e76b7af0821"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Diagram reduction", "Section",
 CellChangeTimes->{{3.932180128056748*^9, 
  3.932180130835743*^9}},ExpressionUUID->"233ac0db-233d-40c3-9de5-\
6f7902474cfc"],

Cell[CellGroupData[{

Cell["Diagram grouping", "Subsection",
 CellChangeTimes->{{3.932180138663007*^9, 
  3.932180140777234*^9}},ExpressionUUID->"62e4b34f-224d-4de9-bcc8-\
29bcb5279d9f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SuperIndexDiagramContent", "[", "diag_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AssertIsSuperIndexDiagram", "[", 
       RowBox[{"diag", ",", "\"\<SuperIndexDiagramContent:\>\""}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Sort", "[", 
       RowBox[{"Map", "[", 
        RowBox[{"GetObjectIdentifier", ",", 
         RowBox[{"diag", "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;"}], "]"}], "]"}]}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SeparateSuperIndexDiagramGroups", "[", "diags_List", "]"}], ":=", 
   
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"identifierRep", ",", "removeFirsts", ",", "groupedDiagrams"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AssertAllSuperIndexDiagrams", "[", 
       RowBox[{"diags", ",", "\"\<SeparateSubdiagramGroups:\>\""}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "We", " ", "group", " ", "all", " ", "diagrams", " ", "into", " ", 
         "groups", " ", "that", " ", "could", " ", "be", " ", "potentially", 
         " ", 
         RowBox[{"identical", ".", " ", "\[IndentingNewLine]", "We"}], " ", 
         "simply", " ", "make", " ", "sure", " ", "that", " ", "in", " ", 
         "each", " ", "group", " ", "all", " ", "diagrams", " ", "have", " ", 
         "the", " ", "same", " ", "objects"}], ",", " ", 
        RowBox[{"ignoring", " ", 
         RowBox[{"topology", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"identifierRep", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"SuperIndexDiagramContent", ",", "diags"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"identifierRep", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"identifierRep", ",", "diags"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"removeFirsts", "[", "ex_", "]"}], ":=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", "ex"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"groupedDiagrams", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"removeFirsts", ",", 
         RowBox[{"GatherBy", "[", 
          RowBox[{"identifierRep", ",", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "groupedDiagrams", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.932094360034514*^9, 3.9320945869988747`*^9}, {
   3.932094898582568*^9, 3.932094915857913*^9}, {3.932094949436166*^9, 
   3.932095163541043*^9}, {3.932095246899137*^9, 3.932095282235204*^9}, {
   3.9320953138126*^9, 3.932095715386652*^9}, {3.932095753137054*^9, 
   3.932095762935883*^9}, 3.932095817128111*^9, {3.932095851125954*^9, 
   3.932095910672982*^9}, {3.932096619485327*^9, 3.93209673954096*^9}, {
   3.932098243059964*^9, 3.932098315705807*^9}, 3.932108683236912*^9, 
   3.932108797687089*^9, {3.9321100921939087`*^9, 3.932110096810781*^9}, 
   3.932178043711693*^9, {3.932178081864294*^9, 3.932178103511478*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"e0663f80-523c-46ae-abb0-036375dcc9c5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Comparison of two diagrams", "Subsection",
 CellChangeTimes->{{3.9321801581024218`*^9, 
  3.932180161642061*^9}},ExpressionUUID->"5e43837a-9b61-4679-9938-\
3744e2f0f92a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IterateDiagram", "[", 
     RowBox[{"diag_", ",", "curPos_", ",", "entryIdx_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "curIdxs", ",", "exitIdx", ",", "nextPos", ",", "externalIndices", ",",
         "i", ",", "candidates"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Given", " ", "a", " ", "superindex", " ", "diagram", " ", "diag"}], 
        ",", " ", 
        RowBox[{"find", " ", "the", " ", "entry", " ", 
         RowBox[{"(", "curPos", ")"}], " ", "in", " ", "the", " ", 
         RowBox[{"diagram", ".", " ", "Then"}]}], ",", " ", 
        RowBox[{
        "remove", " ", "the", " ", "entryIdx", " ", "from", " ", "this", " ", 
         "entry"}], ",", " ", 
        RowBox[{"grab", " ", "the", " ", "next", " ", "index", " ", 
         RowBox[{"(", "exitIxd", ")"}]}], ",", "\[IndentingNewLine]", "  ", 
        RowBox[{
        "and", " ", "find", " ", "the", " ", "next", " ", "entry", " ", 
         RowBox[{"(", "nextPos", ")"}], " ", "which", " ", "is", " ", 
         "connected", " ", "by", " ", "this", " ", 
         RowBox[{"exitIdx", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"curIdxs", "=", 
        RowBox[{"curPos", "[", "\"\<indices\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "@", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"curIdxs", ",", "entryIdx"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<IterateDiagram: Invalid entryIdx\>\"", "]"}], 
          ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"externalIndices", "=", 
        RowBox[{"GetExternalIndices", "[", "diag", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<=", 
          RowBox[{"Length", "[", "externalIndices", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"curIdxs", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"curIdxs", ",", 
            RowBox[{"externalIndices", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"exitIdx", "=", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"curIdxs", ",", "entryIdx"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"candidates", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"diag", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"#", ",", "exitIdx", ",", "Infinity"}], "]"}], "&"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "candidates", "]"}], "!=", "2"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<IterateDiagram: Logic Error\>\"", "]"}], 
          ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"nextPos", "=", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"candidates", ",", "curPos"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"nextPos", ",", "exitIdx"}], "}"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CheckOneLoopDiagramIdentity", "[", 
    RowBox[{"indiag1_", ",", "indiag2_", ",", 
     RowBox[{"symmetryList_List", ":", 
      RowBox[{"{", "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "startPos", ",", "CheckIteration", ",", "entryIdx", ",", "diag1", ",", 
       "diag2", ",", "symmidx", ",", "sign"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"Given", " ", "two", " ", "one"}], "-", 
        RowBox[{"loop", " ", "diagrams"}]}], ",", " ", 
       RowBox[{"start", " ", "in", " ", "both", " ", "at", " ", "the", " ", 
        RowBox[{"regulator", ".", " ", "\[IndentingNewLine]", "Then"}]}], ",",
        " ", 
       RowBox[{"step", " ", "through", " ", "the", " ", "diagrams", " ", 
        RowBox[{"(", 
         RowBox[{"at", " ", "the", " ", "same", " ", "time"}], ")"}], " ", 
        "in", " ", "one", " ", "direction", " ", "and", " ", "compare", " ", 
        "whether", " ", "they", " ", "are", " ", 
        RowBox[{"identical", ".", "\[IndentingNewLine]", "Do"}], " ", "this", 
        " ", "several", " ", 
        RowBox[{"times", ":", " ", 
         RowBox[{"Both", " ", "directions", " ", "and", " ", "utilizing", " ", 
          RowBox[{"(", 
           RowBox[{"one", " ", "after", " ", "the", " ", "other"}], ")"}], 
          " ", "all", " ", "symmetry", " ", "transformations", " ", 
          RowBox[{
           RowBox[{"(", "symmetries", ")"}], ".", "\[IndentingNewLine]", 
           "If"}], " ", "any", " ", "of", " ", "these", " ", "procedures", 
          " ", "matches", " ", "perfectly"}]}]}], ",", " ", 
       RowBox[{"return", " ", 
        RowBox[{"True", ".", " ", "Otherwise"}]}], ",", " ", 
       RowBox[{"return", " ", "always", " ", 
        RowBox[{"False", "."}]}]}], " ", "\[IndentingNewLine]", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AssertIsOneLoop", "[", 
       RowBox[{"indiag1", ",", "\"\<CheckDiagramIdentity:\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AssertIsOneLoop", "[", 
       RowBox[{"indiag2", ",", "\"\<CheckDiagramIdentity:\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CheckIteration", "[", "entry_", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"curPos", ",", "curIdx", ",", "iter", ",", 
           RowBox[{"externalIndices", "=", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"objectIdentifiers", "=", 
            RowBox[{"{", 
             RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"curPos", "=", "startPos"}], ";", "\[IndentingNewLine]", 
          RowBox[{"curIdx", "=", "entry"}], ";", "\[IndentingNewLine]", 
          RowBox[{"iter", "=", "0"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"iter", "==", "0"}], "||", 
               RowBox[{"curPos", "!=", "startPos"}]}], ")"}], "&&", 
             RowBox[{"iter", "<", "50"}]}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"externalIndices", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "=", 
              RowBox[{"GetExternalIndices", "[", 
               RowBox[{"diag1", ",", 
                RowBox[{"curPos", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"externalIndices", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "=", 
              RowBox[{"GetExternalIndices", "[", 
               RowBox[{"diag2", ",", 
                RowBox[{"curPos", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"objectIdentifiers", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "=", 
              RowBox[{"GetObjectIdentifier", "[", 
               RowBox[{"curPos", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"objectIdentifiers", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "=", 
              RowBox[{"GetObjectIdentifier", "[", 
               RowBox[{"curPos", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"externalIndices", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "=!=", 
                RowBox[{"externalIndices", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"myEcho", "[", 
                 RowBox[{"\"\<Diff: \>\"", ",", 
                  RowBox[{"externalIndices", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< vs \>\"", ",", 
                  RowBox[{"externalIndices", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], ";", 
                RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"objectIdentifiers", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "=!=", 
                RowBox[{"objectIdentifiers", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"myEcho", "[", 
                 RowBox[{"\"\<Diff: \>\"", ",", 
                  RowBox[{"objectIdentifiers", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< vs \>\"", ",", 
                  RowBox[{"objectIdentifiers", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], ";", 
                RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"curPos", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"curIdx", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "=", 
              RowBox[{"IterateDiagram", "[", 
               RowBox[{"diag1", ",", 
                RowBox[{"curPos", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"curIdx", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"curPos", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"curIdx", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "=", 
              RowBox[{"IterateDiagram", "[", 
               RowBox[{"diag2", ",", 
                RowBox[{"curPos", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"curIdx", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"iter", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"iter", ">=", "50"}], ",", 
            RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "True", "]"}]}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"symmidx", "=", "0"}], ",", 
        RowBox[{"symmidx", "<=", 
         RowBox[{"Length", "[", "symmetryList", "]"}]}], ",", 
        RowBox[{"symmidx", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"diag1", "=", "indiag1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"symmidx", ">", "0"}], ",", 
           RowBox[{"diag2", "=", 
            RowBox[{"indiag2", "/.", 
             RowBox[{
              RowBox[{"symmetryList", "[", 
               RowBox[{"[", "symmidx", "]"}], "]"}], "[", "\"\<Rule\>\"", 
              "]"}]}]}], ",", 
           RowBox[{"diag2", "=", "indiag2"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"symmidx", ">", "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{"sign", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"symmetryList", "[", 
                 RowBox[{"[", "symmidx", "]"}], "]"}], "[", "\"\<Sign\>\"", 
                "]"}], "===", "Plus"}], ",", "1", ",", 
              RowBox[{"-", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"sign", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"startPos", "=", 
          RowBox[{"Map", "[", 
           RowBox[{"GetRegulatordot", ",", 
            RowBox[{"{", 
             RowBox[{"diag1", ",", "diag2"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"entryIdx", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "\"\<indices\>\"", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "startPos"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"entryIdx", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "==", 
            RowBox[{"entryIdx", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"CheckIteration", "[", "entryIdx", "]"}], ",", 
              RowBox[{"Return", "[", 
               RowBox[{"{", 
                RowBox[{"True", ",", "sign"}], "}"}], "]"}]}], "]"}], ";"}]}],
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"entryIdx", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"startPos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<indices\>\"", "]"}], 
           "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"entryIdx", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "==", 
            RowBox[{"entryIdx", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"CheckIteration", "[", "entryIdx", "]"}], ",", 
              RowBox[{"Return", "[", 
               RowBox[{"{", 
                RowBox[{"True", ",", "sign"}], "}"}], "]"}]}], "]"}], ";"}]}],
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"False", ",", "0"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.932098447635262*^9, 3.93209852143389*^9}, {
   3.932098739216712*^9, 3.932098779668036*^9}, {3.932098846763782*^9, 
   3.932098852743802*^9}, {3.932098999787578*^9, 3.932099297131016*^9}, {
   3.932108028717169*^9, 3.932108201596019*^9}, {3.932108624829434*^9, 
   3.932108807475878*^9}, {3.932108838489593*^9, 3.932109169409595*^9}, {
   3.932109212016754*^9, 3.932109344892893*^9}, {3.932109379710291*^9, 
   3.932109391918079*^9}, {3.9321094463395023`*^9, 3.932109659494432*^9}, {
   3.932109955423258*^9, 3.932110075897533*^9}, {3.932110108381598*^9, 
   3.932110145070335*^9}, {3.9321102537284193`*^9, 3.932110415030889*^9}, {
   3.932178710423568*^9, 3.932178736382427*^9}, {3.932179005808003*^9, 
   3.932179033992789*^9}, {3.93217907688321*^9, 3.932179138798719*^9}, {
   3.932180165533819*^9, 3.93218016568469*^9}, {3.932182552326752*^9, 
   3.932182584834584*^9}, {3.9321836063705587`*^9, 3.932183637563157*^9}, {
   3.932183694018772*^9, 3.932183901603105*^9}, {3.9321839756733913`*^9, 
   3.9321840490035677`*^9}, {3.932184092510416*^9, 3.932184104448115*^9}, 
   3.932184138111631*^9, 3.932184173322868*^9, {3.932184235141553*^9, 
   3.932184336949312*^9}, {3.932184367867301*^9, 3.932184450592682*^9}, {
   3.932228604050742*^9, 3.93222891989091*^9}, {3.932228965094552*^9, 
   3.932228977406414*^9}, {3.932236202324233*^9, 3.932236366840273*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"a6191ded-d4cf-4a87-8cba-d76cf1e3ac3f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Diagram set reduction", "Subsection",
 CellChangeTimes->{{3.932180176597583*^9, 
  3.932180181118745*^9}},ExpressionUUID->"e2b8d1ec-f601-4a4f-a55d-\
63c0dff7e637"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BuildSymmetryList", "[", 
    RowBox[{"symmetries_", ",", "derivativeList_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"procDerList", ",", "buildOneSymmetry"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "symmetries", "]"}], "=!=", "List"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Symmetries must be given as a list!\>\"", "]"}], 
         ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "symmetries", "]"}], "==", "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "derivativeList", "]"}], "==", "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"procDerList", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Head", "[", "#", "]"}], ",", 
            RowBox[{"List", "@@", "#"}]}], "}"}], "&"}], ",", 
         "derivativeList"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"buildOneSymmetry", "[", "sym_", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"valid", "=", "True"}], ",", "buildCycle", ",", "pairs"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"sym", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], "=!=", "Plus"}], "&&", 
             RowBox[{
              RowBox[{"sym", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], "=!=", "Minus"}]}], ",", 
            RowBox[{"valid", "=", "False"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"AnyTrue", "[", 
             RowBox[{
              RowBox[{"sym", "[", 
               RowBox[{"[", 
                RowBox[{";;", 
                 RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"Not", "[", 
                RowBox[{
                 RowBox[{"Head", "[", "#", "]"}], "===", "List"}], "]"}], 
               "&"}]}], "]"}], ",", 
            RowBox[{"valid", "=", "False"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pairs", "=", 
           RowBox[{"Subsets", "[", 
            RowBox[{
             RowBox[{"sym", "[", 
              RowBox[{"[", 
               RowBox[{";;", 
                RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"valid", "=", 
           RowBox[{"Not", "@", 
            RowBox[{"AnyTrue", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ContainsAny", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], ",", 
                "pairs"}], "]"}], ",", "Identity"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Not", "@", "valid"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"sym", ",", "\"\< is  not a valid symmetry!\>\""}], 
              "]"}], ";", 
             RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"buildCycle", "[", "cyc_", "]"}], ":=", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"cycvalid", "=", "True"}], ",", "numberRules", ",", 
               "idx", ",", "nextIdx"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"AnyTrue", "[", 
                 RowBox[{"cyc", ",", 
                  RowBox[{
                   RowBox[{"Not", "[", 
                    RowBox[{"IntegerQ", "[", "#", "]"}], "]"}], "&"}]}], 
                 "]"}], ",", 
                RowBox[{"cycvalid", "=", "False"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"AnyTrue", "[", 
                 RowBox[{"cyc", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", ">", 
                    RowBox[{"Length", "[", "derivativeList", "]"}]}], ")"}], "||", 
                    RowBox[{"(", 
                    RowBox[{"#", "<", "1"}], ")"}]}], "&"}]}], "]"}], ",", 
                RowBox[{"cycvalid", "=", "False"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Not", "@", "cycvalid"}], ",", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"cyc", ",", "\"\< is  not a valid cycle!\>\""}], 
                  "]"}], ";", 
                 RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"numberRules", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"idx", "=", "1"}], ",", 
                RowBox[{"idx", "<=", 
                 RowBox[{"Length", "[", "cyc", "]"}]}], ",", 
                RowBox[{"idx", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"nextIdx", "=", 
                  RowBox[{
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", "idx", ")"}], ",", 
                    RowBox[{"Length", "[", "cyc", "]"}]}], "]"}], "+", 
                   "1"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"numberRules", "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{"numberRules", ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"cyc", "[", 
                    RowBox[{"[", "idx", "]"}], "]"}], ",", 
                    RowBox[{"cyc", "[", 
                    RowBox[{"[", "nextIdx", "]"}], "]"}]}], "}"}], "}"}]}], 
                   "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"Return", "[", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"procDerList", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "->", 
                   RowBox[{"procDerList", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "&"}], 
                 ",", "numberRules"}], "]"}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"<|", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\"\<Rule\>\"", "->", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Map", "[", 
                RowBox[{"buildCycle", ",", 
                 RowBox[{"sym", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", 
                    RowBox[{"-", "2"}]}], "]"}], "]"}]}], "]"}], ",", "1"}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<Sign\>\"", "->", 
             RowBox[{"sym", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
           "|>"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Map", "[", 
       RowBox[{"buildOneSymmetry", ",", "symmetries"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9322339551217957`*^9, 3.932234123632927*^9}, {
  3.9322341641177597`*^9, 3.932234175374415*^9}, {3.932234823270101*^9, 
  3.932234947885703*^9}, {3.932235242772088*^9, 3.9322353815413017`*^9}, {
  3.932235415383548*^9, 3.932235873527635*^9}, {3.932235910478104*^9, 
  3.932236122016565*^9}, {3.932273061519869*^9, 3.932273664470671*^9}, {
  3.932273696855605*^9, 3.932273729198847*^9}, {3.932273765584857*^9, 
  3.932273787842926*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"316d6cba-bb29-44a6-915c-2927d2c427f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReduceIdenticalFlowDiagrams", "[", 
     RowBox[{"diags_", ",", 
      RowBox[{"derivativeList_", ":", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"symmetries_List", ":", 
       RowBox[{"{", "}"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "separatedGroups", ",", "reduceGroup", ",", "reducedGroups", ",", 
        "symmetryList"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AssertAllSuperIndexDiagrams", "[", 
        RowBox[{"diags", ",", "\"\<ReduceIdenticalFlowDiagrams\>\""}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"separatedGroups", "=", 
        RowBox[{"SeparateSuperIndexDiagramGroups", "[", "diags", "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"symmetryList", "=", 
        RowBox[{"BuildSymmetryList", "[", 
         RowBox[{"symmetries", ",", "derivativeList"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"reduceGroup", "[", "groupDiags_", "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "i", ",", "j", ",", "multiplicities", ",", "identitiesSigns", ",", 
            "signs", ",", "identities", ",", "prefactors", ",", "newDiags"}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"multiplicities", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"1", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "groupDiags", "]"}]}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "<=", 
              RowBox[{"Length", "[", "groupDiags", "]"}]}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"multiplicities", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ">", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"identitiesSigns", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"False", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"i", "+", "1"}], ",", 
                    RowBox[{"Length", "[", "groupDiags", "]"}]}], "}"}]}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"j", "=", 
                    RowBox[{"i", "+", "1"}]}], ",", 
                   RowBox[{"j", "<=", 
                    RowBox[{"Length", "[", "groupDiags", "]"}]}], ",", 
                   RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"multiplicities", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ">", "0"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"identitiesSigns", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "-", "i"}], "]"}], "]"}], "=", 
                    RowBox[{"CheckOneLoopDiagramIdentity", "[", 
                    RowBox[{
                    RowBox[{"groupDiags", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"groupDiags", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "symmetryList"}], 
                    "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"signs", "=", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "]"}], "&"}], 
                    ",", "identitiesSigns"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"identities", "=", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "1", ",", "0"}], 
                    "]"}], "&"}], ",", "identitiesSigns"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"identities", "=", 
                  RowBox[{"Join", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Total", "[", "signs", "]"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"-", "identities"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"multiplicities", "=", 
                  RowBox[{"multiplicities", "+", "identities"}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"prefactors", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\"\<Prefactor\>\"", "/.", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "groupDiags"}],
              "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"prefactors", "=", 
            RowBox[{"multiplicities", "*", "prefactors"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"newDiags", "=", "groupDiags"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "<=", 
              RowBox[{"Length", "[", "groupDiags", "]"}]}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"newDiags", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "=", 
               RowBox[{"(", 
                RowBox[{"\"\<Prefactor\>\"", "->", 
                 RowBox[{"prefactors", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"newDiags", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"newDiags", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\"\<Prefactor\>\"", "/.", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "=!=", 
                RowBox[{"{", "0", "}"}]}], "&"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "newDiags", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"reducedGroups", "=", 
        RowBox[{"ParallelMap", "[", 
         RowBox[{"reduceGroup", ",", "separatedGroups"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"reducedGroups", ",", "1"}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.9321781455667*^9, 3.932178365313039*^9}, {
   3.932178412806164*^9, 3.932178449096587*^9}, {3.932178482741375*^9, 
   3.9321785221284924`*^9}, {3.932178562075142*^9, 3.932178628478548*^9}, {
   3.9321786923520393`*^9, 3.932178696378098*^9}, {3.932178756081934*^9, 
   3.932178912956685*^9}, 3.932178981988553*^9, {3.9321791521734943`*^9, 
   3.932179156714473*^9}, {3.932179196749273*^9, 3.932179237445931*^9}, {
   3.932179404415722*^9, 3.93217945043134*^9}, {3.9321794906169987`*^9, 
   3.932179761713379*^9}, {3.932179798078613*^9, 3.9321798510231123`*^9}, {
   3.932179932674667*^9, 3.9321800929647007`*^9}, 3.932180189829148*^9, {
   3.932182463936803*^9, 3.932182465144521*^9}, {3.932182507357049*^9, 
   3.932182545899003*^9}, 3.9321841296023197`*^9, {3.932184822735402*^9, 
   3.932184823732896*^9}, {3.9322340803434553`*^9, 3.93223409134932*^9}, {
   3.9322361522718687`*^9, 3.9322361892670703`*^9}, {3.93223645290021*^9, 
   3.932236533991878*^9}, {3.932272442478164*^9, 3.932272458679203*^9}, {
   3.93227271574791*^9, 3.932272748167962*^9}, {3.932272828693186*^9, 
   3.932272970462279*^9}, {3.932273003623803*^9, 3.932273004585738*^9}, {
   3.932273035926251*^9, 3.932273042066736*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"ab592be8-0954-4254-b56b-6f7146afe952"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Diagramsqbqqbq", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Import", "[", "\"\<./diagramsqbqqbq.m\>\"", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"#", ",", "\[CapitalPi]", ",", "Infinity"}], "]"}], "]"}], "&&", 
       RowBox[{"Not", "[", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"#", ",", "\[Sigma]", ",", "Infinity"}], "]"}], "]"}]}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DerivativeListqbqqbq", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"qb", "[", 
      RowBox[{"p4", ",", 
       RowBox[{"{", 
        RowBox[{"d4", ",", "c4", ",", "f4"}], "}"}]}], "]"}], ",", 
     RowBox[{"q", "[", 
      RowBox[{"p3", ",", 
       RowBox[{"{", 
        RowBox[{"d3", ",", "c3", ",", "f3"}], "}"}]}], "]"}], ",", 
     RowBox[{"qb", "[", 
      RowBox[{"p2", ",", 
       RowBox[{"{", 
        RowBox[{"d2", ",", "c2", ",", "f2"}], "}"}]}], "]"}], ",", 
     RowBox[{"q", "[", 
      RowBox[{"p1", ",", 
       RowBox[{"{", 
        RowBox[{"p1", ",", "c1", ",", "f1"}], "}"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Diagramsqbqqbq", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"symm", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}], ",", "Plus"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "4"}], "}"}], ",", "Plus"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "4"}], "}"}], ",", "Plus"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"ReduceIdenticalFlowDiagrams", "[", 
    RowBox[{"Diagramsqbqqbq", ",", "DerivativeListqbqqbq", ",", "symm"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"PlotSuperindexDiagrams", "[", 
  RowBox[{"res", ",", "SetupfRG"}], "]"}]}], "Input",
 CellChangeTimes->{{3.932272467970972*^9, 3.932272491897654*^9}, {
   3.932272578275216*^9, 3.932272629513835*^9}, {3.93227266350073*^9, 
   3.932272682849394*^9}, 3.932273026706111*^9, {3.932273795349463*^9, 
   3.932273866574822*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"dd232756-644a-4055-8c7c-ca293ec9c8ea"],

Cell[BoxData["32"], "Output",
 CellChangeTimes->{
  3.932272445156385*^9, {3.932272485704888*^9, 3.932272492598536*^9}, {
   3.932272603671554*^9, 3.932272684352434*^9}, 3.932272719933564*^9, 
   3.93227275052169*^9, 3.932272979312724*^9, {3.932273016549967*^9, 
   3.93227304601122*^9}, 3.932273817381724*^9, 3.932273871580986*^9, 
   3.932273910138567*^9, 3.932311643941915*^9, 3.93231210415364*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"72ee4596-699c-4f4a-80b1-797835f570bd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fields \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"A", ",", "A"}], "}"}], 
   "\[InvisibleSpace]", "\<\" not found!\"\>"}],
  SequenceForm["fields ", {$CellContext`A, $CellContext`A}, " not found!"],
  Editable->False]], "Print",
 CellChangeTimes->{3.932311644237537*^9, 3.932312104427424*^9},
 CellLabel->
  "During evaluation of \
In[66]:=",ExpressionUUID->"40d571d2-f0cd-4568-802a-4d48943caf37"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.932272445156385*^9, {3.932272485704888*^9, 3.932272492598536*^9}, {
   3.932272603671554*^9, 3.932272684352434*^9}, 3.932272719933564*^9, 
   3.93227275052169*^9, 3.932272979312724*^9, {3.932273016549967*^9, 
   3.93227304601122*^9}, 3.932273817381724*^9, 3.932273871580986*^9, 
   3.932273910138567*^9, 3.932311643941915*^9, 3.9323121044280367`*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"e8f97605-18c4-4884-8952-0f35efe5dfbd"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Diagram drawing", "Section",
 CellChangeTimes->{{3.93221911591842*^9, 
  3.932219119839135*^9}},ExpressionUUID->"6a3fc747-6b04-4adb-bf17-\
12782a1349d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetEdgeRule", "[", 
    RowBox[{"obj_", ",", "fields_", ",", "setup_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fermions", ",", "bosons", ",", "sel"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "obj", "]"}], "!=", 
          RowBox[{"Length", "[", "fields", "]"}]}], "||", 
         RowBox[{
          RowBox[{"Length", "[", "obj", "]"}], "!=", "2"}]}], ",", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Mismatch!\>\"", "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"fermions", "=", 
       RowBox[{"GetFermionPairs", "[", "setup", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bosons", "=", 
       RowBox[{"GetBosons", "[", "setup", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"fermions", ",", 
           RowBox[{"fields", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "Infinity"}], "]"}], "&&", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"fermions", ",", 
           RowBox[{"fields", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "Infinity"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sel", "=", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"fermions", ",", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"#", ",", 
                RowBox[{"fields", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "Infinity"}], "]"}], 
              "&"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"fields", "===", "sel"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{
             RowBox[{"obj", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "->", 
             RowBox[{"obj", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Return", "[", 
             RowBox[{
              RowBox[{"obj", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "->", 
              RowBox[{"obj", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"bosons", ",", 
           RowBox[{"fields", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "Infinity"}], "]"}], "&&", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"bosons", ",", 
           RowBox[{"fields", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "Infinity"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"obj", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<->", 
          RowBox[{"obj", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<fields \>\"", ",", "fields", ",", "\"\< not found!\>\""}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.932220245927902*^9, 3.93222026241581*^9}, {
  3.932220756703475*^9, 3.93222138145538*^9}, {3.932222427022163*^9, 
  3.932222533690036*^9}, {3.93227569458318*^9, 3.9322756958102694`*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"4b7e9a1c-bcea-4f28-a801-f32589838af8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeEdgeStyle", "[", 
    RowBox[{"style_", ",", "setup_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "corStyle", ",", "havePairs", ",", "allPairs", ",", "missingPairs"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"corStyle", "=", 
       RowBox[{"style", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"a_", "[", 
            RowBox[{"c_", ",", "d_"}], "]"}], "/;", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"a", "===", "Rule"}], "&&", 
            RowBox[{
             RowBox[{"Head", "[", "c", "]"}], "=!=", "List"}]}]}], ":>", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Sort", "[", 
            RowBox[{"{", 
             RowBox[{"c", ",", 
              RowBox[{"GetPartnerField", "[", 
               RowBox[{"c", ",", "setup"}], "]"}]}], "}"}], "]"}], "->", 
           "d"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"corStyle", "=", 
       RowBox[{"corStyle", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"a_", "[", 
            RowBox[{
             RowBox[{"{", "c__", "}"}], ",", "d_"}], "]"}], "/;", 
           RowBox[{"a", "===", "Rule"}]}], ":>", 
          RowBox[{
           RowBox[{"Sort", "[", 
            RowBox[{"{", "c", "}"}], "]"}], "->", "d"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"havePairs", "=", 
       RowBox[{"corStyle", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"a_", "[", 
            RowBox[{
             RowBox[{"{", "c__", "}"}], ",", "d_"}], "]"}], "/;", 
           RowBox[{"a", "===", "Rule"}]}], ":>", 
          RowBox[{"{", "c", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"allPairs", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", ",", "#"}], "}"}], "&"}], ",", 
           RowBox[{"GetBosons", "[", "setup", "]"}]}], "]"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{"Sort", ",", 
           RowBox[{"GetFermionPairs", "[", "setup", "]"}]}], "]"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"missingPairs", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"allPairs", ",", 
         RowBox[{"Alternatives", "@@", "havePairs"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"corStyle", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"corStyle", ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"missingPairs", "->", 
           RowBox[{
            RowBox[{"ColorData", "[", 
             RowBox[{"97", ",", "\"\<ColorList\>\""}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", 
              RowBox[{"Length", "[", "missingPairs", "]"}]}], "]"}], "]"}]}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "corStyle", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.93222598905088*^9, 3.932226152225779*^9}, {
   3.932226257397224*^9, 3.932226263968811*^9}, 3.932226423455982*^9, {
   3.932226524389546*^9, 3.932226579306307*^9}, 3.932227244378387*^9},
 CellLabel->"In[73]:=",ExpressionUUID->"cf322f7c-f7c3-4539-b6aa-ac3de26accbf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PlotSuperindexDiagram", "[", 
    RowBox[{"diag_", ",", "setup_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ShowEdgeLabels", ",", "EdgeStyle", ",", "\[IndentingNewLine]", 
       "transformedDiag", ",", "vertices", ",", "edges", ",", "prefactor", 
       ",", "\[IndentingNewLine]", "externalLegs", ",", "externalIndices", 
       ",", "idx", ",", "field", ",", "partnerField", ",", "outerIdx", ",", 
       "externalLeg", ",", "\[IndentingNewLine]", "regulatorVertex", ",", 
       "curVertex", ",", "rules", ",", "corStyle", ",", "cross", ",", 
       "\[IndentingNewLine]", "explVertices", ",", "explEdges", ",", 
       "vertexShapes", ",", "vertexLabels", ",", "edgeLabels"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AssertIsSuperIndexDiagram", "[", "diag", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"EdgeStyle", "=", 
       RowBox[{"OptionValue", "[", "\"\<EdgeStyle\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ShowEdgeLabels", "=", 
       RowBox[{"OptionValue", "[", "\"\<ShowEdgeLabels\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"transformedDiag", "=", 
       RowBox[{"Map", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "#", "]"}], "===", "Association"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", "\"\<type\>\"", "]"}], "==", 
               "\"\<Propagator\>\""}], ",", "\[IndentingNewLine]", 
              RowBox[{"<|", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\"\<Rule\>\"", "->", 
                 RowBox[{"GetEdgeRule", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<indices\>\"", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", "\"\<indices\>\"", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<indices\>\"", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", "\"\<indices\>\"", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
                   "setup"}], "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<Style\>\"", "->", 
                 RowBox[{"Sort", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<indices\>\"", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", "\"\<indices\>\"", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}]}]}],
                "\[IndentingNewLine]", "|>"}], ",", "\[IndentingNewLine]", 
              RowBox[{"<|", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\"\<Vertex\>\"", "->", 
                 RowBox[{
                  RowBox[{"#", "[", "\"\<indices\>\"", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<Style\>\"", "->", 
                 RowBox[{"#", "[", "\"\<type\>\"", "]"}]}]}], 
               "\[IndentingNewLine]", "|>"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "#"}], "]"}], "&"}], "\[IndentingNewLine]",
          ",", "diag"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"vertices", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"transformedDiag", ",", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Keys", "[", "#", "]"}], ",", "\"\<Vertex\>\"", ",", 
            "Infinity"}], "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"edges", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"transformedDiag", ",", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Keys", "[", "#", "]"}], ",", "\"\<Rule\>\"", ",", 
            "Infinity"}], "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"prefactor", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\"\<Prefactor\>\"", "/.", 
          RowBox[{"transformedDiag", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"externalLegs", "=", 
       RowBox[{"GetExternalIndices", "[", "diag", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"externalIndices", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"idx", "=", "1"}], ",", 
        RowBox[{"idx", "<=", 
         RowBox[{"Length", "[", "externalLegs", "]"}]}], ",", 
        RowBox[{"idx", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"field", "=", 
          RowBox[{"externalLegs", "[", 
           RowBox[{"[", 
            RowBox[{"idx", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"partnerField", "=", 
          RowBox[{"GetPartnerField", "[", 
           RowBox[{"field", ",", "setup"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"outerIdx", "=", 
          RowBox[{"Unique", "[", "externalLeg", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"externalIndices", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"externalIndices", ",", 
            RowBox[{"{", "outerIdx", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vertices", "=", 
          RowBox[{"vertices", "\[Union]", 
           RowBox[{"{", 
            RowBox[{"<|", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\"\<Vertex\>\"", "->", 
               RowBox[{"{", 
                RowBox[{"{", "outerIdx", "}"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<Style\>\"", "\[Rule]", 
               RowBox[{"externalLeg", "[", "field", "]"}]}]}], 
             "\[IndentingNewLine]", "|>"}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"edges", "=", 
          RowBox[{"edges", "\[Union]", 
           RowBox[{"{", 
            RowBox[{"\[LeftAssociation]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\"\<Rule\>\"", "\[Rule]", 
               RowBox[{"GetEdgeRule", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"externalLegs", "[", 
                    RowBox[{"[", 
                    RowBox[{"idx", ",", "2"}], "]"}], "]"}], ",", 
                   RowBox[{"{", "outerIdx", "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"field", ",", "partnerField"}], "}"}], ",", 
                 "setup"}], "]"}]}], ",", 
              RowBox[{"\"\<Style\>\"", "\[Rule]", 
               RowBox[{"Sort", "[", 
                RowBox[{"{", 
                 RowBox[{"field", ",", "partnerField"}], "}"}], "]"}]}]}], 
             "\[IndentingNewLine]", "\[RightAssociation]"}], "}"}]}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"regulatorVertex", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"idx", "=", "1"}], ",", 
        RowBox[{"idx", "<=", 
         RowBox[{"Length", "[", "vertices", "]"}]}], ",", 
        RowBox[{"idx", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"curVertex", "=", 
          RowBox[{
           RowBox[{"vertices", "[", 
            RowBox[{"[", "idx", "]"}], "]"}], "[", "\"\<Vertex\>\"", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "curVertex", "]"}], ">", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rules", "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "->", 
                 RowBox[{"curVertex", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", 
               RowBox[{"curVertex", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ";;"}], "]"}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"vertices", "=", 
             RowBox[{"vertices", "/.", "rules"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"edges", "=", 
             RowBox[{"edges", "/.", "rules"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"vertices", "[", 
           RowBox[{"[", "idx", "]"}], "]"}], "=", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<Vertex\>\"", "->", 
             RowBox[{
              RowBox[{
               RowBox[{"vertices", "[", 
                RowBox[{"[", "idx", "]"}], "]"}], "[", "\"\<Vertex\>\"", 
               "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"\"\<Style\>\"", "->", 
             RowBox[{
              RowBox[{"vertices", "[", 
               RowBox[{"[", "idx", "]"}], "]"}], "[", "\"\<Style\>\"", 
              "]"}]}]}], "|>"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"vertices", "[", 
              RowBox[{"[", "idx", "]"}], "]"}], "[", "\"\<Style\>\"", "]"}], 
            "==", "\"\<Regulatordot\>\""}], ",", 
           RowBox[{"regulatorVertex", "=", 
            RowBox[{
             RowBox[{"vertices", "[", 
              RowBox[{"[", "idx", "]"}], "]"}], "[", "\"\<Vertex\>\"", 
             "]"}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"corStyle", "=", 
       RowBox[{"MakeEdgeStyle", "[", 
        RowBox[{"EdgeStyle", ",", "setup"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"cross", "[", "r_", "]"}], " ", ":=", " ", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", " ", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"r", " ", "/", " ", 
                RowBox[{"Sqrt", "[", "2", "]"}]}], ",", " ", 
               RowBox[{"r", " ", "/", " ", 
                RowBox[{"Sqrt", "[", "2", "]"}]}]}], "\n", "            ", 
              "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "r"}], " ", "/", " ", 
                RowBox[{"Sqrt", "[", "2", "]"}]}], ",", " ", 
               RowBox[{
                RowBox[{"-", "r"}], " ", "/", " ", 
                RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}]}], "}"}], "]"}], 
          ",", " ", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"r", " ", "/", " ", 
                RowBox[{"Sqrt", "[", "2", "]"}]}], ",", " ", 
               RowBox[{
                RowBox[{"-", "r"}], " ", "/", " ", 
                RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}], ",", "\n", 
             "             ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "r"}], " ", "/", " ", 
                RowBox[{"Sqrt", "[", "2", "]"}]}], ",", " ", 
               RowBox[{"r", " ", "/", " ", 
                RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}]}], "}"}], "]"}], 
          ",", " ", 
          RowBox[{"Circle", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", "r"}], "]"}]}], 
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"explVertices", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "\"\<Vertex\>\"", "]"}], "&"}], ",", "vertices"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vertexShapes", "=", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"regulatorVertex", "->", 
          RowBox[{"cross", "[", "1", "]"}]}], "}"}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vertexLabels", "=", 
       RowBox[{"Map", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", "\"\<Vertex\>\"", "]"}], "->", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "[", "\"\<Style\>\"", "]"}], "/.", 
             RowBox[{
              RowBox[{"a_", "[", "b_", "]"}], ":>", "b"}]}], ")"}]}], "&"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"Select", "[", 
          RowBox[{"vertices", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", 
              RowBox[{"#", "[", "\"\<Style\>\"", "]"}], "]"}], "===", 
             "externalLeg"}], "&"}]}], "]"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"explEdges", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"#", "[", "\"\<Rule\>\"", "]"}], ",", 
            RowBox[{
             RowBox[{"#", "[", "\"\<Style\>\"", "]"}], "/.", "corStyle"}]}], 
           "]"}], "&"}], ",", "edges"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"edgeLabels", "=", 
       RowBox[{"If", "[", 
        RowBox[{"ShowEdgeLabels", ",", "\[IndentingNewLine]", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "\"\<Rule\>\"", "]"}], "->", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{
                RowBox[{"#", "[", "\"\<Style\>\"", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{
                RowBox[{"#", "[", "\"\<Style\>\"", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "&"}], ",", 
           "edges"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"prefactor", ",", "\[IndentingNewLine]", 
         RowBox[{"Graph", "[", 
          RowBox[{
          "explVertices", ",", "explEdges", ",", "\[IndentingNewLine]", 
           RowBox[{"VertexShape", "->", "vertexShapes"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"VertexLabels", "->", "vertexLabels"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"VertexSize", " ", "->", " ", 
            RowBox[{"{", 
             RowBox[{"regulatorVertex", " ", "->", " ", "Medium"}], "}"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"EdgeLabels", "->", "edgeLabels"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PlotSuperindexDiagram", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<ShowEdgeLabels\>\"", "->", "False"}], ",", 
     RowBox[{"\"\<EdgeStyle\>\"", "->", 
      RowBox[{"{", "}"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotSuperindexDiagrams", "[", 
    RowBox[{"diags_List", ",", "setup_", ",", "a___"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PlotSuperindexDiagram", "[", 
         RowBox[{"#", ",", "setup", ",", "a"}], "]"}], "&"}], ",", "diags"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.932219378410387*^9, 3.932219401729917*^9}, {
   3.93221953711088*^9, 3.932219765506566*^9}, {3.9322197975555973`*^9, 
   3.932219915119028*^9}, {3.932219948668961*^9, 3.932220037797441*^9}, {
   3.932220069658774*^9, 3.932220137491227*^9}, {3.9322201763651667`*^9, 
   3.9322201929662743`*^9}, {3.932220271925158*^9, 3.932220449223991*^9}, {
   3.932220485232848*^9, 3.93222054677315*^9}, {3.932220624210702*^9, 
   3.932220682865519*^9}, {3.932222567077874*^9, 3.9322226499775*^9}, {
   3.932222690915005*^9, 3.932223017840479*^9}, {3.932223051771912*^9, 
   3.93222311557379*^9}, {3.9322231613609743`*^9, 3.932223193688582*^9}, 
   3.932223228399946*^9, {3.932223263351158*^9, 3.932223327794436*^9}, {
   3.932223373121641*^9, 3.93222340385354*^9}, {3.932223508763092*^9, 
   3.932223745204699*^9}, {3.932223823122708*^9, 3.932223945621051*^9}, {
   3.9322240032179317`*^9, 3.932224413151188*^9}, {3.932224477128537*^9, 
   3.9322245624636717`*^9}, {3.932224611895343*^9, 3.932224746549252*^9}, {
   3.932224788585619*^9, 3.93222510682532*^9}, {3.932225153292159*^9, 
   3.932225313526149*^9}, {3.932225356970504*^9, 3.9322253683994627`*^9}, {
   3.9322254419062223`*^9, 3.932225766512817*^9}, {3.9322258658791027`*^9, 
   3.932225979474358*^9}, {3.932226584137904*^9, 3.932226593179884*^9}, {
   3.932226639139077*^9, 3.9322270766431427`*^9}, {3.932227127933094*^9, 
   3.932227347459678*^9}, {3.932227389012507*^9, 3.932227462375696*^9}, 
   3.932227663126498*^9, {3.932227999039544*^9, 3.932228015763687*^9}, 
   3.932233340123426*^9},
 CellLabel->"In[74]:=",ExpressionUUID->"13ef92fe-9686-4a4f-85bb-34e9d5213ced"]
}, Closed]],

Cell[CellGroupData[{

Cell["Momentum  routing", "Section",
 CellChangeTimes->{{3.932275681178563*^9, 
  3.9322756855221977`*^9}},ExpressionUUID->"65e89f7f-dd30-4576-9309-\
12b8ccc6e19b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReduceDiagramToMomenta", "[", 
   RowBox[{"diag_", ",", "momenta_"}], "]"}], ":=", 
  RowBox[{"diag", "/.", 
   RowBox[{
    RowBox[{"Cor_", "[", 
     RowBox[{"{", "k___", "}"}], "]"}], ":>", 
    RowBox[{"Cor", "@@", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"{", "k", "}"}], ",", 
       RowBox[{
        RowBox[{"ContainsAny", "[", 
         RowBox[{
          RowBox[{"GetAllSymbols", "[", "#", "]"}], ",", "momenta"}], "]"}], 
        "&"}]}], "]"}]}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9323106833232603`*^9, 3.9323106844333973`*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"25b57239-9d9a-403d-bc72-290378d91941"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RerouteFermionicMomenta", "[", 
    RowBox[{
     RowBox[{"diag_", "/;", 
      RowBox[{
       RowBox[{"Head", "[", "diag", "]"}], "=!=", "List"}]}], ",", "setup_", 
     ",", "derivativeList_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "loopMomentum", ",", "fermions", ",", "antifermions", ",", "bosons", 
       ",", "allMomenta", ",", "fermionMomenta", ",", "antifermionMomenta", 
       ",", "\[IndentingNewLine]", "reducedDiagram", ",", 
       "\[IndentingNewLine]", "fermionicPropNames", ",", "bosonicPropNames", 
       ",", "fermionicProps", ",", "bosonicProps", ",", "\[IndentingNewLine]",
        "nonFermMomentum", ",", "momentumConservation", ",", 
       "\[IndentingNewLine]", "fermionArgs", ",", "bosonArgs", ",", "idx", 
       ",", "problems", ",", "nothing", ",", "dummyMom"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AssertIsFullDiagram", "[", 
       RowBox[{"diag", ",", "\"\<RerouteFermionicMomenta:\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"loopMomentum", "=", "Global`q"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"fermions", "=", 
       RowBox[{"GetFermions", "[", "setup", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"antifermions", "=", 
       RowBox[{"GetAntiFermions", "[", "setup", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bosons", "=", 
       RowBox[{"GetBosons", "[", "setup", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"allMomenta", "=", 
       RowBox[{"derivativeList", "//.", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"a_", ",", "___"}], "]"}], ":>", "a"}], "&"}], ",", 
          RowBox[{
          "fermions", "\[Union]", "antifermions", "\[Union]", "bosons"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fermionMomenta", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"derivativeList", ",", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"fermions", ",", 
             RowBox[{"Head", "[", "#", "]"}]}], "]"}], "&"}]}], "]"}], "//.", 
        
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"a_", ",", "___"}], "]"}], ":>", "a"}], "&"}], ",", 
          "fermions"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"antifermionMomenta", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"derivativeList", ",", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"antifermions", ",", 
             RowBox[{"Head", "[", "#", "]"}]}], "]"}], "&"}]}], "]"}], "//.", 
        
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"a_", ",", "___"}], "]"}], ":>", "a"}], "&"}], ",", 
          "antifermions"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "fermionMomenta", "]"}], "!=", 
         RowBox[{"Length", "[", "antifermionMomenta", "]"}]}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Diagram has not the same number of fermions as antifermions!\>\
\"", "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"reducedDiagram", "=", 
       RowBox[{"ReduceDiagramToMomenta", "[", 
        RowBox[{"diag", ",", 
         RowBox[{
          RowBox[{"{", "allMomenta", "}"}], "\[Union]", 
          RowBox[{"{", "loopMomentum", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fermionicPropNames", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Symbol", "[", 
           RowBox[{"\"\<G\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "&"}], ",", 
         RowBox[{"GetFermionPairs", "[", "setup", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bosonicPropNames", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Symbol", "[", 
           RowBox[{"\"\<G\>\"", "<>", 
            RowBox[{"ToString", "[", "#", "]"}], "<>", 
            RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], ",", 
         RowBox[{"GetBosons", "[", "setup", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fermionicProps", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Union", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"reducedDiagram", ",", "#", ",", "Infinity"}], "]"}], 
            "&"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "__", "]"}], "&"}], ",", 
             "fermionicPropNames"}], "]"}]}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bosonicProps", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Union", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"reducedDiagram", ",", "#", ",", "Infinity"}], "]"}], 
            "&"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "__", "]"}], "&"}], ",", "bosonicPropNames"}],
             "]"}]}], "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"nonFermMomentum", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"allMomenta", ",", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"fermionMomenta", "\[Union]", "antifermionMomenta"}], 
             ",", "#", ",", "Infinity"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"momentumConservation", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "nonFermMomentum", "]"}], "==", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"allMomenta", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Total", "[", "allMomenta", "]"}]}], "+", 
           RowBox[{"allMomenta", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nonFermMomentum", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Total", "[", "allMomenta", "]"}]}], "+", 
           RowBox[{"nonFermMomentum", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "If", " ", "there", " ", "are", " ", "no", " ", "boson", " ", 
         "propagators"}], ",", " ", 
        RowBox[{"there", " ", "is", " ", "nothing", " ", "to", " ", "do"}], 
        ",", " ", 
        RowBox[{
         RowBox[{"except", " ", "to", " ", "mark", " ", "the", " ", "loop"}], 
         "-", 
         RowBox[{"momentum", " ", "with", " ", "an", " ", "f", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
            "as", " ", "it", " ", "is", " ", "a", " ", "closed", " ", 
             "fermion", " ", "loop"}], ")"}], "!"}]}]}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "bosonicProps", "]"}], "==", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"diag", "/.", 
           RowBox[{"loopMomentum", "->", 
            RowBox[{"Symbol", "[", 
             RowBox[{
              RowBox[{"ToString", "[", "loopMomentum", "]"}], "<>", 
              "\"\<f\>\""}], "]"}]}]}], "/.", "momentumConservation"}], 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Reduce", " ", "further", " ", "by", " ", "getting", " ", "rid", " ", 
        "of", " ", "field", " ", "information"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"fermionArgs", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"fermionicProps", "/.", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "m___", "]"}], ":>", 
             RowBox[{"{", "m", "}"}]}], "&"}], ",", "fermionicPropNames"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bosonArgs", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"bosonicProps", "/.", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "m___", "]"}], ":>", 
             RowBox[{"{", "m", "}"}]}], "&"}], ",", "bosonicPropNames"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "If", " ", "a", " ", "femion", " ", "momentum", " ", "appears", " ", 
         "in", " ", "a", " ", "boson", " ", "propagator"}], ",", " ", 
        RowBox[{"this", " ", "needs", " ", "to", " ", "be", " ", "fixed"}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"problems", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"idx", "=", "1"}], ",", 
        RowBox[{"idx", "<=", 
         RowBox[{"Length", "[", "fermionMomenta", "]"}]}], ",", 
        RowBox[{"idx", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"problems", "=", 
          RowBox[{"Union", "[", 
           RowBox[{"problems", ",", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"bosonArgs", "/.", "momentumConservation"}], ",", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"fermionMomenta", "[", 
                  RowBox[{"[", "idx", "]"}], "]"}], ",", "Infinity"}], "]"}], 
               "&"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"problems", "=", 
          RowBox[{"Union", "[", 
           RowBox[{"problems", ",", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"bosonArgs", "/.", "momentumConservation"}], ",", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"antifermionMomenta", "[", 
                  RowBox[{"[", "idx", "]"}], "]"}], ",", "Infinity"}], "]"}], 
               "&"}]}], "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Fix", " ", "the", " ", "problems", " ", "by", " ", "doing", " ", 
        "shifts", " ", "of", " ", "the", " ", "loop", " ", "momentum"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "problems", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "There", " ", "may", " ", "be", " ", "no", " ", "problem", " ", 
           "at", " ", 
           RowBox[{"all", ":", " ", 
            RowBox[{
            "If", " ", "everywhere", " ", "the", " ", "same", " ", "number", 
             " ", "of", " ", "fermion", " ", "and", " ", "antifermions", " ", 
             "enter"}]}]}], ",", " ", 
          RowBox[{"we", " ", "do", " ", "not", " ", "need", " ", "to", " ", 
           RowBox[{"reroute", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Not", "@", 
            RowBox[{"MemberQ", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"problems", "/.", "momentumConservation"}], "/.", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "->", "dummyMom"}], "&"}], ",", 
                   "fermionMomenta"}], "]"}]}], "/.", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "->", 
                    RowBox[{"-", "dummyMom"}]}], "&"}], ",", 
                  "antifermionMomenta"}], "]"}]}], "//", "Simplify"}], ",", 
              "dummyMom", ",", "Infinity"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"diag", "/.", "momentumConservation"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"idx", "=", "1"}], ",", 
           RowBox[{"idx", "<=", 
            RowBox[{"Length", "[", "fermionMomenta", "]"}]}], ",", 
           RowBox[{"idx", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Not", "@", 
               RowBox[{"MemberQ", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"problems", "/.", 
                    RowBox[{"loopMomentum", "->", 
                    RowBox[{"loopMomentum", "-", 
                    RowBox[{"fermionMomenta", "[", 
                    RowBox[{"[", "idx", "]"}], "]"}]}]}]}], "/.", 
                    "momentumConservation"}], "/.", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "->", "dummyMom"}], "&"}], ",", 
                    "fermionMomenta"}], "]"}]}], "/.", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "->", 
                    RowBox[{"-", "dummyMom"}]}], "&"}], ",", 
                    "antifermionMomenta"}], "]"}]}], "//", "Simplify"}], ",", 
                 "dummyMom", ",", "Infinity"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Return", "[", 
               RowBox[{
                RowBox[{"diag", "/.", 
                 RowBox[{"{", 
                  RowBox[{"loopMomentum", "->", 
                   RowBox[{"loopMomentum", "-", 
                    RowBox[{"fermionMomenta", "[", 
                    RowBox[{"[", "idx", "]"}], "]"}]}]}], "}"}]}], "/.", 
                "momentumConservation"}], "]"}]}], "\[IndentingNewLine]", 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Not", "@", 
               RowBox[{"MemberQ", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"problems", "/.", 
                    RowBox[{"loopMomentum", "->", 
                    RowBox[{"loopMomentum", "-", 
                    RowBox[{"antifermionMomenta", "[", 
                    RowBox[{"[", "idx", "]"}], "]"}]}]}]}], "/.", 
                    "momentumConservation"}], "/.", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "->", "dummyMom"}], "&"}], ",", 
                    "fermionMomenta"}], "]"}]}], "/.", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "->", 
                    RowBox[{"-", "dummyMom"}]}], "&"}], ",", 
                    "antifermionMomenta"}], "]"}]}], "//", "Simplify"}], ",", 
                 "dummyMom", ",", "Infinity"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Return", "[", 
               RowBox[{
                RowBox[{"diag", "/.", 
                 RowBox[{"{", 
                  RowBox[{"loopMomentum", "->", 
                   RowBox[{"loopMomentum", "-", 
                    RowBox[{"antifermionMomenta", "[", 
                    RowBox[{"[", "idx", "]"}], "]"}]}]}], "}"}]}], "/.", 
                "momentumConservation"}], "]"}]}], "\[IndentingNewLine]", 
             "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Return", "[", 
          RowBox[{"diag", "/.", "momentumConservation"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Routing momenta failed! Unsolved problems: \>\"", ",", 
        "problems"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RerouteFermionicMomenta", "[", 
    RowBox[{"diags_List", ",", "setup_", ",", "derivativeList_"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RerouteFermionicMomenta", "[", 
       RowBox[{"#", ",", "setup", ",", "derivativeList"}], "]"}], "&"}], ",", 
     "diags"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.932277378520407*^9, 3.9322773871769648`*^9}, {
   3.932277532420947*^9, 3.932277548575757*^9}, {3.932278362328141*^9, 
   3.932278374333906*^9}, {3.9322784293929844`*^9, 3.932278433873394*^9}, {
   3.9322784935602293`*^9, 3.9322784940360394`*^9}, {3.932278537254224*^9, 
   3.93227857078154*^9}, {3.9322786306524053`*^9, 3.9322786698157444`*^9}, {
   3.932278739017458*^9, 3.9322787820924397`*^9}, {3.932278851968617*^9, 
   3.9322789094498653`*^9}, {3.932278967201881*^9, 3.932278992421669*^9}, {
   3.932279483293943*^9, 3.932279485368431*^9}, {3.932281419973871*^9, 
   3.932281443325571*^9}, {3.9322814736103373`*^9, 3.932281636765746*^9}, {
   3.932281669468672*^9, 3.932281891142672*^9}, {3.932282143682105*^9, 
   3.9322822046496687`*^9}, {3.932309990013702*^9, 3.932310035387283*^9}, {
   3.932310929567078*^9, 3.932310955791181*^9}, 3.932311680779722*^9, 
   3.932311833417029*^9, {3.932312054360549*^9, 3.932312062354616*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"f1447443-8fec-4859-a0f1-432bc1930d85"]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing", "Section",
 CellChangeTimes->{{3.932092287956343*^9, 
  3.9320922973553762`*^9}},ExpressionUUID->"e2afeeb3-8efa-4a86-8628-\
128a46491974"],

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<QMeSderivation`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fRGEq", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<Prefactor\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"1", "/", "2"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<Regulatordot\>\""}], ",", " ", 
        RowBox[{"\"\<indices\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}]}]}], "|>"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<Propagator\>\""}], ",", " ", 
        RowBox[{"\"\<indices\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}]}]}], "|>"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fieldsNf2p1", " ", "=", " ", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<bosonic\>\"", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Sigma]", "[", "p", "]"}], ",", 
         RowBox[{"\[CapitalPi]", "[", 
          RowBox[{"p", ",", 
           RowBox[{"{", "a", "}"}]}], "]"}], ",", " ", 
         RowBox[{"A", "[", 
          RowBox[{"p", ",", 
           RowBox[{"{", 
            RowBox[{"v", ",", " ", "c"}], "}"}]}], "]"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", "                 ", 
      RowBox[{"\"\<fermionic\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sb", "[", 
            RowBox[{"p", ",", 
             RowBox[{"{", 
              RowBox[{"d", ",", "c"}], "}"}]}], "]"}], ",", 
           RowBox[{"s", "[", 
            RowBox[{"p", ",", 
             RowBox[{"{", 
              RowBox[{"d", ",", "c"}], "}"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"qb", "[", 
            RowBox[{"p", ",", 
             RowBox[{"{", 
              RowBox[{"d", ",", "c", ",", "f"}], "}"}]}], "]"}], ",", 
           RowBox[{"q", "[", 
            RowBox[{"p", ",", 
             RowBox[{"{", 
              RowBox[{"d", ",", "c", ",", "f"}], "}"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cb", "[", 
            RowBox[{"p", ",", 
             RowBox[{"{", "c", "}"}]}], "]"}], ",", 
           RowBox[{"c", "[", 
            RowBox[{"p", ",", 
             RowBox[{"{", "c", "}"}]}], "]"}]}], "}"}]}], "}"}]}]}], "|>"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TruncationNf2p1", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Sigma]", ",", "\[Sigma]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[CapitalPi]", ",", "\[CapitalPi]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", "qb"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", "sb"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"A", ",", "A"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "cb"}], "}"}], ",", 
      RowBox[{"(*", " ", "propagators", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"qb", ",", "q", ",", "A"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"cb", ",", "c", ",", "A"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"sb", ",", "s", ",", "A"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"A", ",", "A", ",", "A"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"A", ",", "A", ",", "A", ",", "A"}], "}"}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{"gluon", " ", "sector", " ", "scatterings"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"qb", ",", "qb", ",", "q", ",", "q"}], "}"}], ","}], "*)"}], 
      
      RowBox[{"(*", " ", 
       RowBox[{"four", "-", 
        RowBox[{"quark", " ", "scatterings"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"qb", ",", "q", ",", "\[Sigma]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"qb", ",", "q", ",", "\[CapitalPi]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"qb", ",", "q", ",", "\[Sigma]", ",", "\[Sigma]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"qb", ",", "q", ",", "\[CapitalPi]", ",", "\[CapitalPi]"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"qb", ",", "q", ",", "\[Sigma]", ",", "\[CapitalPi]"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
       "qb", ",", "q", ",", "\[Sigma]", ",", "\[Sigma]", ",", "\[Sigma]"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "qb", ",", "q", ",", "\[Sigma]", ",", "\[Sigma]", ",", 
        "\[CapitalPi]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "qb", ",", "q", ",", "\[Sigma]", ",", "\[CapitalPi]", ",", 
        "\[CapitalPi]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "qb", ",", "q", ",", "\[CapitalPi]", ",", "\[CapitalPi]", ",", 
        "\[CapitalPi]"}], "}"}], ",", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"quark", "-", 
        RowBox[{"meson", " ", "scatterings"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", " ", 
      RowBox[{"{", 
       RowBox[{"\[Sigma]", ",", "\[Sigma]", ",", "\[Sigma]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Sigma]", ",", "\[CapitalPi]", ",", "\[CapitalPi]"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
       "\[Sigma]", ",", "\[Sigma]", ",", "\[Sigma]", ",", "\[Sigma]"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{
       "\[Sigma]", ",", "\[Sigma]", ",", "\[CapitalPi]", ",", 
        "\[CapitalPi]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\[CapitalPi]", ",", "\[CapitalPi]", ",", "\[CapitalPi]", ",", 
        "\[CapitalPi]"}], "}"}]}], 
     RowBox[{"(*", " ", 
      RowBox[{"meson", " ", "scatterings"}], " ", "*)"}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetupfRG", "=", " ", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<MasterEquation\>\"", "\[Rule]", "fRGEq"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<FieldSpace\>\"", "\[Rule]", "fieldsNf2p1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Truncation\>\"", "\[Rule]", "TruncationNf2p1"}]}], "|>"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{
  3.903251165586019*^9, {3.9068258986408787`*^9, 3.906825911634159*^9}, {
   3.906826033650765*^9, 3.906826034681692*^9}, {3.906826184986546*^9, 
   3.906826186545793*^9}, {3.907313731747599*^9, 3.907313731907217*^9}, {
   3.907313818897386*^9, 3.907313823096096*^9}, 3.907314075318757*^9, {
   3.93209233794406*^9, 3.932092359008573*^9}, {3.932181198045106*^9, 
   3.932181198719998*^9}, {3.932229215279791*^9, 3.932229220651834*^9}, 
   3.9322307930489388`*^9, {3.932231080500317*^9, 3.9322311415678053`*^9}, 
   3.932231290779391*^9, 3.932234154168911*^9, 3.932277424312339*^9},
 CellLabel->"In[80]:=",ExpressionUUID->"28f1efa9-7def-4cfa-81f0-22b832df0909"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DerivativeListqbq", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"qb", "[", 
        RowBox[{"p4", ",", 
         RowBox[{"{", 
          RowBox[{"d4", ",", "c4", ",", "f4"}], "}"}]}], "]"}], ",", 
       RowBox[{"q", "[", 
        RowBox[{"p3", ",", 
         RowBox[{"{", 
          RowBox[{"d3", ",", "c3", ",", "f3"}], "}"}]}], "]"}], ",", 
       RowBox[{"qb", "[", 
        RowBox[{"p2", ",", 
         RowBox[{"{", 
          RowBox[{"d2", ",", "c2", ",", "f2"}], "}"}]}], "]"}], ",", 
       RowBox[{"q", "[", 
        RowBox[{"p1", ",", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "c1", ",", "f1"}], "}"}]}], "]"}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"QMeSderivation`Private`$DebugLevel", "=", "0"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Timing", "[", 
    RowBox[{"DeriveFunctionalEquation", "[", 
     RowBox[{"SetupfRG", ",", "DerivativeListqbq", ",", 
      RowBox[{
      "\"\<OutputLevel\>\"", "\[Rule]", "\"\<SuperindexDiagrams\>\""}]}], 
     "]"}], "]"}]}]}]], "Input",ExpressionUUID->"a65384dc-847d-46d4-b1da-\
890f45cb4420"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PlotDiagram", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Diagramsqbq", "[", 
    RowBox[{"[", "5", "]"}], "]"}], ",", "SetupfRG", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"\"\<EdgeStyle\>\"", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"q", "->", "Blue"}], ",", 
      RowBox[{"A", "->", "Orange"}], ",", 
      RowBox[{"\[CapitalPi]", "->", 
       RowBox[{"{", 
        RowBox[{"Dashed", ",", "Thick"}], "}"}]}], ",", 
      RowBox[{"\[Sigma]", "->", 
       RowBox[{"{", 
        RowBox[{"Dashed", ",", "Thick", ",", "Purple"}], "}"}]}]}], "}"}]}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"\"\<ShowEdgeLabels\>\"", "->", "False"}]}], "\[IndentingNewLine]",
   "]"}]], "Input",
 CellChangeTimes->{{3.932195565716361*^9, 3.9321955744726458`*^9}, {
  3.932227696627818*^9, 3.932227718129478*^9}, {3.932227798729287*^9, 
  3.9322278106806517`*^9}, {3.932227847596262*^9, 3.932227904874489*^9}},
 CellLabel->
  "In[2308]:=",ExpressionUUID->"dca78166-7758-4594-8b83-3e1cab96bb6c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], ",", 
   GraphicsBox[
    NamespaceBox["NetworkGraphics",
     DynamicModuleBox[{Typeset`graph = HoldComplete[
       Graph[{{$CellContext`externalLeg$155993$156004}, \
{$CellContext`externalLeg$155993$156007}, \
{$CellContext`externalLeg$155993$156010}, \
{$CellContext`externalLeg$155993$156013}, {$CellContext`i}, \
{$CellContext`a83$471882}, {$CellContext`a83$471893}, \
{$CellContext`a83$471910}, {$CellContext`a83$471979}}, {{{6, 5}, {8, 7}, {2, 
         8}, {4, 6}, {5, 9}, {7, 3}, {9, 1}}, {{6, 7}, {8, 9}}}, {
        EdgeStyle -> {
          UndirectedEdge[{$CellContext`a83$471910}, \
{$CellContext`a83$471979}] -> {
             RGBColor[1, 0.5, 0]}, 
           DirectedEdge[{$CellContext`a83$471882}, {$CellContext`i}] -> {
             RGBColor[0, 0, 1]}, 
           UndirectedEdge[{$CellContext`a83$471882}, \
{$CellContext`a83$471893}] -> {{
              Dashing[{Small, Small}], 
              Thickness[Large]}}, 
           DirectedEdge[{$CellContext`i}, {$CellContext`a83$471979}] -> {
             RGBColor[0, 0, 1]}, 
           DirectedEdge[{$CellContext`externalLeg$155993$156013}, \
{$CellContext`a83$471882}] -> {
             RGBColor[0, 0, 1]}, 
           DirectedEdge[{$CellContext`a83$471979}, \
{$CellContext`externalLeg$155993$156004}] -> {
             RGBColor[0, 0, 1]}, 
           DirectedEdge[{$CellContext`a83$471910}, {$CellContext`a83$471893}] -> {
             RGBColor[0, 0, 1]}, 
           DirectedEdge[{$CellContext`a83$471893}, \
{$CellContext`externalLeg$155993$156010}] -> {
             RGBColor[0, 0, 1]}, 
           DirectedEdge[{$CellContext`externalLeg$155993$156007}, \
{$CellContext`a83$471910}] -> {
             RGBColor[0, 0, 1]}}, 
         VertexLabels -> {{$CellContext`externalLeg$155993$156010} -> \
$CellContext`qb, {$CellContext`externalLeg$155993$156004} -> $CellContext`qb, \
{$CellContext`externalLeg$155993$156007} -> $CellContext`q, \
{$CellContext`externalLeg$155993$156013} -> $CellContext`q}, 
         VertexShape -> {{$CellContext`i} -> Graphics[{
              Thickness[Large], 
              
              Line[{{2^Rational[-1, 2], 2^
                 Rational[-1, 2]}, {-2^Rational[-1, 2], -2^Rational[-1, 2]}}], 
              
              Line[{{2^
                 Rational[-1, 2], -2^Rational[-1, 2]}, {-2^Rational[-1, 2], 2^
                 Rational[-1, 2]}}], 
              Circle[{0, 0}, 1]}]}, 
         VertexSize -> {{$CellContext`i} -> Medium}}]]}, 
      TagBox[GraphicsGroupBox[{
         {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
          {RGBColor[0, 0, 1], 
           ArrowBox[{{0.5790930768581004, 0.}, {1.1764645853286368`, 
            0.7397872662665577}}, 0.033423249701746205`]}, 
          {RGBColor[0, 0, 1], 
           ArrowBox[{{3.456079534582448, 2.233136555798648}, {
            2.643055025267789, 1.7399892932128354`}}, 0.033423249701746205`]}, 
          {RGBColor[0, 0, 1], 
           ArrowBox[{{1.729065700379499, 2.0771286519803267`}, {
            0.816344680708225, 1.7383662104001272`}}, 0.033423249701746205`]}, 
          {Thickness[Large], Dashing[{Small, Small}], 
           {Arrowheads[0.], 
            ArrowBox[{{2.643055025267789, 1.7399892932128354`}, {
             2.2868832854473435`, 0.7410707721074592}}, 
             0.033423249701746205`]}}, 
          {RGBColor[0, 0, 1], 
           ArrowBox[{{2.643055025267789, 1.7399892932128354`}, {
            1.729065700379499, 2.0771286519803267`}}, 0.033423249701746205`]}, 
          {RGBColor[0, 0, 1], 
           ArrowBox[{{2.2868832854473435`, 0.7410707721074592}, {
            2.88651576378537, 0.0038578468495309437`}}, 
            0.033423249701746205`]}, 
          {RGBColor[1, 0.5, 0], 
           {Arrowheads[0.], 
            ArrowBox[{{1.1764645853286368`, 0.7397872662665577}, {
             0.816344680708225, 1.7383662104001272`}}, 
             0.033423249701746205`]}}, 
          {RGBColor[0, 0, 1], 
           ArrowBox[{{1.1764645853286368`, 0.7397872662665577}, {
            2.2868832854473435`, 0.7410707721074592}}, 
            0.033423249701746205`]}, 
          {RGBColor[0, 0, 1], 
           ArrowBox[{{0.816344680708225, 1.7383662104001272`}, {0., 
            2.229044482824205}}, 0.033423249701746205`]}}, 
         {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
          0.7]}], {DiskBox[{0., 2.229044482824205}, 0.033423249701746205], 
           InsetBox["qb", 
            Offset[{2, 2}, {0.033423249701746205, 2.2624677325259515}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{0.5790930768581004, 0.}, 0.033423249701746205], 
           InsetBox["q", 
            Offset[{2, 2}, {0.6125163265598466, 0.033423249701746205}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{2.88651576378537, 0.0038578468495309437`}, 
            0.033423249701746205], 
           InsetBox["qb", 
            Offset[{2, 2}, {2.919939013487116, 0.03728109655127715}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           DiskBox[{3.456079534582448, 2.233136555798648}, 
            0.033423249701746205], 
           InsetBox["q", 
            Offset[{2, 2}, {3.4895027842841944, 2.2665598055003944}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, InsetBox[
           GraphicsBox[
            {Thickness[Large], 
             LineBox[NCache[{{
                2^Rational[-1, 2], 2^
                 Rational[-1, 2]}, {-2^Rational[-1, 2], -2^
                  Rational[-1, 2]}}, {{0.7071067811865475, 
               0.7071067811865475}, {-0.7071067811865475, \
-0.7071067811865475}}]], 
             LineBox[NCache[{{
                2^Rational[-1, 2], -2^Rational[-1, 2]}, {-2^Rational[-1, 2], 
                 2^Rational[-1, 2]}}, {{
               0.7071067811865475, -0.7071067811865475}, {-0.7071067811865475,
                0.7071067811865475}}]], CircleBox[{0, 0}, 1]}], {1.729065700379499, 2.0771286519803267},
            Automatic, {0.1900570447255408, 0.1900570447255408}], 
          DiskBox[{2.643055025267789, 1.7399892932128354`}, 
           0.033423249701746205], 
          DiskBox[{2.2868832854473435`, 0.7410707721074592}, 
           0.033423249701746205], 
          DiskBox[{1.1764645853286368`, 0.7397872662665577}, 
           0.033423249701746205], 
          DiskBox[{0.816344680708225, 1.7383662104001272`}, 
           0.033423249701746205]}}],
       MouseAppearanceTag["NetworkGraphics"]],
      AllowKernelInitialization->False]],
    DefaultBaseStyle->"NetworkGraphics",
    FormatType->TraditionalForm,
    FrameTicks->None]}], "}"}]], "Output",
 CellChangeTimes->{{3.932195567435871*^9, 3.932195575029688*^9}, 
   3.93219561803132*^9, {3.932227702900523*^9, 3.9322277184936533`*^9}, {
   3.9322277947112503`*^9, 3.932227811156086*^9}, {3.932227872433413*^9, 
   3.9322279055838547`*^9}},
 CellLabel->
  "Out[2308]=",ExpressionUUID->"6745f923-74b6-4c7f-a857-805bea96ba46"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"symm", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3", ",", "Plus"}], "}"}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.932229108158038*^9, 3.93222912925365*^9}, {
  3.932236565974201*^9, 3.932236569889679*^9}, {3.932236622169277*^9, 
  3.932236638782902*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"b53eccb3-cc7f-4d1f-bf92-5c6561ccafc8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"symm", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3", ",", "Plus"}], "}"}], "\[IndentingNewLine]", 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"res", "=", 
     RowBox[{"ReduceIdenticalFlowDiagrams", "[", 
      RowBox[{"Diagramsqbq", ",", "DerivativeListqbq", ",", "symm"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"res", "//", "Length"}]}]}]], "Input",
 CellChangeTimes->{
  3.932182070740098*^9, {3.932182725879283*^9, 3.932182923311798*^9}, {
   3.932183954777477*^9, 3.93218395915351*^9}, {3.932184146560132*^9, 
   3.93218416503837*^9}, {3.932184802601681*^9, 3.9321848130675983`*^9}, {
   3.932184849918532*^9, 3.932184903632193*^9}, {3.932184961410531*^9, 
   3.932184978214898*^9}, {3.9321850532774*^9, 3.932185094491849*^9}, {
   3.9321852037934227`*^9, 3.932185208768551*^9}, {3.932195091708959*^9, 
   3.932195115106988*^9}, {3.932195218511509*^9, 3.932195247248011*^9}, {
   3.93219553795114*^9, 3.932195552872006*^9}, {3.932195584654614*^9, 
   3.932195626802037*^9}, {3.932236581564723*^9, 3.9322365817001953`*^9}, {
   3.9322724322716513`*^9, 
   3.932272433334807*^9}},ExpressionUUID->"3d8ea30c-a728-4b7a-bae0-\
d5dbbe3d8909"],

Cell[BoxData["100"], "Output",
 CellChangeTimes->{
  3.932182071421906*^9, 3.932182388692728*^9, {3.932182714046431*^9, 
   3.932182734955123*^9}, 3.932182829587267*^9, {3.932182891862214*^9, 
   3.932182928008784*^9}, 3.932183583976513*^9, 3.932183924934496*^9, 
   3.932183961493973*^9, 3.932184063417255*^9, 3.932184111071649*^9, {
   3.932184148277238*^9, 3.932184186914443*^9}, 3.93218425501001*^9, {
   3.932184288604252*^9, 3.932184312083086*^9}, 3.932184345911983*^9, 
   3.932184772356876*^9, {3.9321848181231003`*^9, 3.932184833534706*^9}, {
   3.932184880619457*^9, 3.932184930290344*^9}, {3.932184969002926*^9, 
   3.932184980697348*^9}, {3.932185063050489*^9, 3.932185115421468*^9}, {
   3.932195100441991*^9, 3.932195116147381*^9}, {3.93219522210084*^9, 
   3.932195267059857*^9}, {3.932195531025465*^9, 3.9321955559941463`*^9}, 
   3.932195623288533*^9, 3.9322290218292284`*^9, 3.932229135524495*^9, {
   3.9322329712154493`*^9, 3.932232997411148*^9}, {3.9322365852094812`*^9, 
   3.932236593658139*^9}, {3.932236629350774*^9, 3.9322366419542217`*^9}},
 CellLabel->
  "Out[182]=",ExpressionUUID->"d6d9bada-15aa-4c76-9ee2-7768651f7310"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"fullres", "=", 
   RowBox[{"SuperindexToFullDiagrams", "[", 
    RowBox[{"res", ",", "DerivativeListqbq", ",", "SetupfRG"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.932182939310457*^9, 3.932182955979265*^9}, 
   3.932185071996647*^9},
 CellLabel->
  "In[2322]:=",ExpressionUUID->"fbb7a92d-6293-4d92-8af3-3839b05bd9fe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Select", "[", 
  RowBox[{"res", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Not", "[", 
      RowBox[{"MemberQ", "[", 
       RowBox[{"#", ",", "\[CapitalPi]", ",", "Infinity"}], "]"}], "]"}], "&&", 
     RowBox[{"Not", "[", 
      RowBox[{"MemberQ", "[", 
       RowBox[{"#", ",", "\[Sigma]", ",", "Infinity"}], "]"}], "]"}]}], 
    "&"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.932182957527779*^9, 3.9321829601163588`*^9}, {
  3.93218305142035*^9, 3.932183052269153*^9}, {3.932183109966216*^9, 
  3.932183128633956*^9}, {3.932183504675948*^9, 3.932183535597307*^9}},
 CellLabel->
  "In[2323]:=",ExpressionUUID->"0162fd34-71bb-4e9d-8963-fd3ed1ea7c4b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"Prefactor\"\>", "\[Rule]", 
      RowBox[{"{", "4", "}"}]}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Regulatordot\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "i", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "j", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471978", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "i", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"nPoint\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471978", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", 
             RowBox[{"p4", ",", 
              RowBox[{"{", 
               RowBox[{"d4", ",", "c4", ",", "f4"}], "}"}]}], "}"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "a83$471979", "}"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"\<\"nPoint\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"spec\"\>", "\[Rule]", "\<\"none\"\>"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "a83$471979", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "a83$471910", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"nPoint\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471911", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "a83$471910", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", 
             RowBox[{"p3", ",", 
              RowBox[{"{", 
               RowBox[{"d3", ",", "c3", ",", "f3"}], "}"}]}], "}"}]}], 
           "}"}]}], "}"}]}], ",", 
       RowBox[{"\<\"nPoint\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"spec\"\>", "\[Rule]", "\<\"none\"\>"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471892", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471911", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"nPoint\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471892", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", 
             RowBox[{"p2", ",", 
              RowBox[{"{", 
               RowBox[{"d2", ",", "c2", ",", "f2"}], "}"}]}], "}"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "a83$471893", "}"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"\<\"nPoint\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"spec\"\>", "\[Rule]", "\<\"none\"\>"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "a83$471893", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "a83$471882", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"nPoint\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471883", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "a83$471882", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", 
             RowBox[{"p1", ",", 
              RowBox[{"{", 
               RowBox[{"p1", ",", "c1", ",", "f1"}], "}"}]}], "}"}]}], 
           "}"}]}], "}"}]}], ",", 
       RowBox[{"\<\"nPoint\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"spec\"\>", "\[Rule]", "\<\"none\"\>"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471883", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "j", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"Prefactor\"\>", "\[Rule]", 
      RowBox[{"{", "2", "}"}]}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Regulatordot\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "i", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "j", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471910", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "i", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"nPoint\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471910", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "a83$471911", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", 
             RowBox[{"p3", ",", 
              RowBox[{"{", 
               RowBox[{"d3", ",", "c3", ",", "f3"}], "}"}]}], "}"}]}], 
           "}"}]}], "}"}]}], ",", 
       RowBox[{"\<\"nPoint\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"spec\"\>", "\[Rule]", "\<\"none\"\>"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "a83$471984", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "a83$471911", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"nPoint\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471985", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", 
             RowBox[{"p4", ",", 
              RowBox[{"{", 
               RowBox[{"d4", ",", "c4", ",", "f4"}], "}"}]}], "}"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "a83$471984", "}"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"\<\"nPoint\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"spec\"\>", "\[Rule]", "\<\"none\"\>"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471892", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471985", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"nPoint\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471892", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", 
             RowBox[{"p2", ",", 
              RowBox[{"{", 
               RowBox[{"d2", ",", "c2", ",", "f2"}], "}"}]}], "}"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "a83$471893", "}"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"\<\"nPoint\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"spec\"\>", "\[Rule]", "\<\"none\"\>"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "a83$471893", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "a83$471882", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"nPoint\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471883", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "a83$471882", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", 
             RowBox[{"p1", ",", 
              RowBox[{"{", 
               RowBox[{"p1", ",", "c1", ",", "f1"}], "}"}]}], "}"}]}], 
           "}"}]}], "}"}]}], ",", 
       RowBox[{"\<\"nPoint\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"spec\"\>", "\[Rule]", "\<\"none\"\>"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471883", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "j", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"Prefactor\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"-", "2"}], "}"}]}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Regulatordot\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "i", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "j", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471892", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "i", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"nPoint\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471892", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", 
             RowBox[{"p2", ",", 
              RowBox[{"{", 
               RowBox[{"d2", ",", "c2", ",", "f2"}], "}"}]}], "}"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "a83$471893", "}"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"\<\"nPoint\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"spec\"\>", "\[Rule]", "\<\"none\"\>"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "a83$471893", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "a83$471916", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"nPoint\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471917", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "a83$471916", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", 
             RowBox[{"p3", ",", 
              RowBox[{"{", 
               RowBox[{"d3", ",", "c3", ",", "f3"}], "}"}]}], "}"}]}], 
           "}"}]}], "}"}]}], ",", 
       RowBox[{"\<\"nPoint\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"spec\"\>", "\[Rule]", "\<\"none\"\>"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471882", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471917", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"nPoint\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471882", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "a83$471883", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", 
             RowBox[{"p1", ",", 
              RowBox[{"{", 
               RowBox[{"p1", ",", "c1", ",", "f1"}], "}"}]}], "}"}]}], 
           "}"}]}], "}"}]}], ",", 
       RowBox[{"\<\"nPoint\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"spec\"\>", "\[Rule]", "\<\"none\"\>"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "a83$472054", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "a83$471883", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"nPoint\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$472055", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", 
             RowBox[{"p4", ",", 
              RowBox[{"{", 
               RowBox[{"d4", ",", "c4", ",", "f4"}], "}"}]}], "}"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "a83$472054", "}"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"\<\"nPoint\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"spec\"\>", "\[Rule]", "\<\"none\"\>"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$472055", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "j", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"Prefactor\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"-", "4"}], "}"}]}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Regulatordot\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "i", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "j", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "a83$471978", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "i", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"nPoint\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471979", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", 
             RowBox[{"p4", ",", 
              RowBox[{"{", 
               RowBox[{"d4", ",", "c4", ",", "f4"}], "}"}]}], "}"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "a83$471978", "}"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"\<\"nPoint\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"spec\"\>", "\[Rule]", "\<\"none\"\>"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471910", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471979", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"nPoint\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471910", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "a83$471911", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", 
             RowBox[{"p3", ",", 
              RowBox[{"{", 
               RowBox[{"d3", ",", "c3", ",", "f3"}], "}"}]}], "}"}]}], 
           "}"}]}], "}"}]}], ",", 
       RowBox[{"\<\"nPoint\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"spec\"\>", "\[Rule]", "\<\"none\"\>"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "a83$471892", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "a83$471911", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"nPoint\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471893", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", 
             RowBox[{"p2", ",", 
              RowBox[{"{", 
               RowBox[{"d2", ",", "c2", ",", "f2"}], "}"}]}], "}"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "a83$471892", "}"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"\<\"nPoint\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"spec\"\>", "\[Rule]", "\<\"none\"\>"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471882", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471893", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"nPoint\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471882", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "a83$471883", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", 
             RowBox[{"p1", ",", 
              RowBox[{"{", 
               RowBox[{"p1", ",", "c1", ",", "f1"}], "}"}]}], "}"}]}], 
           "}"}]}], "}"}]}], ",", 
       RowBox[{"\<\"nPoint\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"spec\"\>", "\[Rule]", "\<\"none\"\>"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "j", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "a83$471883", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"Prefactor\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"-", "4"}], "}"}]}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Regulatordot\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "i", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "j", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "a83$472036", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "i", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"nPoint\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$472037", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", 
             RowBox[{"p4", ",", 
              RowBox[{"{", 
               RowBox[{"d4", ",", "c4", ",", "f4"}], "}"}]}], "}"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "a83$472036", "}"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"\<\"nPoint\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"spec\"\>", "\[Rule]", "\<\"none\"\>"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471892", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$472037", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"nPoint\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471892", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", 
             RowBox[{"p2", ",", 
              RowBox[{"{", 
               RowBox[{"d2", ",", "c2", ",", "f2"}], "}"}]}], "}"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "a83$471893", "}"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"\<\"nPoint\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"spec\"\>", "\[Rule]", "\<\"none\"\>"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "a83$471893", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "a83$471916", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"nPoint\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471917", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "a83$471916", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", 
             RowBox[{"p3", ",", 
              RowBox[{"{", 
               RowBox[{"d3", ",", "c3", ",", "f3"}], "}"}]}], "}"}]}], 
           "}"}]}], "}"}]}], ",", 
       RowBox[{"\<\"nPoint\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"spec\"\>", "\[Rule]", "\<\"none\"\>"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471882", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471917", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"nPoint\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", 
            RowBox[{"{", "a83$471882", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "a83$471883", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", 
             RowBox[{"p1", ",", 
              RowBox[{"{", 
               RowBox[{"p1", ",", "c1", ",", "f1"}], "}"}]}], "}"}]}], 
           "}"}]}], "}"}]}], ",", 
       RowBox[{"\<\"nPoint\"\>", "\[Rule]", "3"}], ",", 
       RowBox[{"\<\"spec\"\>", "\[Rule]", "\<\"none\"\>"}]}], 
      "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"Propagator\"\>"}], ",", 
       RowBox[{"\<\"indices\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"{", "j", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"qb", ",", 
            RowBox[{"{", "a83$471883", "}"}]}], "}"}]}], "}"}]}]}], 
      "\[RightAssociation]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.932182960543107*^9, 3.932183052599576*^9, {3.932183110492959*^9, 
   3.93218312894632*^9}, 3.932183536320364*^9, 3.9322290275003843`*^9},
 CellLabel->
  "Out[2323]=",ExpressionUUID->"b47523e7-e97b-4830-beaf-e9b1cff52df5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ReduceIdenticalFlowDiagrams", "[", "Diagramsqbq", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"SuperindexToFullDiagrams", "[", 
  RowBox[{"%", ",", "DerivativeListqbq", ",", "SetupfRG"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9321789530320463`*^9, 3.932178967244795*^9}, {
   3.932179261403082*^9, 3.93217926191009*^9}, {3.932179351568282*^9, 
   3.9321793916979027`*^9}, {3.932179455395288*^9, 3.932179483875126*^9}, {
   3.9321795301330757`*^9, 3.932179538394352*^9}, {3.93218020137272*^9, 
   3.932180204447126*^9}, {3.9321807911330433`*^9, 3.932180858882865*^9}, 
   3.932181048530705*^9, {3.932181238740305*^9, 3.932181243736134*^9}, {
   3.932181306722883*^9, 3.932181309027829*^9}, 3.932181418275806*^9, {
   3.932181529664999*^9, 3.932181537974176*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"3efc76d6-0a52-47cd-87e5-8626b12cb055"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"GAA", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "q"}], ",", "v$37958", ",", "c$37958", ",", "q", ",", 
         "v$37938", ",", "c$37938"}], "}"}], "]"}]}], " ", 
     RowBox[{"GAA", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "v$37942", ",", "c$37942", ",", 
        RowBox[{"-", "q"}], ",", "v$37935", ",", "c$37935"}], "}"}], "]"}], 
     " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p", "-", "q"}], ",", "d$37949", ",", "c$37949", ",", 
        "f$37949", ",", 
        RowBox[{
         RowBox[{"-", "p"}], "+", "q"}], ",", "d$37954", ",", "c$37954", ",", 
        "f$37954"}], "}"}], "]"}], " ", 
     RowBox[{"RdotAA", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "v$37935", ",", "c$37935", ",", "q", ",", 
        "v$37938", ",", "c$37938"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]Aqbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "v$37958", ",", "c$37958", ",", 
        RowBox[{
         RowBox[{"-", "p"}], "+", "q"}], ",", "d$37954", ",", "c$37954", ",", 
        "f$37954", ",", "p", ",", "d1", ",", "c1", ",", "f1"}], "}"}], "]"}], 
     " ", 
     RowBox[{"\[CapitalGamma]Aqbq", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "v$37942", ",", "c$37942", ",", 
        RowBox[{"-", "p"}], ",", "d2", ",", "c2", ",", "f2", ",", 
        RowBox[{"p", "-", "q"}], ",", "d$37949", ",", "c$37949", ",", 
        "f$37949"}], "}"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"GAA", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "p"}], "+", "q"}], ",", "v$38013", ",", "c$38013", ",", 
         RowBox[{"p", "-", "q"}], ",", "v$38007", ",", "c$38007"}], "}"}], 
       "]"}]}], " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "d$37998", ",", "c$37998", ",", "f$37998", ",", 
        RowBox[{"-", "q"}], ",", "d$38019", ",", "c$38019", ",", "f$38019"}], 
       "}"}], "]"}], " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "d$38002", ",", "c$38002", ",", "f$38002", ",", 
        RowBox[{"-", "q"}], ",", "d$37995", ",", "c$37995", ",", "f$37995"}], 
       "}"}], "]"}], " ", 
     RowBox[{"Rdotqbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "d$37995", ",", "c$37995", ",", "f$37995", 
        ",", "q", ",", "d$37998", ",", "c$37998", ",", "f$37998"}], "}"}], 
      "]"}], " ", 
     RowBox[{"\[CapitalGamma]Aqbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p", "-", "q"}], ",", "v$38007", ",", "c$38007", ",", 
        RowBox[{"-", "p"}], ",", "d2", ",", "c2", ",", "f2", ",", "q", ",", 
        "d$38002", ",", "c$38002", ",", "f$38002"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]Aqbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "p"}], "+", "q"}], ",", "v$38013", ",", "c$38013", ",", 
        
        RowBox[{"-", "q"}], ",", "d$38019", ",", "c$38019", ",", "f$38019", 
        ",", "p", ",", "d1", ",", "c1", ",", "f1"}], "}"}], "]"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Gqqb", "[", 
       RowBox[{"{", 
        RowBox[{"q", ",", "d$38058", ",", "c$38058", ",", "f$38058", ",", 
         RowBox[{"-", "q"}], ",", "d$38079", ",", "c$38079", ",", "f$38079"}],
         "}"}], "]"}]}], " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "d$38062", ",", "c$38062", ",", "f$38062", ",", 
        RowBox[{"-", "q"}], ",", "d$38055", ",", "c$38055", ",", "f$38055"}], 
       "}"}], "]"}], " ", 
     RowBox[{"G\[CapitalPi]\[CapitalPi]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "p"}], "+", "q"}], ",", "a$38073", ",", 
        RowBox[{"p", "-", "q"}], ",", "a$38067"}], "}"}], "]"}], " ", 
     RowBox[{"Rdotqbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "d$38055", ",", "c$38055", ",", "f$38055", 
        ",", "q", ",", "d$38058", ",", "c$38058", ",", "f$38058"}], "}"}], 
      "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[CapitalPi]qbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p", "-", "q"}], ",", "a$38067", ",", 
        RowBox[{"-", "p"}], ",", "d2", ",", "c2", ",", "f2", ",", "q", ",", 
        "d$38062", ",", "c$38062", ",", "f$38062"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[CapitalPi]qbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "p"}], "+", "q"}], ",", "a$38073", ",", 
        RowBox[{"-", "q"}], ",", "d$38079", ",", "c$38079", ",", "f$38079", 
        ",", "p", ",", "d1", ",", "c1", ",", "f1"}], "}"}], "]"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Gqqb", "[", 
       RowBox[{"{", 
        RowBox[{"q", ",", "d$38118", ",", "c$38118", ",", "f$38118", ",", 
         RowBox[{"-", "q"}], ",", "d$38137", ",", "c$38137", ",", "f$38137"}],
         "}"}], "]"}]}], " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "d$38122", ",", "c$38122", ",", "f$38122", ",", 
        RowBox[{"-", "q"}], ",", "d$38115", ",", "c$38115", ",", "f$38115"}], 
       "}"}], "]"}], " ", 
     RowBox[{"G\[Sigma]\[Sigma]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "p"}], "+", "q"}], ",", 
        RowBox[{"p", "-", "q"}]}], "}"}], "]"}], " ", 
     RowBox[{"Rdotqbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "d$38115", ",", "c$38115", ",", "f$38115", 
        ",", "q", ",", "d$38118", ",", "c$38118", ",", "f$38118"}], "}"}], 
      "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[Sigma]qbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p", "-", "q"}], ",", 
        RowBox[{"-", "p"}], ",", "d2", ",", "c2", ",", "f2", ",", "q", ",", 
        "d$38122", ",", "c$38122", ",", "f$38122"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[Sigma]qbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "p"}], "+", "q"}], ",", 
        RowBox[{"-", "q"}], ",", "d$38137", ",", "c$38137", ",", "f$38137", 
        ",", "p", ",", "d1", ",", "c1", ",", "f1"}], "}"}], "]"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Gqqb", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"p", "-", "q"}], ",", "d$38187", ",", "c$38187", ",", 
         "f$38187", ",", 
         RowBox[{
          RowBox[{"-", "p"}], "+", "q"}], ",", "d$38192", ",", "c$38192", ",",
          "f$38192"}], "}"}], "]"}]}], " ", 
     RowBox[{"G\[CapitalPi]\[CapitalPi]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "a$38196", ",", "q", ",", "a$38176"}], "}"}],
       "]"}], " ", 
     RowBox[{"G\[CapitalPi]\[CapitalPi]", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "a$38180", ",", 
        RowBox[{"-", "q"}], ",", "a$38173"}], "}"}], "]"}], " ", 
     RowBox[{"Rdot\[CapitalPi]\[CapitalPi]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "a$38173", ",", "q", ",", "a$38176"}], "}"}],
       "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[CapitalPi]qbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "a$38196", ",", 
        RowBox[{
         RowBox[{"-", "p"}], "+", "q"}], ",", "d$38192", ",", "c$38192", ",", 
        "f$38192", ",", "p", ",", "d1", ",", "c1", ",", "f1"}], "}"}], "]"}], 
     " ", 
     RowBox[{"\[CapitalGamma]\[CapitalPi]qbq", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "a$38180", ",", 
        RowBox[{"-", "p"}], ",", "d2", ",", "c2", ",", "f2", ",", 
        RowBox[{"p", "-", "q"}], ",", "d$38187", ",", "c$38187", ",", 
        "f$38187"}], "}"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Gqqb", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"p", "-", "q"}], ",", "d$38244", ",", "c$38244", ",", 
         "f$38244", ",", 
         RowBox[{
          RowBox[{"-", "p"}], "+", "q"}], ",", "d$38249", ",", "c$38249", ",",
          "f$38249"}], "}"}], "]"}]}], " ", 
     RowBox[{"G\[Sigma]\[Sigma]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "q"}], "}"}], "]"}], " ", 
     RowBox[{"G\[Sigma]\[Sigma]", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "q"}]}], "}"}], "]"}], " ", 
     RowBox[{"Rdot\[Sigma]\[Sigma]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "q"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[Sigma]qbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", 
        RowBox[{
         RowBox[{"-", "p"}], "+", "q"}], ",", "d$38249", ",", "c$38249", ",", 
        "f$38249", ",", "p", ",", "d1", ",", "c1", ",", "f1"}], "}"}], "]"}], 
     " ", 
     RowBox[{"\[CapitalGamma]\[Sigma]qbq", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "p"}], ",", "d2", ",", "c2", ",", "f2", ",", 
        RowBox[{"p", "-", "q"}], ",", "d$38244", ",", "c$38244", ",", 
        "f$38244"}], "}"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"G\[CapitalPi]\[CapitalPi]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "a$38302", ",", "q", ",", "a$38292"}], "}"}],
       "]"}], " ", 
     RowBox[{"G\[CapitalPi]\[CapitalPi]", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "a$38296", ",", 
        RowBox[{"-", "q"}], ",", "a$38289"}], "}"}], "]"}], " ", 
     RowBox[{"Rdot\[CapitalPi]\[CapitalPi]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "a$38289", ",", "q", ",", "a$38292"}], "}"}],
       "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[CapitalPi]\[CapitalPi]qbq", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "a$38296", ",", 
        RowBox[{"-", "q"}], ",", "a$38302", ",", 
        RowBox[{"-", "p"}], ",", "d2", ",", "c2", ",", "f2", ",", "p", ",", 
        "d1", ",", "c1", ",", "f1"}], "}"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"G\[Sigma]\[Sigma]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "q"}], "}"}], "]"}], " ", 
     RowBox[{"G\[Sigma]\[Sigma]", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "q"}]}], "}"}], "]"}], " ", 
     RowBox[{"Rdot\[Sigma]\[Sigma]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "q"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[Sigma]\[Sigma]qbq", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "q"}], ",", 
        RowBox[{"-", "p"}], ",", "d2", ",", "c2", ",", "f2", ",", "p", ",", 
        "d1", ",", "c1", ",", "f1"}], "}"}], "]"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.932181533825992*^9, 3.932181538575639*^9}},
 CellLabel->"Out[13]=",ExpressionUUID->"791f2498-21de-4b41-9831-af8b483c7b96"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"DerivativeListqbq", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"qb", "[", 
      RowBox[{"p2", ",", 
       RowBox[{"{", 
        RowBox[{"d2", ",", "c2", ",", "f2"}], "}"}]}], "]"}], ",", 
     RowBox[{"q", "[", 
      RowBox[{"p1", ",", 
       RowBox[{"{", 
        RowBox[{"p1", ",", "c1", ",", "f1"}], "}"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Diagramsqbq", "=", 
    RowBox[{"DeriveFunctionalEquation", "[", 
     RowBox[{"SetupfRG", ",", "DerivativeListqbq", ",", 
      RowBox[{"\"\<OutputLevel\>\"", "\[Rule]", "\"\<FullDiagrams\>\""}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"RerouteFermionicMomenta", "[", 
  RowBox[{"Diagramsqbq", ",", "SetupfRG", ",", "DerivativeListqbq"}], 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.93227752476829*^9, {3.932282216191455*^9, 3.932282216389814*^9}, 
   3.9323116730489473`*^9, {3.93231212203353*^9, 3.93231212578868*^9}, {
   3.932312204248024*^9, 3.932312251192956*^9}, {3.932312430750444*^9, 
   3.932312435569891*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"fe77e662-c68f-4cb0-9ba5-1382374363b8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"GAA", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "v$61700", ",", "c$61700", ",", "q", ",", 
        "v$61680", ",", "c$61680"}], "}"}], "]"}], " ", 
     RowBox[{"GAA", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "v$61684", ",", "c$61684", ",", 
        RowBox[{"-", "q"}], ",", "v$61677", ",", "c$61677"}], "}"}], "]"}], 
     " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "-", "q"}], ",", "d$61691", ",", "c$61691", ",", 
        "f$61691", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "+", "q"}], ",", "d$61696", ",", "c$61696", ",",
         "f$61696"}], "}"}], "]"}], " ", 
     RowBox[{"RdotAA", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "v$61677", ",", "c$61677", ",", "q", ",", 
        "v$61680", ",", "c$61680"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]Aqbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "v$61700", ",", "c$61700", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "+", "q"}], ",", "d$61696", ",", "c$61696", ",",
         "f$61696", ",", "p1", ",", "p1", ",", "c1", ",", "f1"}], "}"}], 
      "]"}], " ", 
     RowBox[{"\[CapitalGamma]Aqbq", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "v$61684", ",", "c$61684", ",", 
        RowBox[{"-", "p1"}], ",", "d2", ",", "c2", ",", "f2", ",", 
        RowBox[{"p1", "-", "q"}], ",", "d$61691", ",", "c$61691", ",", 
        "f$61691"}], "}"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"GAA", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "v$61749", ",", "c$61749", ",", "q", ",", 
        "v$61756", ",", "c$61756"}], "}"}], "]"}], " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "+", "q"}], ",", "d$61740", ",", "c$61740", ",", 
        "f$61740", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$61761", ",", "c$61761", ",",
         "f$61761"}], "}"}], "]"}], " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "+", "q"}], ",", "d$61744", ",", "c$61744", ",", 
        "f$61744", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$61737", ",", "c$61737", ",",
         "f$61737"}], "}"}], "]"}], " ", 
     RowBox[{"Rdotqbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$61737", ",", "c$61737", ",",
         "f$61737", ",", 
        RowBox[{"p1", "+", "q"}], ",", "d$61740", ",", "c$61740", ",", 
        "f$61740"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]Aqbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "v$61749", ",", "c$61749", ",", 
        RowBox[{"-", "p1"}], ",", "d2", ",", "c2", ",", "f2", ",", 
        RowBox[{"p1", "+", "q"}], ",", "d$61744", ",", "c$61744", ",", 
        "f$61744"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]Aqbq", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "v$61756", ",", "c$61756", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$61761", ",", "c$61761", ",",
         "f$61761", ",", "p1", ",", "p1", ",", "c1", ",", "f1"}], "}"}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "+", "q"}], ",", "d$61800", ",", "c$61800", ",", 
        "f$61800", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$61821", ",", "c$61821", ",",
         "f$61821"}], "}"}], "]"}], " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "+", "q"}], ",", "d$61804", ",", "c$61804", ",", 
        "f$61804", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$61797", ",", "c$61797", ",",
         "f$61797"}], "}"}], "]"}], " ", 
     RowBox[{"G\[CapitalPi]\[CapitalPi]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "a$61809", ",", "q", ",", "a$61816"}], "}"}],
       "]"}], " ", 
     RowBox[{"Rdotqbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$61797", ",", "c$61797", ",",
         "f$61797", ",", 
        RowBox[{"p1", "+", "q"}], ",", "d$61800", ",", "c$61800", ",", 
        "f$61800"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[CapitalPi]qbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "a$61809", ",", 
        RowBox[{"-", "p1"}], ",", "d2", ",", "c2", ",", "f2", ",", 
        RowBox[{"p1", "+", "q"}], ",", "d$61804", ",", "c$61804", ",", 
        "f$61804"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[CapitalPi]qbq", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "a$61816", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$61821", ",", "c$61821", ",",
         "f$61821", ",", "p1", ",", "p1", ",", "c1", ",", "f1"}], "}"}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "+", "q"}], ",", "d$61860", ",", "c$61860", ",", 
        "f$61860", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$61879", ",", "c$61879", ",",
         "f$61879"}], "}"}], "]"}], " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "+", "q"}], ",", "d$61864", ",", "c$61864", ",", 
        "f$61864", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$61857", ",", "c$61857", ",",
         "f$61857"}], "}"}], "]"}], " ", 
     RowBox[{"G\[Sigma]\[Sigma]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "q"}], "}"}], "]"}], " ", 
     RowBox[{"Rdotqbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$61857", ",", "c$61857", ",",
         "f$61857", ",", 
        RowBox[{"p1", "+", "q"}], ",", "d$61860", ",", "c$61860", ",", 
        "f$61860"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[Sigma]qbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", 
        RowBox[{"-", "p1"}], ",", "d2", ",", "c2", ",", "f2", ",", 
        RowBox[{"p1", "+", "q"}], ",", "d$61864", ",", "c$61864", ",", 
        "f$61864"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[Sigma]qbq", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$61879", ",", "c$61879", ",",
         "f$61879", ",", "p1", ",", "p1", ",", "c1", ",", "f1"}], "}"}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "-", "q"}], ",", "d$61929", ",", "c$61929", ",", 
        "f$61929", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "+", "q"}], ",", "d$61934", ",", "c$61934", ",",
         "f$61934"}], "}"}], "]"}], " ", 
     RowBox[{"G\[CapitalPi]\[CapitalPi]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "a$61938", ",", "q", ",", "a$61918"}], "}"}],
       "]"}], " ", 
     RowBox[{"G\[CapitalPi]\[CapitalPi]", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "a$61922", ",", 
        RowBox[{"-", "q"}], ",", "a$61915"}], "}"}], "]"}], " ", 
     RowBox[{"Rdot\[CapitalPi]\[CapitalPi]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "a$61915", ",", "q", ",", "a$61918"}], "}"}],
       "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[CapitalPi]qbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "a$61938", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "+", "q"}], ",", "d$61934", ",", "c$61934", ",",
         "f$61934", ",", "p1", ",", "p1", ",", "c1", ",", "f1"}], "}"}], 
      "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[CapitalPi]qbq", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "a$61922", ",", 
        RowBox[{"-", "p1"}], ",", "d2", ",", "c2", ",", "f2", ",", 
        RowBox[{"p1", "-", "q"}], ",", "d$61929", ",", "c$61929", ",", 
        "f$61929"}], "}"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "-", "q"}], ",", "d$61986", ",", "c$61986", ",", 
        "f$61986", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "+", "q"}], ",", "d$61991", ",", "c$61991", ",",
         "f$61991"}], "}"}], "]"}], " ", 
     RowBox[{"G\[Sigma]\[Sigma]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "q"}], "}"}], "]"}], " ", 
     RowBox[{"G\[Sigma]\[Sigma]", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "q"}]}], "}"}], "]"}], " ", 
     RowBox[{"Rdot\[Sigma]\[Sigma]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "q"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[Sigma]qbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "+", "q"}], ",", "d$61991", ",", "c$61991", ",",
         "f$61991", ",", "p1", ",", "p1", ",", "c1", ",", "f1"}], "}"}], 
      "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[Sigma]qbq", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "p1"}], ",", "d2", ",", "c2", ",", "f2", ",", 
        RowBox[{"p1", "-", "q"}], ",", "d$61986", ",", "c$61986", ",", 
        "f$61986"}], "}"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"G\[CapitalPi]\[CapitalPi]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "a$62044", ",", "q", ",", "a$62034"}], "}"}],
       "]"}], " ", 
     RowBox[{"G\[CapitalPi]\[CapitalPi]", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "a$62038", ",", 
        RowBox[{"-", "q"}], ",", "a$62031"}], "}"}], "]"}], " ", 
     RowBox[{"Rdot\[CapitalPi]\[CapitalPi]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "a$62031", ",", "q", ",", "a$62034"}], "}"}],
       "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[CapitalPi]\[CapitalPi]qbq", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "a$62038", ",", 
        RowBox[{"-", "q"}], ",", "a$62044", ",", 
        RowBox[{"-", "p1"}], ",", "d2", ",", "c2", ",", "f2", ",", "p1", ",", 
        "p1", ",", "c1", ",", "f1"}], "}"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"G\[Sigma]\[Sigma]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "q"}], "}"}], "]"}], " ", 
     RowBox[{"G\[Sigma]\[Sigma]", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "q"}]}], "}"}], "]"}], " ", 
     RowBox[{"Rdot\[Sigma]\[Sigma]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "q"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[Sigma]\[Sigma]qbq", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "q"}], ",", 
        RowBox[{"-", "p1"}], ",", "d2", ",", "c2", ",", "f2", ",", "p1", ",", 
        "p1", ",", "c1", ",", "f1"}], "}"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"GAA", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "v$62134", ",", "c$62134", ",", "q", ",", 
        "v$62114", ",", "c$62114"}], "}"}], "]"}], " ", 
     RowBox[{"GAA", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "v$62118", ",", "c$62118", ",", 
        RowBox[{"-", "q"}], ",", "v$62111", ",", "c$62111"}], "}"}], "]"}], 
     " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "+", "q"}], ",", "d$62129", ",", "c$62129", ",", 
        "f$62129", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$62124", ",", "c$62124", ",",
         "f$62124"}], "}"}], "]"}], " ", 
     RowBox[{"RdotAA", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "v$62111", ",", "c$62111", ",", "q", ",", 
        "v$62114", ",", "c$62114"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]Aqbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "v$62134", ",", "c$62134", ",", 
        RowBox[{"-", "p1"}], ",", "d2", ",", "c2", ",", "f2", ",", 
        RowBox[{"p1", "+", "q"}], ",", "d$62129", ",", "c$62129", ",", 
        "f$62129"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]Aqbq", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "v$62118", ",", "c$62118", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$62124", ",", "c$62124", ",",
         "f$62124", ",", "p1", ",", "p1", ",", "c1", ",", "f1"}], "}"}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"GAA", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "v$62189", ",", "c$62189", ",", "q", ",", 
        "v$62183", ",", "c$62183"}], "}"}], "]"}], " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "+", "q"}], ",", "d$62174", ",", "c$62174", ",", 
        "f$62174", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$62179", ",", "c$62179", ",",
         "f$62179"}], "}"}], "]"}], " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "+", "q"}], ",", "d$62196", ",", "c$62196", ",", 
        "f$62196", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$62171", ",", "c$62171", ",",
         "f$62171"}], "}"}], "]"}], " ", 
     RowBox[{"Rdotqbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$62171", ",", "c$62171", ",",
         "f$62171", ",", 
        RowBox[{"p1", "+", "q"}], ",", "d$62174", ",", "c$62174", ",", 
        "f$62174"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]Aqbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "v$62189", ",", "c$62189", ",", 
        RowBox[{"-", "p1"}], ",", "d2", ",", "c2", ",", "f2", ",", 
        RowBox[{"p1", "+", "q"}], ",", "d$62196", ",", "c$62196", ",", 
        "f$62196"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]Aqbq", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "v$62183", ",", "c$62183", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$62179", ",", "c$62179", ",",
         "f$62179", ",", "p1", ",", "p1", ",", "c1", ",", "f1"}], "}"}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "+", "q"}], ",", "d$62234", ",", "c$62234", ",", 
        "f$62234", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$62239", ",", "c$62239", ",",
         "f$62239"}], "}"}], "]"}], " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "+", "q"}], ",", "d$62256", ",", "c$62256", ",", 
        "f$62256", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$62231", ",", "c$62231", ",",
         "f$62231"}], "}"}], "]"}], " ", 
     RowBox[{"G\[CapitalPi]\[CapitalPi]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "a$62249", ",", "q", ",", "a$62243"}], "}"}],
       "]"}], " ", 
     RowBox[{"Rdotqbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$62231", ",", "c$62231", ",",
         "f$62231", ",", 
        RowBox[{"p1", "+", "q"}], ",", "d$62234", ",", "c$62234", ",", 
        "f$62234"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[CapitalPi]qbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "a$62249", ",", 
        RowBox[{"-", "p1"}], ",", "d2", ",", "c2", ",", "f2", ",", 
        RowBox[{"p1", "+", "q"}], ",", "d$62256", ",", "c$62256", ",", 
        "f$62256"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[CapitalPi]qbq", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "a$62243", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$62239", ",", "c$62239", ",",
         "f$62239", ",", "p1", ",", "p1", ",", "c1", ",", "f1"}], "}"}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "+", "q"}], ",", "d$62294", ",", "c$62294", ",", 
        "f$62294", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$62299", ",", "c$62299", ",",
         "f$62299"}], "}"}], "]"}], " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "+", "q"}], ",", "d$62314", ",", "c$62314", ",", 
        "f$62314", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$62291", ",", "c$62291", ",",
         "f$62291"}], "}"}], "]"}], " ", 
     RowBox[{"G\[Sigma]\[Sigma]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "q"}], "}"}], "]"}], " ", 
     RowBox[{"Rdotqbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$62291", ",", "c$62291", ",",
         "f$62291", ",", 
        RowBox[{"p1", "+", "q"}], ",", "d$62294", ",", "c$62294", ",", 
        "f$62294"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[Sigma]qbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", 
        RowBox[{"-", "p1"}], ",", "d2", ",", "c2", ",", "f2", ",", 
        RowBox[{"p1", "+", "q"}], ",", "d$62314", ",", "c$62314", ",", 
        "f$62314"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[Sigma]qbq", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$62299", ",", "c$62299", ",",
         "f$62299", ",", "p1", ",", "p1", ",", "c1", ",", "f1"}], "}"}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "+", "q"}], ",", "d$62367", ",", "c$62367", ",", 
        "f$62367", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$62362", ",", "c$62362", ",",
         "f$62362"}], "}"}], "]"}], " ", 
     RowBox[{"G\[CapitalPi]\[CapitalPi]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "a$62372", ",", "q", ",", "a$62352"}], "}"}],
       "]"}], " ", 
     RowBox[{"G\[CapitalPi]\[CapitalPi]", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "a$62356", ",", 
        RowBox[{"-", "q"}], ",", "a$62349"}], "}"}], "]"}], " ", 
     RowBox[{"Rdot\[CapitalPi]\[CapitalPi]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "a$62349", ",", "q", ",", "a$62352"}], "}"}],
       "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[CapitalPi]qbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "a$62372", ",", 
        RowBox[{"-", "p1"}], ",", "d2", ",", "c2", ",", "f2", ",", 
        RowBox[{"p1", "+", "q"}], ",", "d$62367", ",", "c$62367", ",", 
        "f$62367"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[CapitalPi]qbq", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", "a$62356", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$62362", ",", "c$62362", ",",
         "f$62362", ",", "p1", ",", "p1", ",", "c1", ",", "f1"}], "}"}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"Gqqb", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p1", "+", "q"}], ",", "d$62424", ",", "c$62424", ",", 
        "f$62424", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$62419", ",", "c$62419", ",",
         "f$62419"}], "}"}], "]"}], " ", 
     RowBox[{"G\[Sigma]\[Sigma]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "q"}], "}"}], "]"}], " ", 
     RowBox[{"G\[Sigma]\[Sigma]", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "q"}]}], "}"}], "]"}], " ", 
     RowBox[{"Rdot\[Sigma]\[Sigma]", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", "q"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[Sigma]qbq", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "q"}], ",", 
        RowBox[{"-", "p1"}], ",", "d2", ",", "c2", ",", "f2", ",", 
        RowBox[{"p1", "+", "q"}], ",", "d$62424", ",", "c$62424", ",", 
        "f$62424"}], "}"}], "]"}], " ", 
     RowBox[{"\[CapitalGamma]\[Sigma]qbq", "[", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{
         RowBox[{"-", "p1"}], "-", "q"}], ",", "d$62419", ",", "c$62419", ",",
         "f$62419", ",", "p1", ",", "p1", ",", "c1", ",", "f1"}], "}"}], 
      "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.93228223523468*^9, {3.932311657989546*^9, 3.9323116747618017`*^9}, {
   3.932312115487214*^9, 3.932312126240911*^9}, {3.932312198255086*^9, 
   3.93231225198322*^9}, 3.932312340041884*^9, 3.9323123805296173`*^9, {
   3.932312424443461*^9, 3.932312436118243*^9}},
 CellLabel->
  "Out[168]=",ExpressionUUID->"1ea4c7af-a533-4eb5-9d54-9ae9358751c6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["End  the package", "Section",
 CellChangeTimes->{{3.932115978898404*^9, 
  3.93211598276877*^9}},ExpressionUUID->"a050d20b-95f9-486c-b9dd-\
e6873cd69f9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.932115983740492*^9, 3.932115988245764*^9}, 
   3.9321160408593388`*^9},ExpressionUUID->"65650d74-3ea4-46f4-a607-\
7bac0b962249"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{441, 477},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1. Inherited,
FrontEndVersion->"14.0 for Linux x86 (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f8e9dfa9-fa21-4fe2-826e-9ba3a99be3a5"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 175, 3, 67, "Chapter",ExpressionUUID->"aede59b2-194f-46df-ac63-25a1e4e2fbde"],
Cell[758, 27, 250, 6, 45, "Input",ExpressionUUID->"26b1bd1d-881b-4710-9df9-68606cbb6f63",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1033, 37, 152, 3, 66, "Section",ExpressionUUID->"66d3b196-e162-4109-9eae-736f9d47bb81"],
Cell[1188, 42, 1253, 20, 294, "Input",ExpressionUUID->"ea48f95a-f602-4077-9974-c881c0ff1d9f",
 InitializationCell->True],
Cell[2444, 64, 1178, 20, 273, "Input",ExpressionUUID->"8f677744-cfb0-40f4-b89f-c83aaf8aa0d8",
 InitializationCell->True],
Cell[3625, 86, 1027, 17, 273, "Input",ExpressionUUID->"301c841e-d18e-467c-829e-d2fe1d67da6f",
 InitializationCell->True],
Cell[4655, 105, 1071, 18, 170, "Input",ExpressionUUID->"1aba1273-b7c6-4f59-a812-5fd809f716c6",
 InitializationCell->True],
Cell[5729, 125, 159, 3, 45, "Input",ExpressionUUID->"3ec6060e-25c6-41bf-bcdb-f69c8d8cb5cb",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[5925, 133, 150, 3, 66, "Section",ExpressionUUID->"c860513e-188c-43ef-9b76-1b904d2adeae"],
Cell[6078, 138, 187, 4, 45, "Input",ExpressionUUID->"e28b94f8-4ec5-4d82-95fc-59ffaf4ac5c9",
 InitializationCell->True],
Cell[6268, 144, 426, 11, 48, "Input",ExpressionUUID->"ab76e3eb-0df2-489c-90da-b0c1149e7958",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[6731, 160, 156, 3, 66, "Section",ExpressionUUID->"5435ef76-4c83-491d-a479-2c8c1f89c7e1"],
Cell[CellGroupData[{
Cell[6912, 167, 168, 3, 55, "Subsection",ExpressionUUID->"af2e49d9-78da-4159-bd04-8bc58aab6a36"],
Cell[7083, 172, 3060, 81, 192, "Input",ExpressionUUID->"c01afb9a-ad61-4425-889a-03c87ac316aa",
 InitializationCell->True],
Cell[10146, 255, 5325, 133, 511, "Input",ExpressionUUID->"0a58cf74-2354-4fca-bb76-5ece6df41991",
 InitializationCell->True],
Cell[15474, 390, 3169, 82, 285, "Input",ExpressionUUID->"4bc213ad-e1f4-4f75-b946-17fff4b07ad4",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[18680, 477, 163, 3, 55, "Subsection",ExpressionUUID->"f34f67a9-8968-4f68-b177-066a97452e1d"],
Cell[18846, 482, 4862, 124, 624, "Input",ExpressionUUID->"a68ab892-1d13-4fae-8dd2-fccfec36b491",
 InitializationCell->True],
Cell[23711, 608, 1581, 42, 190, "Input",ExpressionUUID->"85869703-45b3-4f00-bb0e-83d99fad6a5b",
 InitializationCell->True],
Cell[25295, 652, 1871, 53, 108, "Input",ExpressionUUID->"0a89d4a0-75e0-4c74-8f47-fc4fb248625b",
 InitializationCell->True],
Cell[27169, 707, 2198, 54, 381, "Input",ExpressionUUID->"467f3b0f-adfb-484c-8f6c-999a60669b6a",
 InitializationCell->True],
Cell[29370, 763, 353, 9, 74, "Input",ExpressionUUID->"651d3be3-be21-417a-9017-7e76b7af0821",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[29772, 778, 162, 3, 66, "Section",ExpressionUUID->"233ac0db-233d-40c3-9de5-6f7902474cfc"],
Cell[CellGroupData[{
Cell[29959, 785, 164, 3, 55, "Subsection",ExpressionUUID->"62e4b34f-224d-4de9-bcc8-29bcb5279d9f"],
Cell[30126, 790, 3624, 81, 356, "Input",ExpressionUUID->"e0663f80-523c-46ae-abb0-036375dcc9c5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[33787, 876, 176, 3, 39, "Subsection",ExpressionUUID->"5e43837a-9b61-4679-9938-3744e2f0f92a"],
Cell[33966, 881, 17450, 391, 1573, "Input",ExpressionUUID->"a6191ded-d4cf-4a87-8cba-d76cf1e3ac3f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[51453, 1277, 169, 3, 39, "Subsection",ExpressionUUID->"e2b8d1ec-f601-4a4f-a55d-63c0dff7e637"],
Cell[51625, 1282, 9412, 226, 803, "Input",ExpressionUUID->"316d6cba-bb29-44a6-915c-2927d2c427f8",
 InitializationCell->True],
Cell[61040, 1510, 9725, 206, 871, "Input",ExpressionUUID->"ab592be8-0954-4254-b56b-6f7146afe952",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[70790, 1720, 2540, 69, 218, "Input",ExpressionUUID->"dd232756-644a-4055-8c7c-ca293ec9c8ea"],
Cell[73333, 1791, 480, 7, 70, "Output",ExpressionUUID->"72ee4596-699c-4f4a-80b1-797835f570bd"],
Cell[73816, 1800, 462, 11, 70, "Print",ExpressionUUID->"40d571d2-f0cd-4568-802a-4d48943caf37"],
Cell[74281, 1813, 489, 7, 70, "Output",ExpressionUUID->"e8f97605-18c4-4884-8952-0f35efe5dfbd"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[74831, 1827, 159, 3, 66, "Section",ExpressionUUID->"6a3fc747-6b04-4adb-bf17-12782a1349d7"],
Cell[74993, 1832, 4038, 99, 453, "Input",ExpressionUUID->"4b7e9a1c-bcea-4f28-a801-f32589838af8",
 InitializationCell->True],
Cell[79034, 1933, 3511, 90, 299, "Input",ExpressionUUID->"cf322f7c-f7c3-4539-b6aa-ac3de26accbf",
 InitializationCell->True],
Cell[82548, 2025, 18904, 428, 1977, "Input",ExpressionUUID->"13ef92fe-9686-4a4f-85bb-34e9d5213ced",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[101489, 2458, 164, 3, 52, "Section",ExpressionUUID->"65e89f7f-dd30-4576-9309-12b8ccc6e19b"],
Cell[101656, 2463, 703, 19, 45, "Input",ExpressionUUID->"25b57239-9d9a-403d-bc72-290378d91941",
 InitializationCell->True],
Cell[102362, 2484, 19193, 450, 1606, "Input",ExpressionUUID->"f1447443-8fec-4859-a0f1-432bc1930d85",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[121592, 2939, 154, 3, 52, "Section",ExpressionUUID->"e2afeeb3-8efa-4a86-8628-128a46491974"],
Cell[121749, 2944, 7119, 186, 390, "Input",ExpressionUUID->"28f1efa9-7def-4cfa-81f0-22b832df0909"],
Cell[128871, 3132, 1177, 32, 92, "Input",ExpressionUUID->"a65384dc-847d-46d4-b1da-890f45cb4420"],
Cell[CellGroupData[{
Cell[130073, 3168, 1026, 24, 113, "Input",ExpressionUUID->"dca78166-7758-4594-8b83-3e1cab96bb6c"],
Cell[131102, 3194, 7083, 146, 145, "Output",ExpressionUUID->"6745f923-74b6-4c7f-a857-805bea96ba46"]
}, Open  ]],
Cell[138200, 3343, 455, 11, 71, "Input",ExpressionUUID->"b53eccb3-cc7f-4d1f-bf92-5c6561ccafc8"],
Cell[CellGroupData[{
Cell[138680, 3358, 1320, 27, 133, "Input",ExpressionUUID->"3d8ea30c-a728-4b7a-bae0-d5dbbe3d8909"],
Cell[140003, 3387, 1150, 17, 33, "Output",ExpressionUUID->"d6d9bada-15aa-4c76-9ee2-7768651f7310"]
}, Open  ]],
Cell[141168, 3407, 364, 9, 29, "Input",ExpressionUUID->"fbb7a92d-6293-4d92-8af3-3839b05bd9fe"],
Cell[CellGroupData[{
Cell[141557, 3420, 679, 16, 29, "Input",ExpressionUUID->"0162fd34-71bb-4e9d-8963-fd3ed1ea7c4b"],
Cell[142239, 3438, 32162, 860, 567, "Output",ExpressionUUID->"b47523e7-e97b-4830-beaf-e9b1cff52df5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[174438, 4303, 884, 14, 51, "Input",ExpressionUUID->"3efc76d6-0a52-47cd-87e5-8626b12cb055"],
Cell[175325, 4319, 11173, 286, 1568, "Output",ExpressionUUID->"791f2498-21de-4b41-9831-af8b483c7b96"]
}, Open  ]],
Cell[CellGroupData[{
Cell[186535, 4610, 1195, 30, 195, "Input",ExpressionUUID->"fe77e662-c68f-4cb0-9ba5-1382374363b8"],
Cell[187733, 4642, 21945, 573, 3343, "Output",ExpressionUUID->"1ea4c7af-a533-4eb5-9d54-9ae9358751c6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[209727, 5221, 160, 3, 66, "Section",ExpressionUUID->"a050d20b-95f9-486c-b9dd-e6873cd69f9a"],
Cell[209890, 5226, 326, 7, 87, "Input",ExpressionUUID->"65650d74-3ea4-46f4-a607-7bac0b962249",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}
]
*)

